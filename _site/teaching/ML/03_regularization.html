<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Machine Learning Supplementary Material - 3&nbsp; Regularization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04_regression_trees.html" rel="next">
<link href="./02_linear_models.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03_regularization.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Regularization</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Machine Learning Supplementary Material</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_prerequisites.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Important R concepts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Linear Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_regularization.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Regularization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_regression_trees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regression Trees</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#exercises" id="toc-exercises" class="nav-link active" data-scroll-target="#exercises"><span class="header-section-number">4</span> Exercises</a>
  <ul>
  <li><a href="#exercise-1-loss-functions-in-the-context-of-ols-ridge-and-lasso-regression" id="toc-exercise-1-loss-functions-in-the-context-of-ols-ridge-and-lasso-regression" class="nav-link" data-scroll-target="#exercise-1-loss-functions-in-the-context-of-ols-ridge-and-lasso-regression"><span class="header-section-number">4.1</span> Exercise 1: Loss functions in the context of OLS, ridge, and lasso regression</a>
  <ul class="collapse">
  <li><a href="#exercise-1a-ols" id="toc-exercise-1a-ols" class="nav-link" data-scroll-target="#exercise-1a-ols"><span class="header-section-number">4.1.1</span> Exercise 1a : OLS</a></li>
  <li><a href="#exercise-1b-ridge-and-lasso-regression" id="toc-exercise-1b-ridge-and-lasso-regression" class="nav-link" data-scroll-target="#exercise-1b-ridge-and-lasso-regression"><span class="header-section-number">4.1.2</span> Exercise 1b: Ridge and lasso regression</a>
  <ul class="collapse">
  <li><a href="#exercise-1b-i" id="toc-exercise-1b-i" class="nav-link" data-scroll-target="#exercise-1b-i"><span class="header-section-number">4.1.2.1</span> Exercise 1b i:</a></li>
  <li><a href="#exercise-1b-ii" id="toc-exercise-1b-ii" class="nav-link" data-scroll-target="#exercise-1b-ii"><span class="header-section-number">4.1.2.2</span> Exercise 1b ii:</a></li>
  <li><a href="#exercise-1b-iii" id="toc-exercise-1b-iii" class="nav-link" data-scroll-target="#exercise-1b-iii"><span class="header-section-number">4.1.2.3</span> Exercise 1b iii:</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#exercise-2-another-lesson-on-data-preparation-and-model-specification" id="toc-exercise-2-another-lesson-on-data-preparation-and-model-specification" class="nav-link" data-scroll-target="#exercise-2-another-lesson-on-data-preparation-and-model-specification"><span class="header-section-number">4.2</span> Exercise 2: Another lesson on data preparation and model specification</a>
  <ul class="collapse">
  <li><a href="#exercise-2a-data-preparation" id="toc-exercise-2a-data-preparation" class="nav-link" data-scroll-target="#exercise-2a-data-preparation"><span class="header-section-number">4.2.1</span> Exercise 2a: Data preparation</a></li>
  <li><a href="#exercise-2b-setting-up-resampling" id="toc-exercise-2b-setting-up-resampling" class="nav-link" data-scroll-target="#exercise-2b-setting-up-resampling"><span class="header-section-number">4.2.2</span> Exercise 2b: Setting up resampling</a></li>
  <li><a href="#exercise-2c-setting-up-a-recipe" id="toc-exercise-2c-setting-up-a-recipe" class="nav-link" data-scroll-target="#exercise-2c-setting-up-a-recipe"><span class="header-section-number">4.2.3</span> Exercise 2c: Setting up a recipe</a></li>
  </ul></li>
  <li><a href="#exercise-3-regularizing-a-linear-model-using-lasso-ridge-and-mixed-models" id="toc-exercise-3-regularizing-a-linear-model-using-lasso-ridge-and-mixed-models" class="nav-link" data-scroll-target="#exercise-3-regularizing-a-linear-model-using-lasso-ridge-and-mixed-models"><span class="header-section-number">4.3</span> Exercise 3: Regularizing a linear model using lasso, ridge, and mixed models</a>
  <ul class="collapse">
  <li><a href="#exercise-3a-setting-up-and-evaluating-lasso-regression" id="toc-exercise-3a-setting-up-and-evaluating-lasso-regression" class="nav-link" data-scroll-target="#exercise-3a-setting-up-and-evaluating-lasso-regression"><span class="header-section-number">4.3.1</span> Exercise 3a: Setting up and evaluating Lasso Regression</a>
  <ul class="collapse">
  <li><a href="#exercise-3a-i" id="toc-exercise-3a-i" class="nav-link" data-scroll-target="#exercise-3a-i"><span class="header-section-number">4.3.1.1</span> Exercise 3a i:</a></li>
  <li><a href="#exercise-3a-ii" id="toc-exercise-3a-ii" class="nav-link" data-scroll-target="#exercise-3a-ii"><span class="header-section-number">4.3.1.2</span> Exercise 3a ii:</a></li>
  <li><a href="#exercise-3a-iii" id="toc-exercise-3a-iii" class="nav-link" data-scroll-target="#exercise-3a-iii"><span class="header-section-number">4.3.1.3</span> Exercise 3a iii:</a></li>
  <li><a href="#exercise-3a-iv" id="toc-exercise-3a-iv" class="nav-link" data-scroll-target="#exercise-3a-iv"><span class="header-section-number">4.3.1.4</span> Exercise 3a iv:</a></li>
  <li><a href="#exercise-3a-v" id="toc-exercise-3a-v" class="nav-link" data-scroll-target="#exercise-3a-v"><span class="header-section-number">4.3.1.5</span> Exercise 3a v:</a></li>
  <li><a href="#exercise-3a-vi" id="toc-exercise-3a-vi" class="nav-link" data-scroll-target="#exercise-3a-vi"><span class="header-section-number">4.3.1.6</span> Exercise 3a vi:</a></li>
  <li><a href="#exercise-3a-vii" id="toc-exercise-3a-vii" class="nav-link" data-scroll-target="#exercise-3a-vii"><span class="header-section-number">4.3.1.7</span> Exercise 3a vii:</a></li>
  </ul></li>
  <li><a href="#exercise-3b-ridge-regression" id="toc-exercise-3b-ridge-regression" class="nav-link" data-scroll-target="#exercise-3b-ridge-regression"><span class="header-section-number">4.3.2</span> Exercise 3b: Ridge Regression</a>
  <ul class="collapse">
  <li><a href="#exercise-3b-i" id="toc-exercise-3b-i" class="nav-link" data-scroll-target="#exercise-3b-i"><span class="header-section-number">4.3.2.1</span> Exercise 3b i:</a></li>
  <li><a href="#exercise-3b-i-1" id="toc-exercise-3b-i-1" class="nav-link" data-scroll-target="#exercise-3b-i-1"><span class="header-section-number">4.3.2.2</span> Exercise 3b i:</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Regularization</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The goal of this exercise session is to review different regularization techniques, both, in theory and application. We start out by briefly reviewing <strong>ordinary least squares (OLS)</strong> estimation and quickly move on to a more in-depth analysis of <strong>ridge</strong> and <strong>lasso regression</strong>.</p>
<section id="exercises" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Exercises</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidymodels"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"glmnet"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggtext' was built under R version 4.4.1</code></pre>
</div>
</div>
<section id="exercise-1-loss-functions-in-the-context-of-ols-ridge-and-lasso-regression" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="exercise-1-loss-functions-in-the-context-of-ols-ridge-and-lasso-regression"><span class="header-section-number">4.1</span> Exercise 1: Loss functions in the context of OLS, ridge, and lasso regression</h2>
<p>In Statistics I/II, we learned that OLS is the cornerstone of linear regression analysis. It allows us to explore and quantify the relationship between the response variable and the regressors in a relatively simple but meaningful way. We can extend the idea of a simple linear regression by adding a penalty term to the loss function we want to minimize. This process is called regularization and has been introduced in the lecture in terms of ridge and lasso regression.</p>
<p>The goal of this initial exercise is to review some theoretical aspects of OLS, ridge, and lasso regression.</p>
<section id="exercise-1a-ols" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="exercise-1a-ols"><span class="header-section-number">4.1.1</span> Exercise 1a : OLS</h3>
<p>Consider a simple linear model, with a quantitative response variable <span class="math inline">\(Y\)</span> and a single predictor <span class="math inline">\(X\)</span>. The simple linear model then assumes (among other things) that there is approximately a linear relationship between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>, i.e.,</p>
<p><span class="math display">\[ Y \approx \beta_0 + \beta_1 X. \]</span></p>
<p>with unknown coefficients <span class="math inline">\(\beta_0,\beta_1\)</span>. In order to obtain the best estimate <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> for a given sample we can minimize the MSE</p>
<p><span class="math display">\[ \begin{equation} \min_{\beta_0,\beta_1} MSE = \frac{1}{N}\sum_{n=1}^{N} (y_n - (\beta_0 + \beta_1 x_n))^2 \end{equation} \]</span></p>
<p>where <span class="math inline">\(N = \mathrm{length(Y)}\)</span>, <span class="math inline">\(y_1,…,y_N\)</span> is a realized sample of <span class="math inline">\(Y\)</span>, and <span class="math inline">\(x_1,…,x_N\)</span> is a realized sample of <span class="math inline">\(X\)</span>.</p>
<p>Show, that</p>
<p><span class="math display">\[
\begin{align*}
\hat \beta_1 &amp;= \frac{\sum_{n=1}^N (x_n - \bar x)(y_n-\bar y)}{\sum_{n=1}^{N}(x_n-\bar x)^2}\\
\hat\beta_0 &amp;= \bar y - \hat\beta_1\bar x.
\end{align*}
\]</span></p>
<p>with <span class="math inline">\(\bar x = \frac{1}{N}\sum_{n=1}^{N}x_n\)</span> and <span class="math inline">\(\bar y = \frac{1}{N}\sum_{n=1}^{N}y_n\)</span> minimizes the minimization problem above. You can assume that the critical points calculated using the partial derivatives are in fact minima and that <span class="math inline">\(\sum_{n=1}^{N}(x_n-\bar x)^2\neq 0\)</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">
<p>First, calculate the partial derivatives of</p>
<p><span id="eq-Loss_sol"><span class="math display">\[
L(\beta_0,\beta_1) = \frac{1}{N}\sum_{n=1}^{N} (y_n - (\beta_0 + \beta_1 x_n))^2
\tag{4.1}\]</span></span></p>
<p>with respect to <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_0\)</span>.</p>
<p><span class="math display">\[
\begin{align*}
\frac{\partial}{\partial \beta_0} L(\beta_0,\beta_1) &amp;= \frac{1}{N}\sum_{n=1}^{N} -2(y_n-(\beta_0 + \beta_1x_n))\\
&amp;= -2\bar y + 2\beta_0 +2\beta_1 \bar x \\
&amp;\overset{!}{=}0 \\
\frac{\partial}{\partial \beta_1} L(\beta_0,\beta_1) &amp;= \frac{1}{N}\sum_{n=1}^{N} -x_n(2(y_n-(\beta_0+\beta_1x_n))) \\
&amp;= -2\overline{xy} + 2\frac{1}{N}\sum_{n=1}^{N} x_n\beta_0+\beta_1x_n^2\\
&amp;= -2\overline{xy} + 2\beta_0 \bar x + 2\beta_1 \overline{x^2}\\
&amp;\overset{!}{=}0
\end{align*}
\]</span></p>
<p>Solving the first term for <span class="math inline">\(\beta_0\)</span> yields</p>
<p><span class="math display">\[
\beta_0 = \bar y - \beta_1\bar x.
\]</span></p>
<p>In order to solve the second term for <span class="math inline">\(\beta_1\)</span> we can utilize this newly acquired representation of <span class="math inline">\(\beta_0\)</span>:</p>
<p><span class="math display">\[
\begin{align*}
-2\overline{xy} + 2\beta_0 \bar x + 2\beta_1 \overline{x^2} = -2\overline{xy} + 2(\bar y - \beta_1\bar x) \bar x + 2\beta_1 \overline{x^2} \overset{!}{=}0.
\end{align*}
\]</span></p>
<p>Then,</p>
<p><span class="math display">\[
\begin{align*}
-2\overline{xy} + 2(\bar y - \beta_1\bar x) \bar x + 2\beta_1 \overline{x^2}
&amp;= -2\overline{xy} + 2\bar y \bar x- 2\beta_1\bar x^2+ 2\beta_1 \overline{x^2}\\
&amp;\overset{!}{=} 0.
\end{align*}
\]</span></p>
<p>This can easily be solved for <span class="math inline">\(\beta_1\)</span>, which yields</p>
<p><span class="math display">\[
\beta_1 = \frac{\sum_{n=1}^N (x_n - \bar x)(y_n-\bar y)}{\sum_{n=1}^{N}(x_n-\bar x)^2}.
\]</span></p>
<p>Note, that</p>
<p><span class="math display">\[
\begin{align*}
\sum_{n=1}^N (x_n - \bar x)(y_n-\bar y) &amp;= \sum_{n=1}^N x_n y_n -\bar xy_n-x_n\bar y + \bar x \bar y\\
&amp;= N(\overline{xy} - \bar x\bar y - \bar x \bar y + \bar x \bar y)\\
&amp;= N(\overline{xy}-\bar x\bar y)
\end{align*}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\begin{align*}
\sum_{n=1}^{N}(x_n-\bar x)^2 &amp;= \sum_{n=1}^{N}x_n^2 - 2x_n\bar x + \bar x^2\\
&amp;= N(\overline{x^2} - 2\bar x ^2 + \bar x^2)\\
&amp;= N(\overline{x^2} - \bar x ^2)
\end{align*}
\]</span></p>
</div>
</div>
</section>
<section id="exercise-1b-ridge-and-lasso-regression" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="exercise-1b-ridge-and-lasso-regression"><span class="header-section-number">4.1.2</span> Exercise 1b: Ridge and lasso regression</h3>
<p>Consider a linear model, where there is a quantitative response variable <span class="math inline">\(Y\)</span> and a predictor <span class="math inline">\(X = (1, X_1,...,X_k)\)</span>, i.e.&nbsp;there are <span class="math inline">\(k\in\mathbb{N}\)</span> different features. The linear model then assumes (among other things) that there is approximately a linear relationship between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>, i.e.,</p>
<p><span class="math display">\[ Y \approx \beta_0 + \beta_1 X_1 + ... +\beta_k X_k. \]</span></p>
<p>with unknown coefficients <span class="math inline">\(\beta_0,...,\beta_k\)</span>.</p>
<p>In the lecture, we have already seen that the loss function for ridge and lasso regression is given by</p>
<p><span class="math display">\[
\mathcal{L}_{\mathrm{ridge}}(\beta,\lambda) = \sum_{n=1}^{N} (y_n - \hat{y}_n)^2 + \lambda \sum_{i=0}^{k} \beta_j^2
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\mathcal{L}_{\mathrm{lasso}}(\beta,\lambda) = \sum_{n=1}^{N} (y_n - \hat{y}_n)^2 + \lambda \sum_{i=0}^{k} |\ \beta_j\ |,
\]</span></p>
<p>where <span class="math inline">\(\lambda \in [0,\infty)\)</span> .</p>
<section id="exercise-1b-i" class="level4" data-number="4.1.2.1">
<h4 data-number="4.1.2.1" class="anchored" data-anchor-id="exercise-1b-i"><span class="header-section-number">4.1.2.1</span> Exercise 1b i:</h4>
<p>Explain the following statement from the lecture:</p>
<p>“Ridge regression reduces the variance, but introduces bias.”</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution:
</div>
</div>
<div class="callout-body-container callout-body">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pictures/BV_trade.jpg" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Bias-Variance Trade-Off</figcaption>
</figure>
</div>
<p>The key point of this quote addresses the bias-variance trade-off.</p>
<p>From the lecture, we know that</p>
<p><span class="math display">\[
\hat \beta_{\mathrm{ridge}}(\lambda) = \frac{\hat\beta_{\mathrm{OLS}}}{1+\lambda}
\]</span></p>
<p>if the features are standardized and orthogonal.</p>
<ul>
<li>Bias:<br>
By growing the parameter <span class="math inline">\(\lambda\)</span>, the parameter <span class="math inline">\(\hat\beta_{\mathrm{OLS}}\)</span> shrinks. In other words, the regularization term encourages the model to have smaller coefficient values, which means it may not fit the training data as closely as an unregularized model. This means that systematic errors are introduced to the model’s predictions.</li>
<li>Variance:<br>
By growing the parameter <span class="math inline">\(\lambda\)</span>, we reduce variance by shrinking the coefficients’ values, which discourages them from taking very high values. This effectively constrains the model’s complexity and makes it less prone to overfitting.</li>
</ul>
</div>
</div>
</section>
<section id="exercise-1b-ii" class="level4" data-number="4.1.2.2">
<h4 data-number="4.1.2.2" class="anchored" data-anchor-id="exercise-1b-ii"><span class="header-section-number">4.1.2.2</span> Exercise 1b ii:</h4>
<p>Consider the following statements and decide whether ridge or lasso regression should be applied.</p>
<ol type="1">
<li><p>You are building a predictive model for stock price prediction, and you have a large number of potential predictors. Some of these predictors might be highly correlated with each other.</p></li>
<li><p>You are modeling housing prices, and you want to prevent the model from overfitting to the training data.</p></li>
<li><p>You are working on a marketing project where you have a dataset with a mix of numerical and categorical features. You need to build a regression model to predict customer lifetime value.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution:
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Lasso regression should be used in this scenario because it can perform feature selection by driving some coefficients to zero. This is especially helpful if there are many features as it helps in dealing with correlated predictors.</p></li>
<li><p>Ridge regression is more suitable because it provides a smoother and more continuous shrinkage of coefficients, which reduces the risk of overfitting.</p></li>
<li><p>Lasso regression might be a more suitable choice as it can perform feature selection and even drive the coefficient for some categorical values to 0.</p></li>
</ol>
</div>
</div>
</section>
<section id="exercise-1b-iii" class="level4" data-number="4.1.2.3">
<h4 data-number="4.1.2.3" class="anchored" data-anchor-id="exercise-1b-iii"><span class="header-section-number">4.1.2.3</span> Exercise 1b iii:</h4>
<p>Come up with a scenario where a mixed model, i.e.&nbsp;an elastic net might be a good choice.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution:
</div>
</div>
<div class="callout-body-container callout-body">
<p>A healthcare dataset is given to predict a patient’s readmission probability with numerous correlated features. The aim is to build a model that predicts accurately, selects the most relevant features, and mitigates multicollinearity. Here, an elastic net is the preferred choice because it combines Ridge and Lasso regression, effectively handling multicollinearity while performing feature selection, making it ideal for this complex healthcare dataset.</p>
</div>
</div>
</section>
</section>
</section>
<section id="exercise-2-another-lesson-on-data-preparation-and-model-specification" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="exercise-2-another-lesson-on-data-preparation-and-model-specification"><span class="header-section-number">4.2</span> Exercise 2: Another lesson on data preparation and model specification</h2>
<p>In this exercise, we will revisit the <code>rent</code> dataset, but instead of looking at rent prices in Augsburg, we will now consider rent prices in Munich. We will briefly prepare the dataset and create a recipe similar to Exercise 2b ii on Sheet 02 but in a more sophisticated fashion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data_muc <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/data_muc_filtered.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="exercise-2a-data-preparation" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="exercise-2a-data-preparation"><span class="header-section-number">4.2.1</span> Exercise 2a: Data preparation</h3>
<p>Explain how we preprocess our data in the following code chunk.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>data_muc_filtered <span class="ot">&lt;-</span> data_muc <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(<span class="st">"X"</span>,<span class="st">"serviceCharge"</span>,<span class="st">"heatingType"</span>,<span class="st">"picturecount"</span>,<span class="st">"totalRent"</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">"firingTypes"</span>,<span class="st">"typeOfFlat"</span>,<span class="st">"noRoomsRange"</span>, <span class="st">"petsAllowed"</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">"livingSpaceRange"</span>,<span class="st">"regio3"</span>,<span class="st">"heatingCosts"</span>, <span class="st">"floor"</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">"date"</span>, <span class="st">"pricetrend"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  na.omit <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">interiorQual =</span> <span class="fu">factor</span>(</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>      interiorQual,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"simple"</span>, <span class="st">"normal"</span>, <span class="st">"sophisticated"</span>, <span class="st">"luxury"</span>),</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"simple"</span>, <span class="st">"normal"</span>, <span class="st">"sophisticated"</span>, <span class="st">"luxury"</span>),</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">ordered =</span> <span class="cn">TRUE</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">condition =</span> <span class="fu">factor</span>(</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>      condition,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"need_of_renovation"</span>, <span class="st">"negotiable"</span>,<span class="st">"well_kept"</span>,<span class="st">"refurbished"</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"first_time_use_after_refurbishment"</span>,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"modernized"</span>, <span class="st">"fully_renovated"</span>, <span class="st">"mint_condition"</span>,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"first_time_use"</span>),</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">ordered =</span> <span class="cn">TRUE</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">geo_plz =</span> <span class="fu">factor</span>(geo_plz)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.logical, <span class="sc">~</span> <span class="fu">as.numeric</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(baseRent <span class="sc">&lt;=</span> <span class="dv">4000</span>, livingSpace <span class="sc">&lt;=</span> <span class="dv">200</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution:
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>We first select all the columns we want to use by removing the remaining columns using <code>select(!c( … ).</code></li>
<li>Then, we remove all the <code>NA</code> values.</li>
<li>Next, we mutate our data as follows:
<ol type="1">
<li>We convert the feature <code>interiorQual</code> to a factor (basically Rs encoding for ordinal features), which allows us for example, to value a luxury <code>interiorQual</code> higher than a simple <code>interiorQual</code>. We set the levels and labels to the same name and pass the argument <code>TRUE</code> to the <code>ordered</code> option to indicate that we have indeed an ordinal feature.</li>
<li>The same procedure is applied to the <code>condition</code> of the flat.</li>
<li>Instead of setting specific levels for the zip codes, we simply convert them to factors in order define nominal values. Note, that in this case we also do not set the <code>ordered</code> parameter, since the sheer value of the zip code in terms of their numerical value shouldn’t influence the dependent variable <code>totalRent</code>.</li>
</ol></li>
<li>In the second to last step we convert all logical values to numeric values. Here, <code>TRUE</code> corresponds to <code>1</code> and <code>FALSE</code> to <code>0</code> respectively.</li>
<li>The last step concerns some “quick and dirty” data cleaning where we remove any flat that costs more than 4000 EUR or is bigger than 200 <span class="math inline">\(m^2\)</span>.</li>
</ol>
</div>
</div>
</section>
<section id="exercise-2b-setting-up-resampling" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="exercise-2b-setting-up-resampling"><span class="header-section-number">4.2.2</span> Exercise 2b: Setting up resampling</h3>
<p>Similar to exercise Exercise 2a: i-iii on Sheet 02, create</p>
<ul>
<li><p>an initial split object called <code>split</code> with the <code>data_muc_filtered</code> tibble,</p></li>
<li><p>a training set called <code>data_train</code> and a test set called <code>data_test</code> using the <code>training</code> and <code>testing</code> functions respectively, and</p></li>
<li><p>an instance <code>folds</code> of the <code>vfold_cv</code> class with the parameters <code>data = data_train</code> and <code>v = 10</code>.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">###################</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Continue here ##</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">###################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(data_muc_filtered)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>data_train <span class="ot">&lt;-</span> <span class="fu">training</span>(split)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>data_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(split)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(data_train, <span class="at">v =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercise-2c-setting-up-a-recipe" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="exercise-2c-setting-up-a-recipe"><span class="header-section-number">4.2.3</span> Exercise 2c: Setting up a recipe</h3>
<p>On the last exercise sheet, we created a simple recipe, only containing the formula we wanted to use on our simple linear model. This process can be extended by adding a multitude of different steps for preprocessing the underlying training data.</p>
<p>For each of the following updates and steps, explain their purpose and what they aim to achieve.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>rec_lm <span class="ot">&lt;-</span> <span class="fu">recipe</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> baseRent <span class="sc">~</span>., </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data_train</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_role</span>(scoutId, <span class="at">new_role =</span> <span class="st">"ID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_ordinalscore</span>(interiorQual, condition)<span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(geo_plz)<span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_zv</span>(<span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_predictors</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution:
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>We first set up the recipe by specifying the formula and data used in each step. Note, that by using the expression <code>baseRent ~.</code> we indicate that we want to fit every variable in the <code>data_train</code> dataset on the dependent variable <code>baseRent</code>.</p></li>
<li><p>The <code>update_role</code> function assigns the feature <code>scoutId</code> to a new role called <code>ID</code>. By doing so, the feature <code>scoutId</code> is no longer used as a predictor and will no longer influence our model. We will still keep it in the loop, however in case we want to access a specific listing that is only accessible using the unique <code>scoutId</code>.</p></li>
<li><p>We then convert the factors <code>interiorQual</code> and <code>condition</code> to ordinal scores by using the <code>step_ordinalscore</code> function. The translation uses a linear scale, i.e.&nbsp;for the feature <code>interiorQual</code> the level <code>simple</code> corresponds to the value <code>0</code> and <code>luxury</code> corresponds to the value <code>4</code>.</p></li>
<li><p>Afterward, we create dummy variables for each zip code. Here, every zip code in the <code>data_train</code> is treated as a new variable. Thus, we are basically replacing the feature <code>geo_plz</code> with 82 new features, each representing one of the 82 zip codes available in the training data.</p></li>
<li><p>The <code>step_zv</code> (zero variance filter) function removes all variables that contain only a single value. If, for example, a zip code does not occur in any of the entries of <code>data_train</code>, the whole column will be set to zero and effectively not affect our model. Thus it is in our best interest to remove those columns.</p></li>
<li><p>In the last step, we normalize all predictors, i.e., transform them in a way that they have a standard deviation of 1 and mean zero.</p></li>
</ol>
</div>
</div>
</section>
</section>
<section id="exercise-3-regularizing-a-linear-model-using-lasso-ridge-and-mixed-models" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="exercise-3-regularizing-a-linear-model-using-lasso-ridge-and-mixed-models"><span class="header-section-number">4.3</span> Exercise 3: Regularizing a linear model using lasso, ridge, and mixed models</h2>
<p>In this last exercise we will make use of the previously performed data preparation by modeling a workflow and selecting the best model based on some performance metrics we will specify later.</p>
<section id="exercise-3a-setting-up-and-evaluating-lasso-regression" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="exercise-3a-setting-up-and-evaluating-lasso-regression"><span class="header-section-number">4.3.1</span> Exercise 3a: Setting up and evaluating Lasso Regression</h3>
<p>The approach is similar to Exercise 2c on Exercise Sheet 02, where I demonstrated how to train multiple models. So if you get stuck in some of the exercises you should revisit this sheet and try to reproduce the steps this way.</p>
<p>While this sub-exercise will seem kind of lengthy again, the other sub-exercises can be solved a lot quicker, since we can recycle many of the objects we create throughout this sub-exercise.</p>
<section id="exercise-3a-i" class="level4" data-number="4.3.1.1">
<h4 data-number="4.3.1.1" class="anchored" data-anchor-id="exercise-3a-i"><span class="header-section-number">4.3.1.1</span> Exercise 3a i:</h4>
<p>First, create an instance of the <code>linear_reg</code> class called <code>model_lasso</code> with parameters <code>penalty = tune()</code> and <code>mixture = 1.0</code>. By setting the <code>penalty</code> parameter to <code>tune()</code>, we specify that the penalty is a tuning parameter that we want to optimize later. By setting the <code>mixture</code> parameter to <code>1.0</code> we specify that the model should be a pure lasso regression (setting it to 0.0 indicates that we are using a pure ridge regression). If calling the model <code>model_lasso</code> results in the same output as below, you solved the exercise correctly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>model_lasso <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>(<span class="at">penalty =</span> <span class="fu">tune</span>(), <span class="at">mixture =</span> <span class="fl">1.0</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>model_lasso</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression Model Specification (regression)

Main Arguments:
  penalty = tune()
  mixture = 1

Computational engine: lm </code></pre>
</div>
</div>
</section>
<section id="exercise-3a-ii" class="level4" data-number="4.3.1.2">
<h4 data-number="4.3.1.2" class="anchored" data-anchor-id="exercise-3a-ii"><span class="header-section-number">4.3.1.2</span> Exercise 3a ii:</h4>
<p>Since we have set the penalty value to <code>tune()</code> we have to specify a grid in which want to check for the best value. We can pass the grid values to our model by using the <code>set_engine</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>penalty <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">15</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Update the model <code>model_lasso</code> by completing the following Code snippet. Fill the gap by piping <code>model_lasso</code>to the <code>set_engine</code> function where you pass the parameters <code>engine = "glmnet"</code> and <code>path_values = penalty</code>. If you are interested in why we specifically have to use the <code>path_values</code> argument, you can check out this <a href="https://parsnip.tidymodels.org/reference/glmnet-details.html">manual</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>model_lasso <span class="ot">&lt;-</span> model_lasso <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">###################</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Continue here ##</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">###################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can check whether you have successfully updated the model by calling <code>model_lasso</code> and comparing your output to the one below. If they coincide you have solved the exercise correctly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>model_lasso <span class="ot">&lt;-</span> model_lasso <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">"glmnet"</span>, <span class="at">path_values =</span> penalty)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>model_lasso</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression Model Specification (regression)

Main Arguments:
  penalty = tune()
  mixture = 1

Engine-Specific Arguments:
  path_values = penalty

Computational engine: glmnet </code></pre>
</div>
</div>
</section>
<section id="exercise-3a-iii" class="level4" data-number="4.3.1.3">
<h4 data-number="4.3.1.3" class="anchored" data-anchor-id="exercise-3a-iii"><span class="header-section-number">4.3.1.3</span> Exercise 3a iii:</h4>
<p>Similarly to Exercise 2c i on Exercise Sheet 02, create a workflow called <code>glmnet_wflow</code> by creating an instance of the <code>workflow</code> class without passing any additional arguments, piping it to the <code>add_model</code> function with <code>model_lasso</code> as an argument, and finally piping it to the <code>add_recipe</code> function with <code>rec_lm</code> as an argument.</p>
<p>You can check whether you have successfully set up the workflow by calling <code>glmnet_wflow</code> and comparing your output to the one below. If they coincide you have solved the exercise correctly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>glmnet_wflow <span class="ot">&lt;-</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(model_lasso) <span class="sc">%&gt;%</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(rec_lm)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>glmnet_wflow</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: linear_reg()

── Preprocessor ────────────────────────────────────────────────────────────────
4 Recipe Steps

• step_ordinalscore()
• step_dummy()
• step_zv()
• step_normalize()

── Model ───────────────────────────────────────────────────────────────────────
Linear Regression Model Specification (regression)

Main Arguments:
  penalty = tune()
  mixture = 1

Engine-Specific Arguments:
  path_values = penalty

Computational engine: glmnet </code></pre>
</div>
</div>
</section>
<section id="exercise-3a-iv" class="level4" data-number="4.3.1.4">
<h4 data-number="4.3.1.4" class="anchored" data-anchor-id="exercise-3a-iv"><span class="header-section-number">4.3.1.4</span> Exercise 3a iv:</h4>
<p>Given the following metric set and the previously created workflow, we can now finally train our lasso model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>multi_metric <span class="ot">&lt;-</span> <span class="fu">metric_set</span>(rsq,rmse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In order to do so, create an object called <code>glmnet_res</code> (res stands for resampling in that context) by assigning the <code>glmnet_wflow</code> object to it and piping it to the <code>tune_grid</code> function. Recall, that this is the exact same process as in Exercise 2c i on Sheet 02. As arguments for the <code>tune_grid</code> function, you have to pass <code>tibble(penalty), multi_metric</code>, and <code>folds</code>.</p>
<p>You can check whether you have successfully trained the model by calling <code>head(glmnet_res)</code> and comparing your output to the one below. If they coincide you have solved the exercise correctly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>glmnet_res <span class="ot">&lt;-</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  glmnet_wflow <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tune_grid</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid =</span> <span class="fu">tibble</span>(penalty),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> multi_metric,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> folds</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>glmnet_res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Tuning results
# 10-fold cross-validation 
# A tibble: 10 × 4
   splits             id     .metrics           .notes          
   &lt;list&gt;             &lt;chr&gt;  &lt;list&gt;             &lt;list&gt;          
 1 &lt;split [1471/164]&gt; Fold01 &lt;tibble [200 × 5]&gt; &lt;tibble [0 × 3]&gt;
 2 &lt;split [1471/164]&gt; Fold02 &lt;tibble [200 × 5]&gt; &lt;tibble [0 × 3]&gt;
 3 &lt;split [1471/164]&gt; Fold03 &lt;tibble [200 × 5]&gt; &lt;tibble [0 × 3]&gt;
 4 &lt;split [1471/164]&gt; Fold04 &lt;tibble [200 × 5]&gt; &lt;tibble [0 × 3]&gt;
 5 &lt;split [1471/164]&gt; Fold05 &lt;tibble [200 × 5]&gt; &lt;tibble [0 × 3]&gt;
 6 &lt;split [1472/163]&gt; Fold06 &lt;tibble [200 × 5]&gt; &lt;tibble [0 × 3]&gt;
 7 &lt;split [1472/163]&gt; Fold07 &lt;tibble [200 × 5]&gt; &lt;tibble [0 × 3]&gt;
 8 &lt;split [1472/163]&gt; Fold08 &lt;tibble [200 × 5]&gt; &lt;tibble [0 × 3]&gt;
 9 &lt;split [1472/163]&gt; Fold09 &lt;tibble [200 × 5]&gt; &lt;tibble [0 × 3]&gt;
10 &lt;split [1472/163]&gt; Fold10 &lt;tibble [200 × 5]&gt; &lt;tibble [0 × 3]&gt;</code></pre>
</div>
</div>
</section>
<section id="exercise-3a-v" class="level4" data-number="4.3.1.5">
<h4 data-number="4.3.1.5" class="anchored" data-anchor-id="exercise-3a-v"><span class="header-section-number">4.3.1.5</span> Exercise 3a v:</h4>
<p>Consider the following plot that depicts the mean out-of-sample RMSE for different penalty values. The dashed lines represent the optimal penalty and the largest value of the penalty such that the mean MSE is within one standard error of the optimum.</p>
<p>Decide and present an argument for which line is the optimal penalty. Furthermore, explain why we would choose the non-optimal penalty in lasso regression.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_regularization_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution:
</div>
</div>
<div class="callout-body-container callout-body">
<p>The red line depicts the optimal penalty, since it intersects the minimum of the RMSE. Especially in Lasso regression an optimal penalty parameter is often smaller than we desire. The effect of a smaller penalty parameter is, that we do not eliminate as many features as we anticipated. By increasing the penalty we can effectively overcome this problem as more features are eliminated. A disadvantage however is, that we sacrefice out-of-sample performance, as the newly chosen penalty is not optimal anymore.</p>
</div>
</div>
</section>
<section id="exercise-3a-vi" class="level4" data-number="4.3.1.6">
<h4 data-number="4.3.1.6" class="anchored" data-anchor-id="exercise-3a-vi"><span class="header-section-number">4.3.1.6</span> Exercise 3a vi:</h4>
<p>Given all the different models created with the penalty grid we specified in Exercise 3a ii, how can we select the best model with respect to a given metric? It turns out that this is rather simple! Explain each of the steps below and recreate the result for the metric <code>rsq</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>glm_res_best<span class="ot">&lt;-</span> glmnet_res <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_by_one_std_err</span>(<span class="at">metric =</span> <span class="st">"rmse"</span>, <span class="fu">desc</span>(penalty))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#optionally, the method below can be chosen as well</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  select_best(metric = "rmse")</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>best_penalty <span class="ot">&lt;-</span> glm_res_best<span class="sc">$</span>penalty</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>last_glm_model <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>(<span class="at">penalty =</span> best_penalty, <span class="at">mixture =</span> <span class="fl">1.0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"glmnet"</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>last_glm_wflow <span class="ot">&lt;-</span> glmnet_wflow <span class="sc">%&gt;%</span> </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_model</span>(last_glm_model)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>last_glm_fit <span class="ot">&lt;-</span> </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  last_glm_wflow <span class="sc">%&gt;%</span> </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">last_fit</span>(split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution:
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>By using the <code>select_best</code> function we can directly select the best model with respect to a passed metric (in this case <code>rmse</code>). The return value is a combination of the tuning parameter and the corresponding model that performed best.</li>
<li>We save the optimal penalty which we later want to use when creating our final best model.</li>
<li>We then create a new model called <code>last_glm_model</code> with the previously selected optimal penalty.</li>
<li>This last model can then be incorporated into the already existing workflow <code>glmnet_wflow</code> by simply using the <code>update_model</code> function, where we pass the newly created <code>last_glm_model</code>.</li>
<li>After updating the workflow we then have to fit our final model. The <code>last_fit</code> function where we pass the whole training and testing split <code>split</code>, fits the model on the whole training split and automatically evaluates it on the test split. Note, that before this point, the model has never observed any sample of the test set.</li>
</ol>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>glm_res_best<span class="ot">&lt;-</span> glmnet_res <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_by_one_std_err</span>(<span class="at">metric =</span> <span class="st">"rsq"</span>, <span class="fu">desc</span>(penalty))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  select_best(metric = "rsq")</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>best_penalty <span class="ot">&lt;-</span> glm_res_best<span class="sc">$</span>penalty</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>last_glm_model <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>(<span class="at">penalty =</span> best_penalty, <span class="at">mixture =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"glmnet"</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>last_glm_wflow <span class="ot">&lt;-</span> glmnet_wflow <span class="sc">%&gt;%</span> </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_model</span>(last_glm_model)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>last_glm_fit <span class="ot">&lt;-</span> </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  last_glm_wflow <span class="sc">%&gt;%</span> </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">last_fit</span>(split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Et voilà, we have now created our final model <code>last_glm_fit</code> based on the best value for the penalty with respect to the <code>rmse</code> or <code>rsq</code> metric.</p>
</section>
<section id="exercise-3a-vii" class="level4" data-number="4.3.1.7">
<h4 data-number="4.3.1.7" class="anchored" data-anchor-id="exercise-3a-vii"><span class="header-section-number">4.3.1.7</span> Exercise 3a vii:</h4>
<p>A question that surely arises is, how we can see which of the the coefficients were set to 0 by the lasso regression.</p>
<p>By piping the <code>last_glm_fit</code> model to the <code>extract_fit_parsnip</code> function and piping the result to the <code>tidy</code> function, we can effectively extract the parameters for our final mode. Complete the following sequence of operations to filter for all the variables set to <code>0</code>. Which variables were set to <code>0</code>?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>last_glm_fit <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  extract_fit_parsnip <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  tidy <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">#################</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">##Continue Here##</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="do">#################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>last_glm_fit <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  extract_fit_parsnip <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  tidy <span class="sc">%&gt;%</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(estimate <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(estimate))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 3
   term           estimate penalty
   &lt;chr&gt;             &lt;dbl&gt;   &lt;dbl&gt;
 1 (Intercept)      1648.     10.5
 2 livingSpace       553.     10.5
 3 interiorQual      120.     10.5
 4 geo_plz_X80538     43.9    10.5
 5 geo_plz_X80804     40.6    10.5
 6 newlyConst         38.4    10.5
 7 lift               38.2    10.5
 8 condition          34.5    10.5
 9 hasKitchen         34.5    10.5
10 geo_plz_X80333     33.7    10.5
# ℹ 21 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>last_glm_fit <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  extract_fit_parsnip <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  tidy <span class="sc">%&gt;%</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(estimate  <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 35 × 1
   term          
   &lt;chr&gt;         
 1 balcony       
 2 noRooms       
 3 garden        
 4 geo_plz_X80339
 5 geo_plz_X80635
 6 geo_plz_X80636
 7 geo_plz_X80637
 8 geo_plz_X80639
 9 geo_plz_X80643
10 geo_plz_X80673
# ℹ 25 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="exercise-3b-ridge-regression" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="exercise-3b-ridge-regression"><span class="header-section-number">4.3.2</span> Exercise 3b: Ridge Regression</h3>
<p>In this last exercise, we want to reap the fruits of our labor by easily training a ridge regression model.</p>
<section id="exercise-3b-i" class="level4" data-number="4.3.2.1">
<h4 data-number="4.3.2.1" class="anchored" data-anchor-id="exercise-3b-i"><span class="header-section-number">4.3.2.1</span> Exercise 3b i:</h4>
<p>Consider the following code snippet which is all we need for training a new model. Explain each of the following steps which are performed to train the new model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>model_ridge <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>(<span class="at">penalty =</span> <span class="fu">tune</span>(), <span class="at">mixture =</span> <span class="fl">0.0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">"glmnet"</span>, <span class="at">path_values =</span> penalty)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>glmnet_wflow <span class="ot">&lt;-</span> glmnet_wflow <span class="sc">%&gt;%</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_model</span>(model_ridge)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>glmnet_res <span class="ot">&lt;-</span> </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  glmnet_wflow <span class="sc">%&gt;%</span> </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tune_grid</span>(</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid =</span> <span class="fu">tibble</span>(penalty),</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> multi_metric,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> folds</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution:
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>We first define a model called <code>model_ridge</code>, which is a simple linear model but instead of setting the <code>mixture</code> parameter to <code>1</code> as we did in the lasso regression, we now set it to <code>0</code> in order to indicate that we want to fit a ridge regression model. We then set the engine and path values for our grid to the same values as we did for the lasso regression model.</p></li>
<li><p>By using the <code>update_model</code> function, we can pass our new model to the workflow object previously created and make sure that this model is indeed fitted in the next step.</p></li>
<li><p>In the last step, we only have to pass out updated workflow <code>glmnet_wflow</code> to the <code>tune_grid</code> function, which fits the model on all folds of the cross-validation across the penalty grid. By specifying the <code>metrics</code> option, we also make sure that the specified metrics are saved.</p></li>
</ol>
</div>
</div>
</section>
<section id="exercise-3b-i-1" class="level4" data-number="4.3.2.2">
<h4 data-number="4.3.2.2" class="anchored" data-anchor-id="exercise-3b-i-1"><span class="header-section-number">4.3.2.2</span> Exercise 3b i:</h4>
<p>Given the tibble <code>ridge_metrics</code>, create two plots, where you display both, the mean <code>rmse</code> and mean <code>rsq</code> of the model across all folds for different penalty values. Additionally, mark the optimal penalty value.</p>
<p>An example of what one of those plots could look like is below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ridge_metrics <span class="ot">&lt;-</span> glmnet_res <span class="sc">%&gt;%</span> collect_metrics</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>ridge_metrics <span class="sc">%&gt;%</span> <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">"rsq"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>penalty, <span class="at">y =</span> mean)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> penalty[<span class="fu">which.max</span>(mean)]),</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_markdown</span>(),</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_markdown</span>()</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average R&lt;sup&gt;2&lt;/sup&gt; across all hold-out samples for different penalty values"</span>,</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"The dotted red line indicates where the maximum value is attained."</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">" mean R&lt;sup&gt;2&lt;/sup&gt;"</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_regularization_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02_linear_models.html" class="pagination-link" aria-label="Linear Models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Linear Models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04_regression_trees.html" class="pagination-link" aria-label="Regression Trees">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regression Trees</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>