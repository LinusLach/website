<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Lineare Regression – Data Mining Übungsmaterial</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03_Wichtige_Konzepte.html" rel="next">
<link href="./01_Einfuehrung.html" rel="prev">
<script src="site_libs/cookie-consent/cookie-consent.js"></script>
<link href="site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K9CJ1KN8ZH"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-K9CJ1KN8ZH', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"express",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  
<script>

  MathJax = {

    tex: {

      tags: 'ams'  // should be 'ams', 'none', or 'all'

    }

  };

</script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02_Lineare_Regression.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Lineare Regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Mining Übungsmaterial</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vorwort</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Einfuehrung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">(Kurz)Einführung in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Lineare_Regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Lineare Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Wichtige_Konzepte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Weiterführende Konzepte des Dataminings</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Regressions_Baeume.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regressionsbäume</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_Neuronale_Netze.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Neuronale Netze</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-penguins" id="toc-sec-penguins" class="nav-link active" data-scroll-target="#sec-penguins"><span class="header-section-number">2.1</span> Der Palmer Penguin Datensatz</a>
  <ul>
  <li><a href="#sec-descriptive_stat" id="toc-sec-descriptive_stat" class="nav-link" data-scroll-target="#sec-descriptive_stat"><span class="header-section-number">2.1.1</span> Deskriptive Statistiken</a></li>
  </ul></li>
  <li><a href="#die-einfache-lineare-regression" id="toc-die-einfache-lineare-regression" class="nav-link" data-scroll-target="#die-einfache-lineare-regression"><span class="header-section-number">2.2</span> Die einfache lineare Regression</a>
  <ul>
  <li><a href="#sec-elr" id="toc-sec-elr" class="nav-link" data-scroll-target="#sec-elr"><span class="header-section-number">2.2.1</span> Schätzung der Modellparameter in R</a>
  <ul class="collapse">
  <li><a href="#residuen" id="toc-residuen" class="nav-link" data-scroll-target="#residuen"><span class="header-section-number">2.2.1.1</span> Residuen</a></li>
  <li><a href="#koeffizienten" id="toc-koeffizienten" class="nav-link" data-scroll-target="#koeffizienten"><span class="header-section-number">2.2.1.2</span> Koeffizienten</a></li>
  </ul></li>
  <li><a href="#das-gütemaß-r2" id="toc-das-gütemaß-r2" class="nav-link" data-scroll-target="#das-gütemaß-r2"><span class="header-section-number">2.2.2</span> Das Gütemaß <span class="math inline">\(R^2\)</span></a>
  <ul class="collapse">
  <li><a href="#der-f-test" id="toc-der-f-test" class="nav-link" data-scroll-target="#der-f-test"><span class="header-section-number">2.2.2.1</span> Der <span class="math inline">\(F\)</span>-Test</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#die-multiple-lineare-regression" id="toc-die-multiple-lineare-regression" class="nav-link" data-scroll-target="#die-multiple-lineare-regression"><span class="header-section-number">2.3</span> Die multiple lineare Regression</a>
  <ul>
  <li><a href="#sec-MLRR" id="toc-sec-MLRR" class="nav-link" data-scroll-target="#sec-MLRR"><span class="header-section-number">2.3.1</span> Multiple lineare Regression in R</a></li>
  <li><a href="#interpretation-und-verlgeich-der-koeffizienten" id="toc-interpretation-und-verlgeich-der-koeffizienten" class="nav-link" data-scroll-target="#interpretation-und-verlgeich-der-koeffizienten"><span class="header-section-number">2.3.2</span> Interpretation und Verlgeich der Koeffizienten</a>
  <ul class="collapse">
  <li><a href="#dummy-encoding" id="toc-dummy-encoding" class="nav-link" data-scroll-target="#dummy-encoding"><span class="header-section-number">2.3.2.1</span> Dummy Encoding</a></li>
  </ul></li>
  <li><a href="#sec-modellannahmen" id="toc-sec-modellannahmen" class="nav-link" data-scroll-target="#sec-modellannahmen"><span class="header-section-number">2.3.3</span> Modellannahmen</a>
  <ul class="collapse">
  <li><a href="#lineare-beziehung" id="toc-lineare-beziehung" class="nav-link" data-scroll-target="#lineare-beziehung"><span class="header-section-number">2.3.3.1</span> Lineare Beziehung</a></li>
  <li><a href="#konstante-varianz-der-residuen" id="toc-konstante-varianz-der-residuen" class="nav-link" data-scroll-target="#konstante-varianz-der-residuen"><span class="header-section-number">2.3.3.2</span> Konstante Varianz der Residuen</a></li>
  <li><a href="#autokorrelation" id="toc-autokorrelation" class="nav-link" data-scroll-target="#autokorrelation"><span class="header-section-number">2.3.3.3</span> Autokorrelation</a></li>
  <li><a href="#normalität-der-residuen" id="toc-normalität-der-residuen" class="nav-link" data-scroll-target="#normalität-der-residuen"><span class="header-section-number">2.3.3.4</span> Normalität der Residuen</a></li>
  <li><a href="#sec-multikollinearitaet" id="toc-sec-multikollinearitaet" class="nav-link" data-scroll-target="#sec-multikollinearitaet"><span class="header-section-number">2.3.3.5</span> Multikollinearität</a></li>
  <li><a href="#das-problem-mit-multikollinearität" id="toc-das-problem-mit-multikollinearität" class="nav-link" data-scroll-target="#das-problem-mit-multikollinearität"><span class="header-section-number">2.3.3.6</span> Das Problem mit Multikollinearität</a></li>
  <li><a href="#weitere-wichtige-prüfkriterien" id="toc-weitere-wichtige-prüfkriterien" class="nav-link" data-scroll-target="#weitere-wichtige-prüfkriterien"><span class="header-section-number">2.3.3.7</span> Weitere wichtige Prüfkriterien</a></li>
  </ul></li>
  <li><a href="#gütemaße" id="toc-gütemaße" class="nav-link" data-scroll-target="#gütemaße"><span class="header-section-number">2.3.4</span> Gütemaße</a>
  <ul class="collapse">
  <li><a href="#korrigierter-r2" id="toc-korrigierter-r2" class="nav-link" data-scroll-target="#korrigierter-r2"><span class="header-section-number">2.3.4.1</span> Korrigierter <span class="math inline">\(R^2\)</span></a></li>
  <li><a href="#sec-AIC" id="toc-sec-AIC" class="nav-link" data-scroll-target="#sec-AIC"><span class="header-section-number">2.3.4.2</span> Akaike Information Criteria</a></li>
  <li><a href="#sec-MSE" id="toc-sec-MSE" class="nav-link" data-scroll-target="#sec-MSE"><span class="header-section-number">2.3.4.3</span> Loss Funktionen</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#übungsaufgaben" id="toc-übungsaufgaben" class="nav-link" data-scroll-target="#übungsaufgaben"><span class="header-section-number">2.4</span> Übungsaufgaben</a>
  <ul>
  <li><a href="#explorative-datenanalyse" id="toc-explorative-datenanalyse" class="nav-link" data-scroll-target="#explorative-datenanalyse"><span class="header-section-number">2.4.1</span> Explorative Datenanalyse</a></li>
  <li><a href="#einfache-lineare-regression" id="toc-einfache-lineare-regression" class="nav-link" data-scroll-target="#einfache-lineare-regression"><span class="header-section-number">2.4.2</span> Einfache lineare Regression</a></li>
  <li><a href="#kennzahlen" id="toc-kennzahlen" class="nav-link" data-scroll-target="#kennzahlen"><span class="header-section-number">2.4.3</span> Kennzahlen</a></li>
  <li><a href="#multiple-lineare-regression" id="toc-multiple-lineare-regression" class="nav-link" data-scroll-target="#multiple-lineare-regression"><span class="header-section-number">2.4.4</span> Multiple Lineare Regression</a></li>
  </ul></li>
  <li><a href="#lösungen" id="toc-lösungen" class="nav-link" data-scroll-target="#lösungen"><span class="header-section-number">2.5</span> Lösungen</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-LR" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Lineare Regression</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In diesem Kapitel setzen wir uns mit der einfachen und multiplen linearen Regression auseinander. Lineare Regressionsmodelle sind ein Grundbaustein im Kontext der Regression und des Data-Minings, da die Koeffizienten leicht interpretierbar sind und viele statistische Werkzeuge existieren, um die Sinnhaftigkeit der Modelle und deren Koeffizienten zu überprüfen.</p>
<section id="sec-penguins" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="sec-penguins"><span class="header-section-number">2.1</span> Der Palmer Penguin Datensatz</h2>
<p>Der Datensatz für diese und teilweise auch kommende Übungen ist der sogenannte <em>Palmer Penguins</em> Datensatz. Als Teil der <code>{tidyverse}</code> Library ist der Datensatz bereits vorinstalliert und wir können diesen nach dem Hinzufügen der <code>{tidyverse}</code> Library über den Befehl <code>palmerpenguins::penguins</code> abrufen. Es ist wie immer ratsam, den Datensatz als neue Variable zu speichern:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>data_penguin<span class="ot">&lt;-</span>palmerpenguins<span class="sc">::</span>penguins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Das aufrufen der <code>glimpse</code> Funktion gibt wieder einen kompakten Überblick über die verschiedenen Variabeln und Werte, welche diese annehmen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data_penguin <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 344
Columns: 8
$ species           &lt;fct&gt; Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel…
$ island            &lt;fct&gt; Torgersen, Torgersen, Torgersen, Torgersen, Torgerse…
$ bill_length_mm    &lt;dbl&gt; 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, …
$ bill_depth_mm     &lt;dbl&gt; 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, …
$ flipper_length_mm &lt;int&gt; 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186…
$ body_mass_g       &lt;int&gt; 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, …
$ sex               &lt;fct&gt; male, female, female, NA, female, male, female, male…
$ year              &lt;int&gt; 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007…</code></pre>
</div>
</div>
<p>Wie der Name des Datensatzes andeutet, enthält er Informationen über verschiedene Pinguinarten. Konkret umfasst er <span class="math inline">\(344\)</span> Beobachtungen von drei unterschiedlichen Pinguinarten, die auf verschiedenen Inseln des Palmer-Archipels in der Nähe der Antarktis leben. Die Daten wurden von Dr.&nbsp;Kristen Gorman erhoben und dienen inzwischen als Standardbeispiel für vielfältige Anwendungen in der Datenanalyse.</p>
<p>Neben der Pinguinart (<code>species</code>) und der Beobachtungsinsel (<code>island</code>) sind folgende Messgrößen enthalten: die Schnabellänge in Millimetern (<code>bill_length_mm</code>), die Schnabeltiefe in Millimetern (<code>bill_depth_mm</code>), die Flügellänge in Millimetern (<code>flipper_length_mm</code>), das Körpergewicht in Gramm (<code>body_mass_g</code>) sowie das Geschlecht (<code>sex</code>). Zusätzlich ist das Beobachtungsjahr (<code>year</code>) im Datensatz vorhanden, spielt aber für diese Übung keine wesentliche Rolle.</p>
<section id="sec-descriptive_stat" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="sec-descriptive_stat"><span class="header-section-number">2.1.1</span> Deskriptive Statistiken</h3>
<p>Die Funktion <code>summary()</code> in R erzeugt beim Aufruf eine deskriptive Zusammenfassung des übergebenen Datensatzes. Für quantitative Variablen werden dabei deskriptive Statistiken wie Minimum, Maximum, Median, arithmetisches Mittel und die Quartile ausgegeben. Bei nominalen oder kategorialen Variablen werden die einzelnen Ausprägungen und deren absolute Häufigkeiten dargestellt. Zusätzlich wird für jede Variable die Anzahl der fehlenden Werte (kodiert als <code>NA</code>) aufgeführt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_penguin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      species          island    bill_length_mm  bill_depth_mm  
 Adelie   :152   Biscoe   :168   Min.   :32.10   Min.   :13.10  
 Chinstrap: 68   Dream    :124   1st Qu.:39.23   1st Qu.:15.60  
 Gentoo   :124   Torgersen: 52   Median :44.45   Median :17.30  
                                 Mean   :43.92   Mean   :17.15  
                                 3rd Qu.:48.50   3rd Qu.:18.70  
                                 Max.   :59.60   Max.   :21.50  
                                 NA's   :2       NA's   :2      
 flipper_length_mm  body_mass_g       sex           year     
 Min.   :172.0     Min.   :2700   female:165   Min.   :2007  
 1st Qu.:190.0     1st Qu.:3550   male  :168   1st Qu.:2007  
 Median :197.0     Median :4050   NA's  : 11   Median :2008  
 Mean   :200.9     Mean   :4202                Mean   :2008  
 3rd Qu.:213.0     3rd Qu.:4750                3rd Qu.:2009  
 Max.   :231.0     Max.   :6300                Max.   :2009  
 NA's   :2         NA's   :2                                 </code></pre>
</div>
</div>
<p>Um deskriptive Statistiken für verschiedene Subgruppen metrischer Variablen zu berechnen, bieten sich die in der vorherigen Übung eingeführten Funktionen <code>summarise()</code> und <code>group_by()</code> aus der <code>dplyr</code>-Library an:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data_penguin <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">"1st Qu."</span> <span class="ot">=</span> <span class="fu">quantile</span>(bill_length_mm, <span class="fl">0.25</span>),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Median"</span> <span class="ot">=</span> <span class="fu">median</span>(bill_length_mm),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Mean"</span> <span class="ot">=</span> <span class="fu">mean</span>(bill_length_mm),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">"3rd Qu."</span> <span class="ot">=</span> <span class="fu">quantile</span>(bill_length_mm, <span class="fl">0.25</span>),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="inagroelbe" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#inagroelbe table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#inagroelbe thead, #inagroelbe tbody, #inagroelbe tfoot, #inagroelbe tr, #inagroelbe td, #inagroelbe th {
  border-style: none;
}

#inagroelbe p {
  margin: 0;
  padding: 0;
}

#inagroelbe .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#inagroelbe .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#inagroelbe .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#inagroelbe .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#inagroelbe .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#inagroelbe .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#inagroelbe .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#inagroelbe .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#inagroelbe .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#inagroelbe .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#inagroelbe .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#inagroelbe .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#inagroelbe .gt_spanner_row {
  border-bottom-style: hidden;
}

#inagroelbe .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#inagroelbe .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#inagroelbe .gt_from_md > :first-child {
  margin-top: 0;
}

#inagroelbe .gt_from_md > :last-child {
  margin-bottom: 0;
}

#inagroelbe .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#inagroelbe .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#inagroelbe .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#inagroelbe .gt_row_group_first td {
  border-top-width: 2px;
}

#inagroelbe .gt_row_group_first th {
  border-top-width: 2px;
}

#inagroelbe .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#inagroelbe .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#inagroelbe .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#inagroelbe .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#inagroelbe .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#inagroelbe .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#inagroelbe .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#inagroelbe .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#inagroelbe .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#inagroelbe .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#inagroelbe .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#inagroelbe .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#inagroelbe .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#inagroelbe .gt_left {
  text-align: left;
}

#inagroelbe .gt_center {
  text-align: center;
}

#inagroelbe .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#inagroelbe .gt_font_normal {
  font-weight: normal;
}

#inagroelbe .gt_font_bold {
  font-weight: bold;
}

#inagroelbe .gt_font_italic {
  font-style: italic;
}

#inagroelbe .gt_super {
  font-size: 65%;
}

#inagroelbe .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#inagroelbe .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#inagroelbe .gt_indent_1 {
  text-indent: 5px;
}

#inagroelbe .gt_indent_2 {
  text-indent: 10px;
}

#inagroelbe .gt_indent_3 {
  text-indent: 15px;
}

#inagroelbe .gt_indent_4 {
  text-indent: 20px;
}

#inagroelbe .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="species" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">species</th>
<th id="n" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">n</th>
<th id="1st Qu." class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">1st Qu.</th>
<th id="Median" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Median</th>
<th id="Mean" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Mean</th>
<th id="3rd Qu." class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">3rd Qu.</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="species">Adelie</td>
<td class="gt_row gt_right" headers="n">146</td>
<td class="gt_row gt_right" headers="1st Qu.">36.725</td>
<td class="gt_row gt_right" headers="Median">38.85</td>
<td class="gt_row gt_right" headers="Mean">38.82397</td>
<td class="gt_row gt_right" headers="3rd Qu.">36.725</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="species">Chinstrap</td>
<td class="gt_row gt_right" headers="n">68</td>
<td class="gt_row gt_right" headers="1st Qu.">46.350</td>
<td class="gt_row gt_right" headers="Median">49.55</td>
<td class="gt_row gt_right" headers="Mean">48.83382</td>
<td class="gt_row gt_right" headers="3rd Qu.">46.350</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="species">Gentoo</td>
<td class="gt_row gt_right" headers="n">119</td>
<td class="gt_row gt_right" headers="1st Qu.">45.350</td>
<td class="gt_row gt_right" headers="Median">47.40</td>
<td class="gt_row gt_right" headers="Mean">47.56807</td>
<td class="gt_row gt_right" headers="3rd Qu.">45.350</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Wir können diese Statistiken auch grafisch mit einem Boxplot darstellen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data_penguin <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>species,<span class="at">y=</span>bill_length_mm, <span class="at">fill =</span> species))<span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkorange"</span>,<span class="st">"purple"</span>,<span class="st">"cyan4"</span>))<span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Pinguin Spezies"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Schnabellänge in mm"</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size=</span><span class="dv">14</span>)<span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Lineare_Regression_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Im Vergleich zur Visualisierung in <a href="01_Einfuehrung.html#exr-ggplot2" class="quarto-xref">Aufgabe&nbsp;<span>1.10</span></a> implementierte die oben dargestellte Grafik folgende Anpassungen:</p>
<ol type="1">
<li>Der Parameter <code>fill</code> in der Funktion <code>aes()</code> weist den grafischen Elementen Füllfarben zu.</li>
<li>Die Funktion <code>scale_fill_manual()</code> definiert die Füllfarben manuell. Hier setzen wir die Farbwerte (<code>values</code>) auf <code>c("darkorange", "purple", "cyan4")</code>.</li>
<li>Mit der Funktion <code>labs()</code> und den Argumenten <code>x</code> und <code>y</code> passen wir die Beschriftungen der x- und y-Achse an.</li>
<li>Die Funktion <code>theme_minimal(base_size = 14)</code> legt unter anderem einen weißen Hintergrund für die Grafik fest und setzt die Basis-Schriftgröße auf <code>14pt</code>.</li>
<li>Die Anweisung <code>theme(legend.position = "none")</code> unterdrückt die Legende der Grafik, was die Übersichtlichkeit erhöht.</li>
</ol>
<p>Der bewusste Einsatz von Farben, Formen und Texten in Grafiken vereinfacht das Lesen und Verarbeiten der enthaltenen Informationen maßgeblich. Die effektive visuelle Kommunikation von Daten ist eine essentielle Kompetenz, die man in jedem Berufsfeld, welches Daten involviert beherrschen muss.</p>
</section>
</section>
<section id="die-einfache-lineare-regression" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="die-einfache-lineare-regression"><span class="header-section-number">2.2</span> Die einfache lineare Regression</h2>
<p>Die lineare Regression erweist sich als ein vergleichsweise einfaches, aber äußerst leistungsstarkes Werkzeug in der Statistik und im Data Mining. Ihre Vorteile umfassen die sehr gute Interpretierbarkeit der Koeffizienten – sowohl hinsichtlich ihrer Werte als auch ihrer statistischen Signifikanz.</p>
<p>In der einfachen linearen Regression besteht das Ziel darin, eine abhängige Variable (auch Zielvariable, Outcome oder Target genannt) <span class="math inline">\(Y \in \mathbb{R}^K\)</span> durch die Gleichung</p>
<p><span id="eq-elr"><span class="math display">\[
Y = b_0 + b_1X + \varepsilon
\tag{2.1}\]</span></span></p>
<p>zu approximieren. Hierbei ist <span class="math inline">\(X \in \mathbb{R}^K\)</span> die unabhängige Variable, <span class="math inline">\(b_0, b_1 \in \mathbb{R}\)</span> die Regressionskoeffizienten (Achsenabschnitt und Steigung) und <span class="math inline">\(\varepsilon \sim \mathcal{N}(0, 1)\)</span> ein Fehlerterm, der als normalverteilt angenommen wird.</p>
<p>Gleichung <a href="#eq-elr" class="quarto-xref">Gleichung&nbsp;<span>2.1</span></a> bezeichnen wir auch als einfache lineare Regressionsgleichung oder Modellgleichung. Dabei sind <span class="math inline">\(X\)</span> und <span class="math inline">\(Y\)</span> Vektoren der Dimension <span class="math inline">\(K \in \mathbb{N}\)</span>, also <span class="math inline">\(X = (x_1, ..., x_K)\)</span> und <span class="math inline">\(Y = (y_1, ..., y_K)\)</span> mit <span class="math inline">\(x_i\in\mathbb{R}\)</span> und <span class="math inline">\(y_i\in\mathbb{R}\)</span> für alle <span class="math inline">\(k=1,...,K\)</span>.</p>
<p>Wir können die Regressionsgleichung <a href="#eq-elr" class="quarto-xref">Gleichung&nbsp;<span>2.1</span></a> komponentnweise betrachten:</p>
<p><span class="math display">\[
y_k = b_0+b_1 x_k + \varepsilon_k, \qquad k=1,...,K
\]</span></p>
<p><span class="math inline">\(K\)</span> entspricht hierbei wieder der Anzahl der Observationen.</p>
<div id="exm-elr" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 2.1</strong></span> Betrachte folgenden synthetischen Datensatz:</p>
<div class="cell">
<div class="cell-output-display">
<div id="yichzgjisd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yichzgjisd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yichzgjisd thead, #yichzgjisd tbody, #yichzgjisd tfoot, #yichzgjisd tr, #yichzgjisd td, #yichzgjisd th {
  border-style: none;
}

#yichzgjisd p {
  margin: 0;
  padding: 0;
}

#yichzgjisd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yichzgjisd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yichzgjisd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yichzgjisd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yichzgjisd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yichzgjisd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yichzgjisd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yichzgjisd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yichzgjisd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yichzgjisd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yichzgjisd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yichzgjisd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yichzgjisd .gt_spanner_row {
  border-bottom-style: hidden;
}

#yichzgjisd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yichzgjisd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yichzgjisd .gt_from_md > :first-child {
  margin-top: 0;
}

#yichzgjisd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yichzgjisd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yichzgjisd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yichzgjisd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yichzgjisd .gt_row_group_first td {
  border-top-width: 2px;
}

#yichzgjisd .gt_row_group_first th {
  border-top-width: 2px;
}

#yichzgjisd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yichzgjisd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yichzgjisd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yichzgjisd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yichzgjisd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yichzgjisd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yichzgjisd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yichzgjisd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yichzgjisd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yichzgjisd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yichzgjisd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yichzgjisd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yichzgjisd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yichzgjisd .gt_left {
  text-align: left;
}

#yichzgjisd .gt_center {
  text-align: center;
}

#yichzgjisd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yichzgjisd .gt_font_normal {
  font-weight: normal;
}

#yichzgjisd .gt_font_bold {
  font-weight: bold;
}

#yichzgjisd .gt_font_italic {
  font-style: italic;
}

#yichzgjisd .gt_super {
  font-size: 65%;
}

#yichzgjisd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yichzgjisd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yichzgjisd .gt_indent_1 {
  text-indent: 5px;
}

#yichzgjisd .gt_indent_2 {
  text-indent: 10px;
}

#yichzgjisd .gt_indent_3 {
  text-indent: 15px;
}

#yichzgjisd .gt_indent_4 {
  text-indent: 20px;
}

#yichzgjisd .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="x" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">x</th>
<th id="y" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">y</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="x">0</td>
<td class="gt_row gt_right" headers="y">0.56</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="x">1</td>
<td class="gt_row gt_right" headers="y">0.73</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="x">2</td>
<td class="gt_row gt_right" headers="y">-0.56</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="x">3</td>
<td class="gt_row gt_right" headers="y">1.43</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="x">4</td>
<td class="gt_row gt_right" headers="y">1.87</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="x">5</td>
<td class="gt_row gt_right" headers="y">0.78</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="x">6</td>
<td class="gt_row gt_right" headers="y">2.54</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="x">7</td>
<td class="gt_row gt_right" headers="y">4.77</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="x">8</td>
<td class="gt_row gt_right" headers="y">4.69</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="x">9</td>
<td class="gt_row gt_right" headers="y">4.95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="x">10</td>
<td class="gt_row gt_right" headers="y">3.78</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Die folgende Grafik zeigt die Daten visualisiert als Punktewolke:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Lineare_Regression_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Um nun eine Regressionsgerade mit den Parametern <span class="math inline">\(\hat{b}_0\)</span> und <span class="math inline">\(\hat{b}_1\)</span> zu bestimmen, welche die abhängige Variable <span class="math inline">\(Y\)</span> bestmöglich approximiert, verwenden wir die folgenden Formeln zur Schätzung der Koeffizienten:</p>
<p><span class="math display">\[
\hat b_1 = \frac{\sum_{k=1}^{K} x_k y_k - K \bar{x} \bar{y}}{\sum_{k=1}^{K} x_k^2 - K \bar{x}^2} \qquad \text{und}\qquad \hat b_0 = \bar{y} - \hat{b}_1 \bar{x}
\]</span></p>
<p>Dabei repräsentieren <span class="math inline">\(\bar{x} = \frac{1}{K}\sum_{k=1}^K x_k\)</span> und <span class="math inline">\(\bar{y} = \frac{1}{K}\sum_{k=1}^K y_k\)</span> den Stichprobenmittelwert der unabhängigen Variable <span class="math inline">\(X\)</span> bzw. der abhängigen Variable <span class="math inline">\(Y\)</span>.</p>
<p>Für das vorherige Beispiel ergeben sich die geschätzten Koeffizienten zu <span class="math inline">\(\hat{b}_1 = 0.4908\)</span> und <span class="math inline">\(\hat{b}_0 = 0.2253\)</span>. Daraus resultiert die geschätzte Regressionsgleichung mit eingesetzten Werten:</p>
<p><span class="math display">\[
\hat{y} =\hat{b}_1x+\hat{b}_0 =  0.5098x - 0.2273
\]</span></p>
<p>Wir können die Regressionsgerade dann mithilfe der <code>geom_abline</code> Funktion visualisieren:</p>
<div style="page-break-after: always;"></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>data_example <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y))<span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"darkorange"</span>,</span>
<span id="cb8-3"><a href="#cb8-3"></a>             <span class="at">size =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="fl">0.5098</span>,</span>
<span id="cb8-5"><a href="#cb8-5"></a>              <span class="at">intercept =</span> <span class="sc">-</span><span class="fl">0.2273</span>,</span>
<span id="cb8-6"><a href="#cb8-6"></a>              <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb8-7"><a href="#cb8-7"></a>              <span class="at">color =</span> <span class="st">"cyan4"</span>)<span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size=</span><span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Lineare_Regression_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In Zeile 4 spezifizieren wir mit dem <code>slope</code> Argument die Steigung, bzw. den Parameter <span class="math inline">\(\hat{b_1}\)</span> und in Zeile 5 durch das Argument <code>intercept</code> den Schnittpunkt mit der <span class="math inline">\(y\)</span>-Achse, bzw. den Parameter <span class="math inline">\(\hat{b_0}\)</span>. Die Argumente <code>linewidth</code> und <code>color</code> steuern die Dicke und Farbe der Linie.</p>
</div>
<div class="callout callout-style-default callout-important callout-titled" title="Wichtig">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Wichtig
</div>
</div>
<div class="callout-body-container callout-body">
<p>Die Notation der Schätzgleichung unterscheidet sich von der Modellgleichung. Bei geschätzten Parametern oder Werten verwendet man die Notation <span class="math inline">\(\hat{y},\hat{b}_1,\text{ und }\hat{b}_0\)</span> um geschätzte Werte darzustellen.</p>
</div>
</div>
<section id="sec-elr" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="sec-elr"><span class="header-section-number">2.2.1</span> Schätzung der Modellparameter in R</h3>
<p>Um eine lineare Regression mit R durchzuführen, nutzen wir die <code>{tidymodels}</code>-Library. <code>{tidymodels}</code> erweitert das Konzept der <code>{tidyverse}</code>-Bibliothek um statistische Modellierung. Der Prozess zur Spezifikation eines linearen Modells gliedert sich hierbei, unabhängig vom verwendeten Datensatz, in zwei separate Phasen:</p>
<ol type="1">
<li>Modellspezifikation</li>
<li>Schätzung der Modellparameter</li>
</ol>
<p>Diese Phasen werden durch die Funktionen <code>linear_reg()</code> und <code>fit()</code> spezifiziert. Die Spezifikation des Modells erfolgt stets unabhängig von den zugrundeliegenden Daten:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>lm_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Um nun die Modellparameter für die Daten aus <a href="#exm-elr" class="quarto-xref">Example&nbsp;<span>2.1</span></a> zu schätzen, kombinieren wir die Modellspezifikation mit der <code>fit</code> Funktion:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>lm_fit <span class="ot">&lt;-</span> lm_spec <span class="sc">%&gt;%</span> <span class="fu">fit</span>(</span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="at">data =</span> data_example,</span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="at">formula =</span> y <span class="sc">~</span> x</span>
<span id="cb10-4"><a href="#cb10-4"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>In der ersten Zeile deklarieren wir ein neues Objekt namens <code>lm_fit</code>. Indem wir die zuvor definierte Modellspezifikation <code>lm_spec</code> an die Funktion <code>fit()</code> übergeben, weisen wir <code>fit()</code> an, die Parameter für ein lineares Regressionsmodell zu schätzen.</li>
<li>In der zweiten Zeile legen wir mithilfe des Arguments <code>data</code> den Datensatz fest, anhand dessen die Modellparameter <span class="math inline">\(b_0\)</span> und <span class="math inline">\(b_1\)</span> geschätzt werden sollen.</li>
<li>Nach der Datenspezifikation müssen wir noch die abhängige und die unabhängige Variable definieren. Dies geschieht mithilfe des Operators <code>~</code>. Die Variable links des <code>~</code>-Operators (<code>y</code>) ist die abhängige Variable, und die Variable rechts des <code>~</code>-Operators (<code>x</code>) ist die unabhängige Variable.</li>
</ol>
<p>Das Objekt <code>lm_fit</code> enthält nun unter anderem die geschätzten Modellparameter <span class="math inline">\(b_0\)</span> und <span class="math inline">\(b_1\)</span>. Es existieren verschiedene Wege, um auf diese zuzugreifen:</p>
<p>Durch das Ausgeben des Objekts <code>lm_fit</code> erhalten wir neben den Koeffizienten <span class="math inline">\(b_0\)</span> (<code>Intercept</code>) und <span class="math inline">\(b_1\)</span> (<code>x</code>) beispielsweise auch die Formel, die zur Schätzung der Modellparameter verwendet wurde:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>lm_fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>parsnip model object


Call:
stats::lm(formula = y ~ x, data = data)

Coefficients:
(Intercept)            x  
    -0.2273       0.5098  </code></pre>
</div>
</div>
<p>Eine detaillierte Übersicht der geschätzten Modellparameter und deren statistischer Signifikanz erhalten wir durch folgenden Code-Abschnitt:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>lm_fit <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
stats::lm(formula = y ~ x, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.5418 -0.6913  0.1278  0.6881  1.4285 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.2273     0.5768  -0.394 0.702757    
x             0.5098     0.0975   5.229 0.000543 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.023 on 9 degrees of freedom
Multiple R-squared:  0.7523,    Adjusted R-squared:  0.7248 
F-statistic: 27.34 on 1 and 9 DF,  p-value: 0.0005429</code></pre>
</div>
</div>
<p>Die Funktion <code>extract_fit_engine()</code> ruft das Attribut <code>fit</code> aus dem Objekt <code>lm_fit</code> ab. Das Attribut <code>fit</code> eines linearen Modells beinhaltet neben den geschätzten Parametern zahlreiche weitere Informationen, die die Funktion <code>summary()</code> übersichtlich zusammenfasst. Diese werden wir in den folgenden Abschnitten genauer betrachten.</p>
<section id="residuen" class="level4" data-number="2.2.1.1">
<h4 data-number="2.2.1.1" class="anchored" data-anchor-id="residuen"><span class="header-section-number">2.2.1.1</span> Residuen</h4>
<p>Der Abschnitt <code>Residuals</code> der Zusammenfassung beschreibt deskriptive Merkmale der Residuen welche sich durch die Schätzung der Modellparameter ergeben haben.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Wiederholung
</div>
</div>
<div class="callout-body-container callout-body">
<p>Zur Erinnerung: Für eine Observation <span class="math inline">\((x_i,y_i)\)</span> mit geschätztem Wert <span class="math inline">\(\hat{y}_i = \hat{b}_1x_i+\hat{b}_0\)</span> ist das Residuum <span class="math inline">\(\hat{\varepsilon}_i\)</span> als <span class="math inline">\(\hat{\varepsilon}_i = y_i-\hat{y}_i = y_i - (\hat{b}_1x_i+\hat{b}_0)\)</span> definiert.</p>
</div>
</div>
<div class="cell" data-out.lines="[5,6,7,8,16]">
<div class="cell-output cell-output-stdout">
<pre><code>...

Residuals:
    Min      1Q  Median      3Q     Max 
-1.5418 -0.6913  0.1278  0.6881  1.4285 

Residual standard error: 1.023 on 9 degrees of freedom
...</code></pre>
</div>
</div>
<p>Konkret heißt das für das obige lineare Modell, dass zum Beispiel das kleinste Residuum den Wert <span class="math inline">\(-1.5418\)</span> annimmt und <span class="math inline">\(75\%\)</span> der Residuen maximal den Wert <span class="math inline">\(0.6881\)</span> besitzen.</p>
<p>Neben den deskriptiven Merkmalen wird im unteren Teil der Ausgabe auch noch der Standardfehler der Residuen angegeben.</p>
<p>Die geschätzten Residuen für das geschätzte Modell können auch grafisch dargestellt werden:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>estimates <span class="ot">&lt;-</span> lm_fit <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(data_example) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="dv">1</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>data_example <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y))<span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">xend=</span>x,<span class="at">y=</span>y,<span class="at">yend=</span>estimates),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"darkorange"</span>)<span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"darkorange"</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="fl">0.5092</span>,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">intercept =</span> <span class="sc">-</span><span class="fl">0.2253</span>,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"cyan4"</span>)<span class="sc">+</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size=</span><span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Lineare_Regression_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Zuerst haben wir mithilfe der Funktion <code>predict()</code> die vorhergesagten Werte <span class="math inline">\(\hat{y} = \hat{b}_0 + x\hat{b}_1\)</span> berechnet. Da <code>predict()</code> ein Dataframe oder Tibble zurückgibt, können wir die relevante Spalte mit <code>purrr::pluck()</code> als Vektor extrahieren.</p>
<p>Im Vergleich zur vorherigen Visualisierung stellen wir die Residuen nun mit der Funktion <code>geom_segment()</code> dar. <code>geom_segment()</code> zeichnet gerade Linien zwischen den Punkten <code>(x, y)</code> und <code>(xend, yend)</code>, wobei die Werte im Datensatz und die vorhergesagten Werte in der Liste <code>estimates</code> diese Endpunkte definieren. Um die Residuallinien hervorzuheben, haben wir ihre Breite (<code>linewidth</code>) angepasst, den Linientyp (<code>linetype</code>) auf “gestrichelt” gesetzt und ihre Farbe (<code>color</code>) an die entsprechenden Datenpunkte angeglichen.</p>
</section>
<section id="koeffizienten" class="level4" data-number="2.2.1.2">
<h4 data-number="2.2.1.2" class="anchored" data-anchor-id="koeffizienten"><span class="header-section-number">2.2.1.2</span> Koeffizienten</h4>
<p>Der <code>Coefficients</code> Abschnitt beschreibt die geschätzten Parameter und deren statistische Signifikanz.</p>
<div class="cell" data-out.lines="[9,10,11,12]">
<div class="cell-output cell-output-stdout">
<pre><code>...

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.2273     0.5768  -0.394 0.702757    
x             0.5098     0.0975   5.229 0.000543 ***
...</code></pre>
</div>
</div>
<ul>
<li>Die Spalte <code>Estimate</code> gibt hierbei den geschätzten Wert für <span class="math inline">\(b_0\)</span> und <span class="math inline">\(b_1\)</span> an.</li>
<li>Die Spalte <code>Std. Error</code> gibt für jeden geschätzten Parameter den Standardfehler an.</li>
<li>Die Spalte <code>t value</code> gibt den Wert der <span class="math inline">\(t\)</span>-Statistik für den entsprechenden Parameter an.</li>
<li>Die Spalte <code>Pr(&gt;|t|)</code> beschreibt den <span class="math inline">\(p\)</span>-Wert des zugrundeliegenden <span class="math inline">\(t\)</span>-Tests.</li>
</ul>
<p>Zusätzlich werden rechts von der letzten Spalte noch Signifikanzcodes wiedergegeben:</p>
<div class="cell" data-out.lines="[14,15]">
<div class="cell-output cell-output-stdout">
<pre><code>...

Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

...</code></pre>
</div>
</div>
<p>Diese beschreiben zu welchem Signifikanzniveau <span class="math inline">\(\alpha\)</span> ein Parameter Signifikant ist. Falls also zum Beispiel bei der Variable <code>x</code> der Signifikanzcode <code>'***'</code> gegegben ist, dann bedeutet das, dass <span class="math inline">\(0&lt;p&lt; 0.001\)</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Wiederholung">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Wiederholung
</div>
</div>
<div class="callout-body-container callout-body">
<p>Der <span class="math inline">\(t\)</span>-Test für den Koeffizienten <span class="math inline">\(b\)</span> eine Variable <span class="math inline">\(x\)</span> einer linearen Regression lautet:</p>
<p><span class="math display">\[
H_0:\: b=0\qquad \text{vs.}\qquad H_1:\:b\neq 0
\]</span> Der Wert der <span class="math inline">\(t\)</span>-Statistik ist durch <span class="math inline">\(\frac{\hat{b}}{\text{sd}_{\hat{b}}}\sqrt{K}\)</span> gegeben, wobei <span class="math inline">\(\text{sd}_{\hat{b}}\)</span> den Standardfehler von <span class="math inline">\(\hat{b}\)</span> und <span class="math inline">\(K\)</span> die Anzahl der Observationen beschreibt. Falls der Wert der <span class="math inline">\(t\)</span>-Statistik im Bereich <span class="math inline">\(B = (-\infty,-x_{1-\frac{\alpha}{2}})\cup(x_{1-\frac{\alpha}{2}},\infty)\)</span> liegt, dann können wir <span class="math inline">\(H_0\)</span> verwerfen. Hierbei verwenden wir die Approximation <span class="math inline">\(x_{1-\frac{\alpha}{2}}\approx z_{1-\frac{\alpha}{2}}\)</span>, wobei <span class="math inline">\(z_{1-\frac{\alpha}{2}}\)</span> das <span class="math inline">\(1-\frac{\alpha}{2}\)</span> Quantil der Standardnormalverteilung ist.</p>
<p>Falls wir <span class="math inline">\(H_0\)</span> nicht verwerfen (z.B. zum Niveau <span class="math inline">\(\alpha = 0.001\)</span>), können wir nicht mit ausreichender Sicherheit sagen, dass <span class="math inline">\(\hat{b}\neq 0\)</span> und der Parameter somit einen Einfluss auf die abhängige Variable <span class="math inline">\(y\)</span> hat.</p>
</div>
</div>
</section>
</section>
<section id="das-gütemaß-r2" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="das-gütemaß-r2"><span class="header-section-number">2.2.2</span> Das Gütemaß <span class="math inline">\(R^2\)</span></h3>
<p>Neben den Parametern, deren Signifikanz und den Residuen sind wir ebenso an dem Gütemaß <span class="math inline">\(R^2\)</span> interessiert. Das Gütemaß <span class="math inline">\(R^2\)</span> beschreibt in Worten gefasst, wie viel Prozent der Varianz der Daten wir durch unser Modell erklären können.</p>
<div class="cell" data-out.lines="17">
<div class="cell-output cell-output-stdout">
<pre><code>...

Multiple R-squared:  0.7523,    Adjusted R-squared:  0.7248 
...</code></pre>
</div>
</div>
<p>Falls also, wie im obigen Output zu sehen ist, der <span class="math inline">\(R^2\)</span> des Modells bei <span class="math inline">\(0.7526\)</span> liegt, kann unser Modell ca. <span class="math inline">\(75\%\)</span> der Varianz in den Daten erklären.</p>
<p>Um das Gütemaß zu berechnen wird folgende Formel herangezogen:</p>
<p><span id="eq-rsq"><span class="math display">\[
R^2  = \frac{\sum_{k=1}^K(\hat{y}_k-\bar{y})^2}{\sum_{k=1}^K(y_k-\bar{y})^2}
\tag{2.2}\]</span></span></p>
<section id="der-f-test" class="level4" data-number="2.2.2.1">
<h4 data-number="2.2.2.1" class="anchored" data-anchor-id="der-f-test"><span class="header-section-number">2.2.2.1</span> Der <span class="math inline">\(F\)</span>-Test</h4>
<p>Die letzet Zeile der Zusammenfassung des Modells zeigt die <span class="math inline">\(F\)</span>-Statistik mit korrespondierendem <span class="math inline">\(p\)</span>-Wert.</p>
<div class="cell" data-out.lines="18">
<div class="cell-output cell-output-stdout">
<pre><code>...

F-statistic: 27.34 on 1 and 9 DF,  p-value: 0.0005429
...</code></pre>
</div>
</div>
<p>Der <span class="math inline">\(F\)</span>-Test beschreibt, ob das Modell als gesamtes signifikant ist. Die Zugrundeliegenden Hypothesen des <span class="math inline">\(F\)</span>-Tests sind:</p>
<p><span class="math display">\[ H_0:\: b_i = 0 \text{ für alle } i,\qquad\text{ vs }\qquad H_1:\: b_i\neq 0 \text{ für mindestens ein } i\]</span></p>
<p>Falls wir <span class="math inline">\(H_0\)</span> nicht verwerfen, können wir nicht mit hoher Sicherheit sagen, dass <strong>alle</strong> Regressoren <strong>keinen</strong> Einfluss auf die abhängige Variable haben. Im Kontext der einfachen linearen Regression sind der <span class="math inline">\(F\)</span>-Test und <span class="math inline">\(t\)</span>-Test insofern äquivalent, dass</p>
<p><span class="math display">\[
\verb|F-statistic| = (\verb|t value|)^2
\]</span></p>
</section>
</section>
</section>
<section id="die-multiple-lineare-regression" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="die-multiple-lineare-regression"><span class="header-section-number">2.3</span> Die multiple lineare Regression</h2>
<p>Die Multiple lineare Regression erweitert die Idee der einfachen linearen Regression durch das Hinzufügen von weiteren erklärenden Variablen.</p>
<p>Die Modellgleichung lautet somit</p>
<p><span class="math display">\[
Y = b_0 + b_1X_1+...+b_JX_J+\varepsilon,
\]</span></p>
<p>falls die Daten aus <span class="math inline">\(J\)</span> verschiednen Variablen bestehen. Hierbei gilt wieder, dass für jede Variable <span class="math inline">\(X_j,\:j=1,...,J\)</span> <span class="math inline">\(K\)</span> Observationen vorhanden sind. Man geht hierbei davon aus, dass die <span class="math inline">\(K\)</span> Observationen zufällig von einer Gesamtpopulation gezogen wurden.</p>
<p>Somit kann die Modellgleichung auch wieder komponentenweise beschrieben werden:</p>
<p><span class="math display">\[
y_k = b_0 + b_1x_{k1}+...+b_Jx_{kJ}+\varepsilon_k
\]</span></p>
<p>Zusätzlich kann die Modellgleichung auch in Matrixnotation dargestellt werden:</p>
<p><span id="eq-mlr"><span class="math display">\[
Y = Xb+\varepsilon
\tag{2.3}\]</span></span></p>
<p>Wobei <span class="math inline">\(Y = (y_1,...,y_k)^\prime\in\mathbb{R}^{K\times 1},\, X = (1,x_1,...,x_J)\in\mathbb{R}^{K\times (J+1)}, b = (b_0,b_1,...,b_J)^\prime\in\mathbb{R}^{(J+1)\times 1}\)</span> und <span class="math inline">\(\varepsilon \sim \mathcal{N(0,1)}\)</span>.</p>
<p>Das Schätzen der Modellparameter <span class="math inline">\(b_0,...,b_J\)</span> auf Basis gegebener Observationen wird bei der multiplen linearen Regression üblicherweise nicht mehr von Hand durchgeführt. Der einfachste Weg die Modellparameter von Hand zu bestimmen ist allerdings durch folgende Formel gegeben:</p>
<p><span id="eq-mlrsol"><span class="math display">\[
b = (X^\prime X)^{-1}X^\prime Y
\tag{2.4}\]</span></span></p>
<p>Wobei <span class="math inline">\(X^\prime\)</span> die transponierte Matrix von <span class="math inline">\(X\)</span> darstellt und <span class="math inline">\((X^\prime X)^{-1}\)</span> die inverse von <span class="math inline">\((X^\prime X)\)</span>. Die Komplexität in der Berechnung von <span class="math inline">\(b\)</span> anhand <a href="#eq-mlrsol" class="quarto-xref">Gleichung&nbsp;<span>2.4</span></a> liegt in der Berechnung der inversen Matrix.</p>
<section id="sec-MLRR" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="sec-MLRR"><span class="header-section-number">2.3.1</span> Multiple lineare Regression in R</h3>
<p>Das schätzen der Modellparameter im multidimensionalen Fall in R funktioniert fast analog wie im einfachen Fall.</p>
<p>Als Beispiel verwenden wir hierfür nun keinen syntetischen Datensatz mehr, sondern den <code>data_penguin</code> Datensatz aus <a href="#sec-penguins" class="quarto-xref"><span>Section 2.1</span></a>.</p>
<p>Angenommen die abhängige Veriable ist das Gewicht der Pinguine (<code>body_mass_g</code>). Wie im einfachen linearen Regressionsmodell wird zuerst das Modell durch die <code>linear_reg</code> Funktion spezifiziert. Nach der Spezifikation werden dann die Parameter mithilfe der <code>fit</code> Funktion geschätzt. Das Argument <code>formula</code> hat rechts des <code>~</code> Operators einen Punkt stehen. Der <code>.</code> Operator signalisiert, dass alle verbleibenden Variablen als unabhängige Variablen verwendet werden sollen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>mlr_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>()</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>mlr_fit <span class="ot">&lt;-</span> mlr_spec <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> data_penguin,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">formula =</span> body_mass_g <span class="sc">~</span>.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Alternativ kann man statt des <code>.</code> auch alle Variablen wie folgt ausschreiben, wobei das in den meisten Fällen aufgrund schlechter Lesbarkeit nicht zu empfehlen ist:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>mlr_fit <span class="ot">&lt;-</span> mlr_spec <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> data_penguin,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">formula =</span> body_mass_g <span class="sc">~</span> species <span class="sc">+</span> island <span class="sc">+</span> bill_length_mm <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>        bill_depth_mm <span class="sc">+</span> flipper_length_mm <span class="sc">+</span> sex <span class="sc">+</span> year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Analog zum eindimensionalen Fall kann mit den <code>extract_fit_engine</code> und <code>summary</code> Funktion eine Zusammenfassung erzeugt werden:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mlr_fit_summary <span class="ot">&lt;-</span> mlr_fit <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>mlr_fit_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
stats::lm(formula = body_mass_g ~ species + island + bill_length_mm + 
    bill_depth_mm + flipper_length_mm + sex + year, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-809.70 -180.87   -6.25  176.76  864.22 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       84087.945  41912.019   2.006  0.04566 *  
speciesChinstrap   -282.539     88.790  -3.182  0.00160 ** 
speciesGentoo       890.958    144.563   6.163 2.12e-09 ***
islandDream         -21.180     58.390  -0.363  0.71704    
islandTorgersen     -58.777     60.852  -0.966  0.33482    
bill_length_mm       18.964      7.112   2.667  0.00805 ** 
bill_depth_mm        60.798     20.002   3.040  0.00256 ** 
flipper_length_mm    18.504      3.128   5.915 8.46e-09 ***
sexmale             378.977     48.074   7.883 4.95e-14 ***
year                -42.785     20.949  -2.042  0.04194 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 286.5 on 323 degrees of freedom
  (11 Beobachtungen als fehlend gelöscht)
Multiple R-squared:  0.8768,    Adjusted R-squared:  0.8734 
F-statistic: 255.4 on 9 and 323 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Die Modellgleichung für das multiple lineare Regressionsmodell mit eingesetzten Zahlen lautet also</p>
<p><span id="eq-mlrpen"><span class="math display">\[
\begin{aligned}
\verb|body_mass_g|_i = 84087.945 &amp;+\verb|speciesChinstrap|_i\cdot-282.53+\\
&amp;\verb|speciesGentoo|_i\cdot890.958+ \verb|islandDream|_i\cdot-21.180+\\
&amp;\verb|islandTorgersen|_i\cdot-58.777 + \verb|bill_length_mm|_i\cdot18.964+ \\
&amp;\verb|bill_depth_mm|_i\cdot60.798    + \verb|flipper_length_mm|_i\cdot18.504+\\
&amp;\verb|sexmale|_i\cdot378.977+\verb|year|_i\cdot-42.785+\varepsilon_i
  \end{aligned}
\tag{2.5}\]</span></span></p>
</section>
<section id="interpretation-und-verlgeich-der-koeffizienten" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="interpretation-und-verlgeich-der-koeffizienten"><span class="header-section-number">2.3.2</span> Interpretation und Verlgeich der Koeffizienten</h3>
<p>Die geschätzten Koeffizienten im MLR Modell lassen sich ähnlich wie bei der einfachen linearen Regression interpretieren da der Effekt der Koeffizienten auch linear ist.</p>
<p>So erwarten wir zum Beispiel im obigen Beispiel, dass das Gewicht eines Pinguins in Schnitt um <code>18.504</code><span class="math inline">\(g\)</span> steigt, falls sich die Länge der Flossen um 1mm erhöht (<span class="math inline">\(b_{\verb|flipper_length_mm|} = 18.504\)</span>) und alle anderen Einflussfaktoren konstant bleiben.</p>
<p>Neben dem direkten Einfluss der geschätzten Koeffizienten, können wir zwar die statistische Signifikanz der verschiednen Parameter vergleichen, aber es ist ohne Weiteres nicht klar, welcher Koeffizient den größten Einfluss auf das Gewicht der Pinguine hat.</p>
<p>Um herauszufinden, welche Variable den größten Einfluss besitzt, müssen wir entweder die Variablen, oder die Koeffizienten standardisieren. Ohne einer Standardisierung wäre ein Vergleich der geschätzten Koeffizienten nicht sinnvoll, da die Variablen teilweise anderen Einheiten gemessen werden oder gar nicht metrisch sind. So macht zum Beispiel ein Vergleich der Parameter für die Schnabellänge und Geschlecht keinen Sinn, da die Schnabellänge in <span class="math inline">\(mm\)</span> gemesser wird und das Geschlecht nur die Ausprägungen <code>"male"</code> und <code>"female"</code> besitzt. Den standardisierten Koeffizient für eine Variable <span class="math inline">\(x\)</span> können wir mithilfe der Formel</p>
<p><span class="math display">\[
\hat{b}_{x,\text{std}} = \hat{b}_x\frac{\text{sd}_x}{\text{sd}_y}
\]</span> berechnen, wobei <span class="math inline">\(\text{sd}_x\)</span> für die Standardabweichung von <span class="math inline">\(x\)</span> und <span class="math inline">\(\text{sd}_y\)</span> für die Standardabweichung von <span class="math inline">\(y\)</span> steht.</p>
<p>Durch die Standardisierung erreichen wir, dass die standardisierten Koeffizienten vergleichbar sind. Der geschätzte Koeffizient mit dem größten standardisierten Wert hat dadurch den größten Einfluss auf die abhängige Variable, während der Koeffizient mit dem kleinsten standardisierten Wert den kleinsten Einfluss hat.</p>
<p>Durch die <code>lm.beta::lm.beta()</code> Funktion können wir die standardisierten Koeffizienten für ein lineares Modell in R bestimmen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>mlr_fit <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  lm.beta<span class="sc">::</span><span class="fu">lm.beta</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
stats::lm(formula = body_mass_g ~ species + island + bill_length_mm + 
    bill_depth_mm + flipper_length_mm + sex + year, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-809.70 -180.87   -6.25  176.76  864.22 

Coefficients:
                    Estimate Standardized Std. Error t value Pr(&gt;|t|)    
(Intercept)        8.409e+04           NA  4.191e+04   2.006  0.04566 *  
speciesChinstrap  -2.825e+02   -1.417e-01  8.879e+01  -3.182  0.00160 ** 
speciesGentoo      8.910e+02    5.311e-01  1.446e+02   6.163 2.12e-09 ***
islandDream       -2.118e+01   -1.271e-02  5.839e+01  -0.363  0.71704    
islandTorgersen   -5.878e+01   -2.545e-02  6.085e+01  -0.966  0.33482    
bill_length_mm     1.896e+01    1.288e-01  7.112e+00   2.667  0.00805 ** 
bill_depth_mm      6.080e+01    1.487e-01  2.000e+01   3.040  0.00256 ** 
flipper_length_mm  1.850e+01    3.221e-01  3.128e+00   5.915 8.46e-09 ***
sexmale            3.790e+02    2.357e-01  4.807e+01   7.883 4.95e-14 ***
year              -4.278e+01   -4.320e-02  2.095e+01  -2.042  0.04194 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 286.5 on 323 degrees of freedom
  (11 Beobachtungen als fehlend gelöscht)
Multiple R-squared:  0.8768,    Adjusted R-squared:  0.8734 
F-statistic: 255.4 on 9 and 323 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Im obigen Code haben wir nach der Erzeugung der standardisierten Koeffizienten auch noch die <code>summary()</code> Funktion aufgerufen, um die neben den standardisierten Koeffizienten auch noch eine Übersicht über die restlichen Parameter und Statistiken zu bekommen.</p>
<section id="dummy-encoding" class="level4" data-number="2.3.2.1">
<h4 data-number="2.3.2.1" class="anchored" data-anchor-id="dummy-encoding"><span class="header-section-number">2.3.2.1</span> Dummy Encoding</h4>
<p>Beim Vergleichen der unabhängigen Variablen mit dem R Output werden zum Beispiel statt <code>species</code> die beiden neuen Variablen <code>speciesChinstrap</code> und <code>speciesGentoo</code> verwendet. Das liegt daran, dass diese Variable nominal ist (Ausprägungen <code>"Chinstrap"</code>,<code>"Gentoo"</code> und <code>"Adelie"</code>) und die Ausprägungen deshalb nicht einfach mit geschätzten Koeffizienten multipliziert werden können wie das im ordinalen oder metrischen Fall ist. Deshalb werden sogenannte <em>Dummy-Variablen</em> zur berechnung der Parameter verwendet. Hierbei werden im Falle der Variable <code>species</code> <span class="math inline">\(l-1 = 3-1 = 2\)</span> (mit <span class="math inline">\(l\)</span> die Anzahl der verschiedenen Ausprägungen) neue Variablen angelegt. <code>speciesChinstrap</code> nimmt den Wert <code>1</code> an, falls ein Datenpunkt im Datensatz der Spezies <code>Chinstrap</code> angehört und ansonsten <code>0</code>. Gleich wird auch mit <code>speciesGentoo</code> verfahren. Allerdings ist hier nirgends die Variable <code>speciesAdelie</code> spezifiziert! Das liegt daran, dass der Einfluss dieses Datenpunktes durch den <code>Intercept</code>, also <span class="math inline">\(b_0\)</span> abgebildet wird um Multikollinearität zu vermeiden (siehe Abschnitt <a href="#sec-multikollinearitaet" class="quarto-xref"><span>Section 2.3.3.5</span></a>).</p>
<p>Das gleiche Vorgehen wurde auch bei den Variablen <code>island</code> und <code>sex</code> verwendet.</p>
</section>
</section>
<section id="sec-modellannahmen" class="level3" data-number="2.3.3">
<h3 data-number="2.3.3" class="anchored" data-anchor-id="sec-modellannahmen"><span class="header-section-number">2.3.3</span> Modellannahmen</h3>
<p>Unter welchen Voraussetzungen macht es Sinn ein lineares Modell zu verwenden und wie wird geprüft, ob diese erfüllt sind?</p>
<p>Der Hintergrund dieser Voraussetzungen liegt im sogenannten Gauss-Markov Theorem:</p>
<div id="thm-gm" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2.1 (Gauss-Markov)</strong></span> Gegeben sei ein lineares Modell wie in <a href="#eq-mlr" class="quarto-xref">Gleichung&nbsp;<span>2.3</span></a> mit unbekannten Parameter <span class="math inline">\(b = (b_0,..., b_J)\)</span>. Angenommen es gilt <span class="math inline">\(\varepsilon \sim \mathcal{N}(0,\Sigma)\)</span> mit <span class="math inline">\(\Sigma = \sigma^2 I_J\in\mathbb{R}^{J\times J}\)</span>, wobei <span class="math inline">\(I_J\)</span> eine <span class="math inline">\(J\)</span>-dimensionale Einheitsmatrix ist und <span class="math inline">\(\sigma^2&gt;0\)</span>. Wenn zusätzlich die Matrix <span class="math inline">\(X^\prime X\)</span> invertierbar ist, dann gilt:</p>
<p>Der Kleinste-Quadrate-Schätzer für den wahren Parametervektor <span class="math inline">\(b\)</span>, gegeben durch <a href="#eq-mlrsol" class="quarto-xref">Gleichung&nbsp;<span>2.4</span></a> ist ein minimalvarianter linearer erwartungstreuer Schätzer für den wahren Parameter <span class="math inline">\(b\)</span>.</p>
</div>
<p>Einfach gesagt bedeutet das:</p>
<blockquote class="blockquote">
<p>Falls die einzelnen Störgrößen <span class="math inline">\(\varepsilon_i,\: i=1,...,J\)</span> normalverteilt sind mit Erwartungswert <span class="math inline">\(0\)</span> und Varianz <span class="math inline">\(\sigma^2&gt;0\)</span> und zusätzlich die Variablen <span class="math inline">\(X_1,...,X_J\)</span> linear unabhängig voneinander sind, dann erwarten wir, dass der Schätzer <span class="math inline">\(\hat{b}\)</span> im Mittel dem wahren Parameter entspricht und es keinen anderen erwartungstreuen Schätzer <span class="math inline">\(\tilde{\hat{b}}\)</span> gibt, welcher eine bessere Modellgüte liefert.</p>
</blockquote>
<p>Aus diesen Aussagen lassen sich folgende Bedingungen herleiten:</p>
<ol type="1">
<li>Die Beziehung zwischen den unabhängigen und der abhängigen Variable muss tatsächlich linear sein.</li>
<li>Die Varianz der Residuen muss konstant sein (Homoskedastizität).</li>
<li>Die Residuen sind unabhängig (keine Autokorrelation).</li>
<li>Die Residuen sind normalverteilt.</li>
</ol>
<section id="lineare-beziehung" class="level4" data-number="2.3.3.1">
<h4 data-number="2.3.3.1" class="anchored" data-anchor-id="lineare-beziehung"><span class="header-section-number">2.3.3.1</span> Lineare Beziehung</h4>
<p>Eine grundlegende Bedingung ist, dass die Beziehung zwischen der abhängigen Variable und den (metrischen) erklärenden Variablen tatsächlich linear ist. Falls diese Bedingung nicht erfüllt ist, können die Effekte der verschiedenen unabhängigen Variablen nicht richtig interpretiert werden. Um zu prüfen, ob diese erfüllt ist, können die paarweise Punktewolken zwischen der abhängigen und den unabhängigen Variablen betrachtet werden.</p>
<p>Das folgende Code Snippet erzeugt drei Punktwolken welche jeweils auf der <code>x</code>-Achse die abhängige Variable <code>body_mass_g</code> und auf der <code>y</code>-Achse die metrischen unabhängigen Variablen abbilden.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>data_penguin <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">"mm"</span>),body_mass_g) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>body_mass_g) <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>value,<span class="at">x=</span>body_mass_g))<span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7"></a>    <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(name) ,<span class="at">scales =</span> <span class="st">"free"</span>)<span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Lineare_Regression_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In den ersten vier Zeilen wird der Datensatz für die Darstellung aufbereitet:</p>
<ol type="1">
<li><p>In Zeile 2 werden mithilfe der <code>select</code> und <code>ends_with</code> Funktion alle Variabken des Datensatzes <code>data_penguin</code> ausgewählt, deren Name entweder mit <code>"mm"</code> endet, oder <code>body_mass_g</code> ist. Durch diese Zeile werden alle metrischen Werte ausgewählt.</p></li>
<li><p>In Zeile 3 werden alle Einträge entfernt, welche fehlende Werte beinhalten.</p></li>
<li><p>Die <code>pivot_longer</code> Funktion Wandelt die übergebenen Daten in eine <em>verlängerte</em> Version um, welche weniger Spalten, aber mehr Zeilen enthält:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  body_mass_g name              value
        &lt;int&gt; &lt;chr&gt;             &lt;dbl&gt;
1        3750 bill_length_mm     39.1
2        3750 bill_depth_mm      18.7
3        3750 flipper_length_mm 181  
4        3800 bill_length_mm     39.5
5        3800 bill_depth_mm      17.4
6        3800 flipper_length_mm 186  </code></pre>
</div>
</div>
<p>Durch das spezifizieren von <code>-body_mass_g</code> wird erreicht, dass alle Variablen <strong>außer</strong> <code>body_mass_g</code> in zwei Spalten <code>name</code> und <code>value</code> zusammengefasst werden. Der verlängerte Datensatz enthält also nur noch die drei Spalten <code>body_mass_g</code>,<code>name</code> und <code>value</code>. In der Variable <code>name</code> sind die urpsrünglichen Variablennamen gespeichert und in <code>value</code> der dazugehörige Wert. Dieses Vorgehen erlaubt im nächsten Schritt das Erzeugen von mehreren Plots in Kombination mit der <code>facet_grid</code> Funktion.</p></li>
<li><p>Die <code>facet_grid</code> Funktion erzeugt eine Matrix von Plots wobei durch das Argument <code>rows = vars(name)</code> spezifiziert wird, dass die Ausprägungen der Variable <code>names</code> die Zeilen der Plot Matrix abbilden sollen.</p></li>
</ol>
<p>An der obigen Grafik lässt sich ablesen, dass der Zusammenhang zwischen den unabhängigen Variablen und <code>body_mass_g</code> linear ist, da ein linearer Trend erkennbar ist. Selbst bei der Variable <code>bill_depth_mm</code>, in welcher zwei distinkte Gruppen erkennbar sind, lässt sich jeweils ein linearen Trend feststellen.</p>
</section>
<section id="konstante-varianz-der-residuen" class="level4" data-number="2.3.3.2">
<h4 data-number="2.3.3.2" class="anchored" data-anchor-id="konstante-varianz-der-residuen"><span class="header-section-number">2.3.3.2</span> Konstante Varianz der Residuen</h4>
<p>Um die Residuen auf konstante Varianz zu prüfen, verwenden wir ähnlich wie im vorherigen Abschnitt ein visuelles Hilfsmittel: Indem wir die Residuen in Abähngigkeit der Vorhersagewerte als Punktewolke darstellen, können wir die Streuung um den Urpsrung betrachten.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Lineare_Regression_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In der obigen Grafik ist die Varianz der Residuen vermutlich konstant.</p>
<p><strong>Begründung:</strong> Obwohl unter den Vorhersagewerten <code>preds</code> in den Bereichen <code>[3750,4250]</code> und <code>[5250,5500]</code> Punkte zu erkennen sind, welche als Ausreißer interpretieren werden könnten, sind die restlichen Punkte eher gleichmäßig um den Ursprung verteilt. Gegeben dieser Observation können wir die Vermutung rechtfertigen, dass die Streuung der Residuen konstant ist.</p>
<p>Um eine Grafik wie die obige zu erzeugen müssen wir zuerst die Residuen und dann die Vorhersagen erzeugen.</p>
<p>Die Residuen können wir ähnlich wie die Zusammenfassung der Modellparameter erzeugen indem wir zuerst das <code>fit</code> Attribut des Modells aus dem Objekt <code>mlr_fit</code> mithilfe der <code>extract_fit_engine</code> Funktion extrahieren. Nach der Extraktion können wir dann mit der <code>residuals</code> Funktion die Residuen auslesen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>resid<span class="ot">&lt;-</span>mlr_fit <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ein ähnliches Vorgehen können wir auch bei den Vorhersagen anwenden. Allerdings müssen wir die Vorhersagen erst mithilfe der <code>predict</code> Funktion erzeugen. Um Vorhersagen für alle Observationen zu erhalten reicht es, den gesamten Datensatz als Argument zu übergeben. Durch die <code>na.omit</code> Funktion werden dann noch alle Fehlenden Werte entfernt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> mlr_fit <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(data_penguin) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nach dem erzeugen der Residuen und der Vorhersagewerte können wir diese in einem neuen Datensatz speichern und direkt an die <code>ggplot</code> Funktion übergeben:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">predictions =</span> preds,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">residuals =</span> resid</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>preds,<span class="at">y=</span>resid))<span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size=</span><span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Neben den Residuen ist es manchmal auch sinnvoll die <em>Quadratwurzel des Betrags der standardisierten Residuen</em> zu betrachten.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pictures/the_what.jpg" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption><a href="https://en.meming.world/wiki/The_What%3F">Quelle</a></figcaption>
</figure>
</div>
<p>Die geschätzten Residuen <span class="math inline">\(\hat\varepsilon = \hat{y}-y\)</span> werden standardisiert indem man durch eine empirische Standardabweichung teilt.</p>
<p>So ergibt sich</p>
<p><span class="math display">\[
\hat{\varepsilon}_{\text{std}} = \frac{\hat{\varepsilon}}{\text{sd}_{\hat\varepsilon}}
\]</span></p>
<p>Die empirische Standardabweichung wird hierbei durch den Term</p>
<p><span class="math display">\[
\text{sd}_{\hat{\varepsilon}} = \hat{\sigma}\sqrt{(K-1)/K}
\]</span> mit</p>
<p><span class="math display">\[
\hat{\sigma}^2 = \frac{1}{K-J}\sum_{k=1}^K\hat{\varepsilon}^2_k
\]</span> geschätzt.</p>
<p>Die Motivation für standardisierte Residuen ist, dass, obwohl unser Modell Homoskedastizität mit einem i.i.d.-Fehlerterm mit fester Varianz <span class="math inline">\(\varepsilon_k\sim \mathcal{N}(0,1)\)</span> annimmt, die Verteilung der Residuen <span class="math inline">\(\varepsilon_k\)</span> nicht i.i.d. sein kann, da die Summe der Residuen immer genau Null ist.</p>
<p>Einfach gesagt bedeutet das: Beim darstellen der nicht-standardisierten Residuen sind die Abweichungen schwieriger zu erkennen.</p>
<p>Folgendes Beispiel illustriet diesesn Effekt:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Lineare_Regression_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>Falls die Daten in der rechten Spalte ebenso homoskedastisch wären, müsste die Trendlinie in der letzten Grafik auch horizontal sein. Anhand der anderen beiden Plots lässt sich kaum erkennen, ob Heteroskedastie vorliegt.</p>
<p>Im Beispiel des Pinguin Datensatzes sieht die Darstellung der Residuen wie folgt aus:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Lineare_Regression_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In den Residuen wird ein kleiner Abwärtstrend sichtbar, welcher allerdings so gering ist, dass für das gegebene Modell keine Heteroskedastie vermutet werden sollte.</p>
<p>Die obige Grafik wurde durch folgenden Code erzeugt:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>resid<span class="ot">&lt;-</span>mlr_fit <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>  <span class="fu">rstudent</span>()</span>
<span id="cb32-4"><a href="#cb32-4"></a></span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="fu">tibble</span>(</span>
<span id="cb32-6"><a href="#cb32-6"></a>  <span class="at">predictions =</span> preds,</span>
<span id="cb32-7"><a href="#cb32-7"></a>  <span class="at">residuals =</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(resid))</span>
<span id="cb32-8"><a href="#cb32-8"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="#cb32-9"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>preds,<span class="at">y=</span>residuals))<span class="sc">+</span></span>
<span id="cb32-10"><a href="#cb32-10"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb32-11"><a href="#cb32-11"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y<span class="sc">~</span>x, <span class="at">se =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb32-12"><a href="#cb32-12"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size=</span><span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ähnlich wie bei der vorherigen Grafik wurde mithilfe von <code>ggplot</code> eine Punktewolke durch die Residuen und Vorhersagen erzeugt. Der Unterschied liegt hierbei in den Zeilen <code>3</code>, <code>7</code> und <code>11</code>.</p>
<ul>
<li><p>In Zeile <code>3</code> wurde wurde nicht die <code>residuals()</code> Funktion verwendet, sondern die <code>rstudent</code>. Diese erzeugt die standardisierten Residuen wie sie im vorherigen Abschnitt beschrieben wurden.</p></li>
<li><p>In Zeile <code>7</code> wird die Quadratwurzel des Betrags der standardisierten Residuen durch die Funktionen <code>sqrt()</code> und <code>abs()</code> berechnet.</p></li>
<li><p>In Zeile <code>11</code> wird mithilfe der <code>geom_smooth</code> Funktion eine Trendlinie hinzugefügt. Das Argument <code>method = "lm"</code> sorgt dafür, dass die Trendlinie linear ist. Durch <code>formula = y~x</code> wird die Formel der Trendlinie spezifiziert. Die Notation mit <code>y</code> und <code>x</code> bezieht sich hierbei auf die Variablen <code>y</code> und <code>x</code> welche in den Aesthetics in Zeile <code>9</code> übergeben wurden. Das Argument <code>se=FALSE</code> steuert, dass keine Konfidenzstreifen um die Trendlinien hinzugefügt werden.</p></li>
</ul>
</section>
<section id="autokorrelation" class="level4" data-number="2.3.3.3">
<h4 data-number="2.3.3.3" class="anchored" data-anchor-id="autokorrelation"><span class="header-section-number">2.3.3.3</span> Autokorrelation</h4>
<p>Um zu überprüfen, ob die Residuen unabhängig von einander sind, kann man ebenso als visuelles Hilfsmittel eine Punktewolke wie bei der Überprüfung der Homoskedastizitätsannahme erstellen.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Lineare_Regression_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In der obigen Grafik überprüfen wir allerdings nicht nur, ob die Trendlinie horizontal ist, sondern ob diese <em>linear</em> ist. Beim erzeugen der Trendlinie wurde nämlich nicht wie zuvor <code>method = "lm"</code> verwendet, sondern <code>method = "loess"</code>. <code>"loess"</code> steht in diesem Kontext für <a href="https://en.wikipedia.org/wiki/Local_regression">locally estimated scatterplot smoothing</a>. Wichtig hierbei ist lediglich zu wissen, dass ein LOESS Model auch nichtlineare Zusammenhänge zwischen der abhängigen und den unabhängigen Varoablen abbilden kann.</p>
<p>Die Trendlinie in der obigen Grafik ist leicht nichtlinear, folgt allerdings keinem erkennbaren Trend, so dass wir hier eine leichte Korrelation der Residuen unterstellen können.</p>
<!--

Übungsaufgabe: Können die Residuen auch nichtkonstante Varianz haben, aber die Trendlinie horizontal sein?





::: {.cell}

```{.r .cell-code}
set.seed(123)

tibble_ex <- tibble(
  x = seq(0,10,length.out = 300),
  y_hetero = x+rnorm(300,0,(0.5-x/10)^2)
)


p2 <- tibble_ex %>%
  ggplot(aes(x=x,y=y_hetero))+
  geom_point()+
  labs(
    y = "y",
    title = " Modell"
  )+
  theme_minimal(base_size=14)+
  coord_fixed(ratio = 2.25/5)

lm_auto_fit <- linear_reg() %>%
  fit(data = tibble_ex,
      formula = y_hetero ~ x) %>%
  extract_fit_engine()

tibble_resid <- tibble(
  x = seq(0,10,length.out = 300),
  res_auto = (lm_auto_fit %>% 
                residuals())
)

p4 <-  tibble_resid %>%
  ggplot(aes(x=x,y=res_auto))+
  geom_point()+
  geom_smooth(se = F)+
  labs(
    y = "Residuen",
    title = "Residuen des Modells mit Autokorellation"
  )+
  theme_minimal(base_size=14)+
  coord_fixed(ratio = 6)


tibble_stand_resid <- tibble(
 x = seq(0,10,length.out = 300),
 res_auto_stand = rstudent(lm_auto_fit)
)


p6 <- tibble_stand_resid %>%
  ggplot(aes(x=x,y=sqrt(abs(res_auto_stand))))+
  geom_point()+
  geom_smooth(se = FALSE)+
  geom_smooth(method = "lm", color = "red", se = FALSE)+
  labs(
    y = TeX("$\\sqrt{|Std. Residuen|}"),
    title = "Quadratwurzel des Betrags der standardisierten Residuen des Modells mit Autokorrelation"
  )+
  theme_minimal(base_size = 15)+
  coord_fixed(ratio = 5)

p2/p4/p6
```

::: {.cell-output .cell-output-stderr}

```
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
```


:::

::: {.cell-output-display}
![](02_Lineare_Regression_files/figure-html/unnamed-chunk-35-1.png){width=672}
:::
:::





-->
</section>
<section id="normalität-der-residuen" class="level4" data-number="2.3.3.4">
<h4 data-number="2.3.3.4" class="anchored" data-anchor-id="normalität-der-residuen"><span class="header-section-number">2.3.3.4</span> Normalität der Residuen</h4>
<p>Die letzte Annahme des Gauss–Markov Theorems lässt sich durch verschiedene visuelle Hilfsmittel überprüfen.</p>
<section id="qq-plots" class="level5" data-number="2.3.3.4.1">
<h5 data-number="2.3.3.4.1" class="anchored" data-anchor-id="qq-plots"><span class="header-section-number">2.3.3.4.1</span> QQ-Plots</h5>
<p>Häufig wird ein sogenannter <em>QQ-Plot</em> (Quantil-Quantil-Plot) verwendet, um zu überprüfen, ob die Unterliegende Verteilung einer Normalverteilung entspricht. Hierbei werden den empirischen Quantilen (die der unterliegenden Residuen) den theoretischen Quantilen gegenübergestellt. Falls die Punkte hierbei sehr nah an der erzeugten Geraden liegen, so geht man davon aus, dass die Quantile der empirischen Verteilung gleich der Normalverteilung sind und somit die Residuen ebenso normalverteilt sind.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>resid <span class="ot">&lt;-</span> mlr_fit <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">residuals =</span> .)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>resid <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample=</span>residuals))<span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>()<span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>()<span class="sc">+</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size=</span><span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Lineare_Regression_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Da die empirischen Quantile der Residuen relativ nah an der erzeugten Geraden liegen, kann man davon ausgehen, dass diese normalverteilt sind.</p>
<p>Um die obige Grafik zu erzeugen werden wieder zuerst die Residuen in den Code Zeilen <code>1</code>-<code>4</code> erzeugt. Hierbei werden die Residuen allerdings in einem Tibble bzw. Data Frame gespeichert, da der Rückgabewert der <code>residuals()</code> Funktion den Datentyp <code>&lt;dbl&gt;</code> besitzt . Die <code>ggplot</code> Funktion setzt allerdings voraus, dass die Daten als Data Frame oder Tibble übergeben werden. Das Argument <code>residuals = .</code> sorgt dafür, dass im Tibble eine neue Spalte <code>residuals</code> erzeugt wird welche als Werte den Output der <code>residuals()</code> Funktion übergeben bekommt.</p>
<p>Um dann den QQ-Plot zu erzeugen muss man in den Aestethics der <code>ggplot</code> Funktion das Argument <code>sample</code> setzen (anstatt <code>x</code> und <code>y</code> wie gewohnt). Nachdem das Sample auf <code>residuals</code> gesetzt wurde, können dann mithilfe der <code>geom_qq()</code> und <code>geom_qq_line()</code> Funktion die Punkte und die Gerade erzeugt werden.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Wiederholung">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Wiederholung
</div>
</div>
<div class="callout-body-container callout-body">
<p>Um für eine gegebene Stichprobe <span class="math inline">\(x_1,...,x_K\)</span> die empirischen Quantile zu berechnen, wird die Stichprobe zuerst sortiert (Ordnungsstatistik). Die sortierte Stichprobe wird durch die Notation <span class="math inline">\(x_{(1)},...,x_{(K)}\)</span> mit <span class="math inline">\(x_{(1)}\leq x_{(2)}\leq...x_{(K)}\)</span> dargestellt. Für <span class="math inline">\(p\in(0.1)\)</span> ist dann das empirische <span class="math inline">\(p\)</span>-Quantil definiert als</p>
<p><span class="math display">\[
\tilde x_p = \begin{cases}
              x_{(\lfloor K\cdot p\rfloor+1)} \quad \text{für }K\cdot p\notin\mathbb{Z}\\
              \frac{x_{(K\cdot p)}+x_{(K\cdot p+1)}}{2}\text{für }K\cdot p\in\mathbb{Z}\\
              \end{cases}
\]</span></p>
</div>
</div>
</section>
<section id="vergleich-der-histogramme-mit-der-dichte-einer-normalverteilung" class="level5" data-number="2.3.3.4.2">
<h5 data-number="2.3.3.4.2" class="anchored" data-anchor-id="vergleich-der-histogramme-mit-der-dichte-einer-normalverteilung"><span class="header-section-number">2.3.3.4.2</span> Vergleich der Histogramme mit der Dichte einer Normalverteilung</h5>
<p>Neben den Quantilen bietet sich auch die Betrachtung des Histogramms der Residuen an:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>resid <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>residuals))<span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()<span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Lineare_Regression_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Um das Histogramm, welches durch die <code>geom_histogram</code> Funktion erzeugt wurde mit der Dichte einer Normalverteilung vergleichen zu können, müssen wir zuerst die die <code>y</code>-Achse so anpassen, dass diese nicht mehr die absoluten Häufigkeiten, sondern die relativen Häufigkeiten darstellt. Durch das setzen von <code>y=after_stat(density)</code> in den Aesthetics der <code>geom_histogram</code> Ebene wird dies erreicht.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>resid <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>residuals))<span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span> <span class="fu">after_stat</span>(density)))<span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Lineare_Regression_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Nach dem festlegen der DArstellung der Häufigkeit kann als nächstes die Dichte einer Normalverteilung hinzugefügt werden. Die <code>stat_function()</code> Funktion erleichter das Hinzufügen der Dichte einer Normalverteilung um ein vielfaches, da hier vorerst nur das Argument <code>fun=dnorm</code> übergeben werden muss.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>resid <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>residuals))<span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span> <span class="fu">after_stat</span>(density)))<span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Lineare_Regression_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Problematisch ist allerdings, dass die Dichte einer Standardnormalverteilung (<span class="math inline">\(\mathcal{N}(0,1)\)</span>) abgebildet wird, für welche gilt <span class="math inline">\(f(x)\approx 0,\: |x|&gt;4\)</span>. Die rote Linie in der obigen Grafik stellt die Dichte der Standardnormalverteilung dar. Für das Histogramm gilt allerdings, dass selbst für <span class="math inline">\(|\verb|residuals|| &gt; 500\)</span> noch Observationen erkennbar sind. Es müssen also entweder die Werte der Residuen skaliert werden, oder die Parameter der Normalverteilung angepasst werden. Um die Parameter der Normalverteilung anzupassen, verwendet man das <code>args</code> Argument. Die Funktion <code>dnorm</code> besitzt die Argumente <code>mean</code> und <code>sd</code>, was für den Mittelwert und die Standardabweichung der Normalverteilung steht. Indem man das Argument <code>mean</code> auf den Mittelwert der Residuen und <code>sd</code> auf die Standardabweichung der Residuen setzt, sollte sich also die Dichte einer Normalverteilung erzeugen lassen, welche wir mit dem Histogramm vergleichen können!</p>
<p>Um die beiden Argumente <code>mean</code> und <code>sd</code> zu übergeben, kann man diese zuerst separat berechnen und dann als Liste <code>list(mean = ..., sd = ...)</code> übergeben:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>mean_res <span class="ot">&lt;-</span> mlr_fit <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>()<span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>()</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>sd_res <span class="ot">&lt;-</span> mlr_fit <span class="sc">%&gt;%</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>()<span class="sc">%&gt;%</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sd</span>()</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>resid <span class="sc">%&gt;%</span> </span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>residuals))<span class="sc">+</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span> <span class="fu">after_stat</span>(density)))<span class="sc">+</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm,</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">linewidth =</span> <span class="fl">1.5</span>,</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mean_res,</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sd =</span> sd_res))<span class="sc">+</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Lineare_Regression_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Wie an der obigen Grafik zu erkennen ist, passt die dargestellte Dichte gut zu dem erzeugtem Histogramm. Wir können also auch daraus schließen, dass die Residuen vermutlich normalverteilt sind.</p>
</section>
</section>
<section id="sec-multikollinearitaet" class="level4" data-number="2.3.3.5">
<h4 data-number="2.3.3.5" class="anchored" data-anchor-id="sec-multikollinearitaet"><span class="header-section-number">2.3.3.5</span> Multikollinearität</h4>
<p>Eine weitere Bedingung welche zwar nicht durch das Gauss–Markov Theorem vorausgesetzt wird, aber trotzdem wichtig ist, ist die der nichtvorhandenen <em>Multikollinearität</em> der erklärenden Variablen.</p>
<p>Multikollinearität ist wie folgt definiert:</p>
<p>Falls für einen Datensatz mit erklärenden Variablen <span class="math inline">\(X_1,...,X_J\in\mathbb{R}^K\)</span> eine Teilmenge <span class="math inline">\(X_i,X_{i+1},...,X_j\)</span> mit <span class="math inline">\(1\leq i&lt;j+1\leq J\)</span> existiert, so dass</p>
<p><span id="eq-MKL"><span class="math display">\[
X_i = \sum_{n=i}^{j} \alpha_n X_{n+1}, \quad \alpha_1,...,\alpha_n\in\mathbb{R}\setminus\{0\}
\tag{2.6}\]</span></span></p>
<p>dann sind die Variablen <span class="math inline">\(X_i,X_{i+1},...,X_j\)</span> multikollinear. Die rechte Seite der <a href="#eq-MKL" class="quarto-xref">Gleichung&nbsp;<span>2.6</span></a> wird auch Linearkombination der Vektoren <span class="math inline">\(X_{i+1},...,X_{j+1}\)</span> genannt. Die Vektoren <span class="math inline">\(X_i\)</span> und <span class="math inline">\(X_{i+1},...,X_{j+1}\)</span> sind somit linear abhängig. Falls keine Konstanten <span class="math inline">\(\alpha_1,...,\alpha_n\in\mathbb{R}\setminus\{0\}\)</span> existieren so dass in <a href="#eq-MKL" class="quarto-xref">Gleichung&nbsp;<span>2.6</span></a> Gleichheit gilt, dann spricht man von linearer Unabhängigkeit der Vektoren.</p>
<div id="exm-MLK" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 2.2</strong></span> Seien <span class="math display">\[\begin{equation*}
      X_1 = \begin{pmatrix}
        1 &amp; 0 &amp; 0\\
        0 &amp; 1 &amp; 0\\
        0 &amp; 0 &amp; 1\\
        0 &amp; 1 &amp; 1\\
      \end{pmatrix} \quad
      X_2 = \begin{pmatrix}
        1 &amp; 0 &amp; 1\\
        1 &amp; 0 &amp; 1\\
        0 &amp; 1 &amp; 1\\
        0 &amp; 1 &amp; 1\\
      \end{pmatrix}.
    \end{equation*}\]</span></p>
<ol type="1">
<li><p>Die Spalten von <span class="math inline">\(X_1\)</span> sind paarweise linear unabhängig und linear unabhängig.</p></li>
<li><p>Die Spalten von <span class="math inline">\(X_2\)</span> sind paarweise linear unabhängig, aber nicht linear unabhängig, da</p>
<p><span class="math display">\[\begin{align*}
  x_1 = \begin{pmatrix}  1\\1\\0\\0\end{pmatrix} =  -1 \cdot\begin{pmatrix}   0\\0\\1\\1\end{pmatrix}   + \begin{pmatrix}  1\\1\\1\\1\end{pmatrix}.
\end{align*}\]</span> Der erste Spaltenvektor lässt sich also als Linearkombination der anderen beiden Spaltenvektoren darstellen.</p></li>
</ol>
</div>
<p>In den meisten Fällen sind die Variablen in einem Datensatz allerdings nicht multikollinear wie in <a href="#eq-MKL" class="quarto-xref">Gleichung&nbsp;<span>2.6</span></a>, sondern nur approximativ kollinear, d.h.</p>
<p><span class="math display">\[
X_i \approx \sum_{n=i}^{j} \alpha_n X_{n+1}, \quad \alpha_1,...,\alpha_n\in\mathbb{R}\setminus\{0\}.
\]</span></p>
<p>Um zu überprüfen, ob die unabhängigen Variablen eines Datensatzes linear abhängig sind, wird nicht wie im obigen Beipsiel versucht eine passende Linearkombination zu finden, sondern es wird der <em>Spaltenrang</em> der Feature-Matrix bestimmt.</p>
<p>Der Spaltenrang einer Matrix <span class="math inline">\(X\)</span> ist definiert als die maximale Anzahl an linear unabhängigen Spaltenvektoren in <span class="math inline">\(X\)</span>.</p>
<div id="exm-MLK2" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 2.3</strong></span> &nbsp;</p>
<ol type="1">
<li><p>Die Matrix <span class="math inline">\(X_1\)</span> aus <a href="#exm-MLK" class="quarto-xref">Example&nbsp;<span>2.2</span></a> hat Spaltenrang <span class="math inline">\(3\)</span>, da die drei Spalten linear unabhängig sind.</p></li>
<li><p>Die Matrix <span class="math inline">\(X_2\)</span> aus <a href="#exm-MLK" class="quarto-xref">Example&nbsp;<span>2.2</span></a> hat Spaltenrang <span class="math inline">\(2\)</span>, da nur <span class="math inline">\(2\)</span> der drei Spalten linear unabhängig sind.</p></li>
</ol>
</div>
<div class="callout callout-style-default callout-important callout-titled" title="Wichtig">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Wichtig
</div>
</div>
<div class="callout-body-container callout-body">
<p>Eine Quadratische Matrix <span class="math inline">\(X\in\mathbb{R}^{n\times n}\)</span> ist invertierbar, falls sie vollen Rang hat, i.e., alle Spalten sind linear unabhängig. Falls <span class="math inline">\(X\)</span> vollen Rang besitzt, dann existiert eine Matrix <span class="math inline">\(X^{-1}\in\mathbb{R}^{n\times n}\)</span> (die Inverse (Matrix) von <span class="math inline">\(X\)</span>) sodass <span class="math inline">\(X\cdot X^{-1} = I_n\)</span> mit</p>
<p><span class="math display">\[\begin{equation}
  I_n = \begin{pmatrix}
    1 &amp; 0 &amp; ... &amp; 0\\
    0 &amp; 1 &amp; ... &amp; 0\\
    \vdots  &amp; \vdots &amp; \ddots &amp; \vdots\\
    0 &amp; 0 &amp; ... &amp; 1
  \end{pmatrix}
\end{equation}\]</span></p>
<p>gilt.</p>
</div>
</div>
</section>
<section id="das-problem-mit-multikollinearität" class="level4" data-number="2.3.3.6">
<h4 data-number="2.3.3.6" class="anchored" data-anchor-id="das-problem-mit-multikollinearität"><span class="header-section-number">2.3.3.6</span> Das Problem mit Multikollinearität</h4>
<p>Warum ist Multikollinearität nun ein Problem? Kurz zusammengefasst:</p>
<p>Multikollinearität führt dazu, dass die Regressionsparameter nicht mehr korrekt interpretiert werden können und im schlimmsten Fall, dass das MLR Modell als ganzes nicht mehr interpretierbar ist.</p>
<p>Da in <a href="#eq-mlrsol" class="quarto-xref">Gleichung&nbsp;<span>2.4</span></a> die Matrix <span class="math inline">\((X^\prime X)\)</span> invertiert wird um die optimalen Parameter <span class="math inline">\(b_0,...,b_J\)</span> schätzen zu können, muss diese die voraussetzung der Invertierbarkeit erfüllen. Wie im vorherigen Abschnitt beschrieben ist die Invertierbarkeit einer quadratischen Matrix allerdings nur dann möglich, falls diese vollen Spaltenrang hat, also die Spalten alle unabhängig von einander sind. Falls die Spalten abhängig voneinander und somit (multi)kollinear sind, können die Parameter nicht mehr geschätzt werden. Auch falls die Spalten approximativ linear abhänngig sind, führt das ebesno zu Problem bei der Berechnung.</p>
<p>Das folgende Beispiel illustriert diese Effekte.</p>
<div id="exm-mlr" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 2.4</strong></span> Der Datensatz <code>data_kantine</code> bildet die Anzahl der Besucher in einem Club (<code>num_vis</code>) an 20 Abenden, den durchschnittlichen Preis für ein Getränk (<code>avg_drink_price</code>), die Wochentage, sowie der die durchschnittlichen Ausgaben pro Gast an den enstsprechenden Abenden.</p>
<div class="cell">
<div class="cell-output-display">
<div id="gcwvzouehs" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gcwvzouehs table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gcwvzouehs thead, #gcwvzouehs tbody, #gcwvzouehs tfoot, #gcwvzouehs tr, #gcwvzouehs td, #gcwvzouehs th {
  border-style: none;
}

#gcwvzouehs p {
  margin: 0;
  padding: 0;
}

#gcwvzouehs .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gcwvzouehs .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gcwvzouehs .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gcwvzouehs .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gcwvzouehs .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gcwvzouehs .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gcwvzouehs .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gcwvzouehs .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gcwvzouehs .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gcwvzouehs .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gcwvzouehs .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gcwvzouehs .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gcwvzouehs .gt_spanner_row {
  border-bottom-style: hidden;
}

#gcwvzouehs .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gcwvzouehs .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gcwvzouehs .gt_from_md > :first-child {
  margin-top: 0;
}

#gcwvzouehs .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gcwvzouehs .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gcwvzouehs .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gcwvzouehs .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gcwvzouehs .gt_row_group_first td {
  border-top-width: 2px;
}

#gcwvzouehs .gt_row_group_first th {
  border-top-width: 2px;
}

#gcwvzouehs .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gcwvzouehs .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gcwvzouehs .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gcwvzouehs .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gcwvzouehs .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gcwvzouehs .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gcwvzouehs .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gcwvzouehs .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gcwvzouehs .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gcwvzouehs .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gcwvzouehs .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gcwvzouehs .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gcwvzouehs .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gcwvzouehs .gt_left {
  text-align: left;
}

#gcwvzouehs .gt_center {
  text-align: center;
}

#gcwvzouehs .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gcwvzouehs .gt_font_normal {
  font-weight: normal;
}

#gcwvzouehs .gt_font_bold {
  font-weight: bold;
}

#gcwvzouehs .gt_font_italic {
  font-style: italic;
}

#gcwvzouehs .gt_super {
  font-size: 65%;
}

#gcwvzouehs .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gcwvzouehs .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gcwvzouehs .gt_indent_1 {
  text-indent: 5px;
}

#gcwvzouehs .gt_indent_2 {
  text-indent: 10px;
}

#gcwvzouehs .gt_indent_3 {
  text-indent: 15px;
}

#gcwvzouehs .gt_indent_4 {
  text-indent: 20px;
}

#gcwvzouehs .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="num_vis" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">num_vis</th>
<th id="avg_drink_price" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">avg_drink_price</th>
<th id="avg_expense" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">avg_expense</th>
<th id="week_day" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">week_day</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="num_vis">289</td>
<td class="gt_row gt_right" headers="avg_drink_price">4.84</td>
<td class="gt_row gt_right" headers="avg_expense">22.7</td>
<td class="gt_row gt_left" headers="week_day">Mittwoch</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="num_vis">295</td>
<td class="gt_row gt_right" headers="avg_drink_price">5.00</td>
<td class="gt_row gt_right" headers="avg_expense">23.8</td>
<td class="gt_row gt_left" headers="week_day">Samstag</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="num_vis">331</td>
<td class="gt_row gt_right" headers="avg_drink_price">4.43</td>
<td class="gt_row gt_right" headers="avg_expense">20.5</td>
<td class="gt_row gt_left" headers="week_day">Sonntag</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="num_vis">301</td>
<td class="gt_row gt_right" headers="avg_drink_price">4.81</td>
<td class="gt_row gt_right" headers="avg_expense">25.4</td>
<td class="gt_row gt_left" headers="week_day">Samstag</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="num_vis">303</td>
<td class="gt_row gt_right" headers="avg_drink_price">4.81</td>
<td class="gt_row gt_right" headers="avg_expense">24.4</td>
<td class="gt_row gt_left" headers="week_day">Samstag</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="num_vis">334</td>
<td class="gt_row gt_right" headers="avg_drink_price">4.24</td>
<td class="gt_row gt_right" headers="avg_expense">19.8</td>
<td class="gt_row gt_left" headers="week_day">Sonntag</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="num_vis">309</td>
<td class="gt_row gt_right" headers="avg_drink_price">5.12</td>
<td class="gt_row gt_right" headers="avg_expense">24.1</td>
<td class="gt_row gt_left" headers="week_day">Sonntag</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="num_vis">275</td>
<td class="gt_row gt_right" headers="avg_drink_price">5.29</td>
<td class="gt_row gt_right" headers="avg_expense">24.7</td>
<td class="gt_row gt_left" headers="week_day">Mittwoch</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="num_vis">286</td>
<td class="gt_row gt_right" headers="avg_drink_price">4.86</td>
<td class="gt_row gt_right" headers="avg_expense">24.2</td>
<td class="gt_row gt_left" headers="week_day">Mittwoch</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="num_vis">291</td>
<td class="gt_row gt_right" headers="avg_drink_price">5.40</td>
<td class="gt_row gt_right" headers="avg_expense">25.5</td>
<td class="gt_row gt_left" headers="week_day">Mittwoch</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="num_vis">324</td>
<td class="gt_row gt_right" headers="avg_drink_price">4.87</td>
<td class="gt_row gt_right" headers="avg_expense">23.7</td>
<td class="gt_row gt_left" headers="week_day">Sonntag</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="num_vis">307</td>
<td class="gt_row gt_right" headers="avg_drink_price">4.86</td>
<td class="gt_row gt_right" headers="avg_expense">23.4</td>
<td class="gt_row gt_left" headers="week_day">Samstag</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="num_vis">308</td>
<td class="gt_row gt_right" headers="avg_drink_price">5.14</td>
<td class="gt_row gt_right" headers="avg_expense">24.5</td>
<td class="gt_row gt_left" headers="week_day">Samstag</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="num_vis">302</td>
<td class="gt_row gt_right" headers="avg_drink_price">5.20</td>
<td class="gt_row gt_right" headers="avg_expense">26.2</td>
<td class="gt_row gt_left" headers="week_day">Samstag</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="num_vis">289</td>
<td class="gt_row gt_right" headers="avg_drink_price">5.32</td>
<td class="gt_row gt_right" headers="avg_expense">25.1</td>
<td class="gt_row gt_left" headers="week_day">Mittwoch</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="num_vis">336</td>
<td class="gt_row gt_right" headers="avg_drink_price">4.81</td>
<td class="gt_row gt_right" headers="avg_expense">24.8</td>
<td class="gt_row gt_left" headers="week_day">Sonntag</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="num_vis">310</td>
<td class="gt_row gt_right" headers="avg_drink_price">5.04</td>
<td class="gt_row gt_right" headers="avg_expense">22.6</td>
<td class="gt_row gt_left" headers="week_day">Sonntag</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="num_vis">261</td>
<td class="gt_row gt_right" headers="avg_drink_price">5.37</td>
<td class="gt_row gt_right" headers="avg_expense">26.1</td>
<td class="gt_row gt_left" headers="week_day">Mittwoch</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="num_vis">314</td>
<td class="gt_row gt_right" headers="avg_drink_price">4.78</td>
<td class="gt_row gt_right" headers="avg_expense">23.2</td>
<td class="gt_row gt_left" headers="week_day">Sonntag</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="num_vis">291</td>
<td class="gt_row gt_right" headers="avg_drink_price">4.99</td>
<td class="gt_row gt_right" headers="avg_expense">24.2</td>
<td class="gt_row gt_left" headers="week_day">Mittwoch</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Die metrischen Spalten des Datensatzes sind linear unabhängig. Die Korrelationsmatrix auf basis des Pearson Korrelationskoeffizient ergibt allerdings</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  term            num_vis avg_drink_price avg_expense
  &lt;chr&gt;             &lt;dbl&gt;           &lt;dbl&gt;       &lt;dbl&gt;
1 num_vis          NA              -0.717      -0.596
2 avg_drink_price  -0.717          NA           0.817
3 avg_expense      -0.596           0.817      NA    </code></pre>
</div>
</div>
<p>D.h., die beiden Spalten <code>avg_expense</code> und <code>avg_drink_price</code> korrelieren stark (<span class="math inline">\(\rho &gt; 0.9\)</span>)!</p>
<p>Verwendet man nun die numerischen Variablen, um die Anzahl der Clubbesucher anhand eines MLR Modells zu modellieren, so erhält man</p>
<div class="cell" data-out.lines="[10,11,12,13,14,15,16]">
<div class="cell-output cell-output-stdout">
<pre><code>...

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     535.4580    55.1249   9.714 2.37e-08 ***
avg_drink_price -45.1042    19.1417  -2.356   0.0307 *  
avg_expense      -0.3753     3.4631  -0.108   0.9150    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
...</code></pre>
</div>
</div>
<p>Die beiden Variablen <code>avg_drink_price</code> und <code>avg_expense</code> sind im obigen Modell beide nicht hochsignifikant (<span class="math inline">\(p&gt;0.01\)</span>).</p>
<p>Falls aber im Gegensatz dazu jeweils entweder nur die Variable <code>avg_drink_price</code> oder <code>avg_expense</code> verwendet um die Besucherzahl zu modellieren, ergeben sich folgende Statistiken:</p>
<ol type="1">
<li><p>Modell 1:</p>
<div class="cell" data-out.lines="[10,11,12,13,14,15]">
<div class="cell-output cell-output-stdout">
<pre><code>...

                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       534.87      53.33  10.029 8.54e-09 ***
avg_drink_price   -46.80      10.74  -4.359 0.000378 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

...</code></pre>
</div>
</div></li>
<li><p>Modell 2:</p>
<div class="cell" data-out.lines="[10,11,12,13,14,15]">
<div class="cell-output cell-output-stdout">
<pre><code>...

            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  471.381     53.673   8.782 6.33e-08 ***
avg_expense   -7.040      2.237  -3.148  0.00556 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

...</code></pre>
</div>
</div></li>
</ol>
<p>Da die beiden Variablen stark korrelieren, sind ihre Effekte im Modell welches beide Variablen enthält weder signifikant, noch interpretierbar. Allerdings sind die Parameter getrennt betrachtet in <code>Modell 1</code> und <code>Modell 2</code> (hoch)signifikant, was ebenso dafür spricht, dass die Feature stark korellieren.</p>
<p>Noch extremer ist der Effekt, wenn man die Variable <code>weekday</code> in eine Dummy Variable umwandelt, welche jede Ausprägungsmöglichkeit abbildet:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>data_kantine_dummy <span class="ot">&lt;-</span> data_kantine <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">week_day_wednesday =</span> <span class="fu">if_else</span>(week_day <span class="sc">==</span> <span class="st">"Mittwoch"</span>, <span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">week_day_saturday =</span> <span class="fu">if_else</span>(week_day <span class="sc">==</span> <span class="st">"Samstag"</span>, <span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">week_day_sunday =</span> <span class="fu">if_else</span>(week_day <span class="sc">==</span> <span class="st">"Sonntag"</span>, <span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">week_day =</span> <span class="cn">NULL</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Im obigen Datensatz wurde die Variable <code>week_day</code> durch Dummy Variablen ersetzt, welche jeden Wochentag im Datensatz abbilden. Wenn dann die Parameter für das MLR Modell geschätzt werden, welches den Einfluss der Wochentage auf die Besucherzahl modelliert, dann ergibt sich der Asuzug aus folgender Zusammenfassung:</p>
<div class="cell" data-out.lines="[10,11,12,13,14,15,16,17]">
<div class="cell-output cell-output-stdout">
<pre><code>...

Coefficients: (1 not defined because of singularities)
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         322.571      3.742  86.213  &lt; 2e-16 ***
week_day_wednesday  -39.429      5.291  -7.452 9.47e-07 ***
week_day_saturday   -19.905      5.507  -3.614  0.00214 ** 
week_day_sunday          NA         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
...</code></pre>
</div>
</div>
<p>Da die Dummy Variablen perfekt mit dem Intercept korrelieren, kann der Koeffizient für <code>week_day_sunday</code> nicht berechnet werden.</p>
</div>
<section id="variance-inflation-factor" class="level5" data-number="2.3.3.6.1">
<h5 data-number="2.3.3.6.1" class="anchored" data-anchor-id="variance-inflation-factor"><span class="header-section-number">2.3.3.6.1</span> Variance Inflation Factor</h5>
<p>Neben einer Korrelationsmatrix kann auch der Variance Inflation Factor definiert als</p>
<p><span id="eq-vif"><span class="math display">\[
\text{VIF}_j = \frac{1}{1-R^2_j}
\tag{2.7}\]</span></span></p>
<p>verwendet werden um zu prüfen, ob Multikolinearität in einem Modell vorhanden ist. Hierbei steht <span class="math inline">\(R_j^2\)</span> für das Bestimmtheitsmaß der Regression des Regressors <span class="math inline">\(X_j\)</span> auf alle anderen Regressoren. Als Daumenregel wird häufig genannt, dass falls <span class="math inline">\(\text{VIF}_j\geq 5\)</span>, der Regressor <span class="math inline">\(X_j\)</span> aus dem Modell entfernt werden sollte.</p>
<p>Um den VIF für alle unabhängigen Variablen zu berechnen, kann man die <code>vif()</code> Funktion der <code>{car}</code> Library verwenden. Ähnlich wie beim erzeugen der Modellzusammenfassung muss man zuerst die <code>extract_fit_engine()</code> Funktion anwenden um das Modell an die <code>vif()</code> Funktion übergeben zu können.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>mlr_fit <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  car<span class="sc">::</span><span class="fu">vif</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       GVIF Df GVIF^(1/(2*Df))
species           71.200285  2        2.904828
island             3.762055  2        1.392696
bill_length_mm     6.117069  1        2.473271
bill_depth_mm      6.274341  1        2.504864
flipper_length_mm  7.775036  1        2.788375
sex                2.343434  1        1.530828
year               1.172956  1        1.083031</code></pre>
</div>
</div>
<p>Im obigen Output wird neben dem Generalized Variance Inflation Factor (GVIF) auch eine standardisierte Version berechnet. Die generalisierte Version des VIF wird für alle metrischen Variablen durch die Formel in <a href="#eq-vif" class="quarto-xref">Gleichung&nbsp;<span>2.7</span></a> berechnet. Lediglich die Berechnung des VIF für die nominalen Feature unterscheidet sich. Die Berechnung für die nominalen Feature würde allerdings den Rahmen der Vorlesung sprengen, weshalb diese hier nicht weiter erläutert wird.</p>
<p>Wichtig ist allerdings die Interpretation der Werte (unabhängig vom Datentyp): Die standardisierte Version des VIF sollte für nominale Feature betrachgtet werden, da dieser die Anzahl der Dummy Spalten miteinbezieht. Falls <span class="math inline">\(\text{GVIF}^{(1/(2*\text{Df}))}\geq \sqrt5 \approx 2.236\)</span>, dann liegt eventuell bei einem nominalen Feature Multikolinearität vor.</p>
<p>Für das obige MLR Modell bedeutet das, dass für die Variablen <code>species</code>, <code>bill_length_mm</code>, <code>bill_depth_mm</code> und <code>flipper_length_mm</code> Multikollinearität vorliegen könnte. Um den Effekt im obigen Modell zu mitigieren, wäre eine Möglichkeit, neue Modelle zu definieren, welche die einzelnen Variablen ausschließen und für diese neuen Modelle die VIF zu berechnen.</p>
</section>
</section>
<section id="weitere-wichtige-prüfkriterien" class="level4" data-number="2.3.3.7">
<h4 data-number="2.3.3.7" class="anchored" data-anchor-id="weitere-wichtige-prüfkriterien"><span class="header-section-number">2.3.3.7</span> Weitere wichtige Prüfkriterien</h4>
<p>Neben den bisher erläuterten Prüfkriterien sollten wir uns im Zuge unserer Modellanalyse auch mit der Datenwualität auseinandersetzen. Hierbei sind vor allem folgenden Konzpete nicht zu unterschätzen:</p>
<ul>
<li>Ausreißeranalyse</li>
<li>Einflussreiche Observationen</li>
</ul>
<section id="sec-outlier" class="level5" data-number="2.3.3.7.1">
<h5 data-number="2.3.3.7.1" class="anchored" data-anchor-id="sec-outlier"><span class="header-section-number">2.3.3.7.1</span> Ausreißeranalyse</h5>
<p>Ob eine Observation ein Ausreißer ist hängt stark von der Definition eines Ausreißers ab. In der Literatur werden verschiedene Definitionen verwendet, wobei eine gängige die Definition von <a href="https://en.wikipedia.org/wiki/John_Tukey">John Tukey</a> stammt:</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Definition">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sei <span class="math inline">\(q_{(0.25)}\)</span> das <span class="math inline">\(25\%\)</span> Quantil und <span class="math inline">\(q_{(0.75)}\)</span> das <span class="math inline">\(75\%\)</span> Quantil einer Variable, dann ist eine gegeben Observation ein Ausreißer, falls sie außerhalb des Intervalls</p>
<p><span class="math display">\[
[q_{(0.25)}-k(q_{(0.75)}-q_{(0.25)}), q_{(0.75)}+k(q_{(0.75)}-q_{(0.25)})], \qquad k\geq 0
\]</span></p>
<p>liegt.</p>
<p><span class="math inline">\(k\)</span> ist hierbei frei wählbar, allerdings wird häufig <span class="math inline">\(k=1.5\)</span> verwendet.</p>
</div>
</div>
<p>Eine weitere Möglichkeit der Ausreißerbestimmung verwendet die <em>Cook’s Distance</em>, die wir im fogenden Abschnitt betrachten.</p>
</section>
<section id="sec-cd" class="level5" data-number="2.3.3.7.2">
<h5 data-number="2.3.3.7.2" class="anchored" data-anchor-id="sec-cd"><span class="header-section-number">2.3.3.7.2</span> Einflussreiche Observationen</h5>
<p>Observationen, welche Ergebnisse der Parameterschätzung stark beeinflussen, werden einflussreiche Observationen genannt. Um zu bestimmen, ob eine Observation einflussreich ist verwenden wir die Cook’s Distance definiert als</p>
<p><span class="math display">\[
D_i = \frac{(\hat{b}-\hat{b}_{(i)})^\prime (X^\prime X)(\hat{b}-\hat{b}_{(i)})}{(J+1)\hat\sigma^2},
\]</span></p>
<p>wobei <span class="math inline">\(\hat{b_{(i)}}\)</span> die geschätzten Parameter ohne die <span class="math inline">\(i\)</span>-te Beobachtung sind und <span class="math inline">\(\hat{\sigma}\)</span> der <span class="math inline">\(\text{RMSE}\)</span> des Modells (siehe <a href="#sec-MSE" class="quarto-xref"><span>Section 2.3.4.3</span></a>). Falls <span class="math inline">\(D_i &gt; F_{J;K-J-1;0.5}\)</span>, dann ist die Observation <span class="math inline">\(i\)</span> ein Ausreißer.</p>
<p>Um die Cook’s Distance in R zu berechnen verwenden wir die <code>stats::cooks.distance()</code> Funktion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>cooks_d <span class="ot">&lt;-</span> mlr_fit <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cooks.distance</span>()</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cooks_d =</span> cooks_d,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">obs =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cooks_d)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>obs,<span class="at">y=</span>cooks_d))<span class="sc">+</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">"darkorange"</span>)<span class="sc">+</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Observation"</span>,</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cook's Distance"</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Lineare_Regression_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="gütemaße" class="level3" data-number="2.3.4">
<h3 data-number="2.3.4" class="anchored" data-anchor-id="gütemaße"><span class="header-section-number">2.3.4</span> Gütemaße</h3>
<p>Bei der multiplen linearen Regression können wir analog zur einfachen linearen Regression anhand verschiedener Gütemaße quantifizieren, wie gut das Modell den Zusammenhang zwischen den unabhängigen und der abhängigen Variable beschreibt.</p>
<section id="korrigierter-r2" class="level4" data-number="2.3.4.1">
<h4 data-number="2.3.4.1" class="anchored" data-anchor-id="korrigierter-r2"><span class="header-section-number">2.3.4.1</span> Korrigierter <span class="math inline">\(R^2\)</span></h4>
<p>Neben dem Gütemaß <span class="math inline">\(R^2\)</span> (vgl. <a href="#eq-rsq" class="quarto-xref">Gleichung&nbsp;<span>2.2</span></a>) wird bei MLR Modellen auch häufig die korrigierte Version</p>
<p><span id="eq-arsq"><span class="math display">\[
R^2_{\text{korr}}  = R^2- \frac{J\cdot(1-R^2)}{K-J-1}
\tag{2.8}\]</span></span></p>
<p>verwendet. Hierbei ist allerdings zu beachten, dass <span class="math inline">\(R^2_{\text{korr}}\)</span> nicht mehr direkt interpretiert werden kann und das Gütemaß auch keine Untere Grenze (kann auch negative Werte annehmen) besitzt.</p>
</section>
<section id="sec-AIC" class="level4" data-number="2.3.4.2">
<h4 data-number="2.3.4.2" class="anchored" data-anchor-id="sec-AIC"><span class="header-section-number">2.3.4.2</span> Akaike Information Criteria</h4>
<p>Das Akaike Information Criteria (AIC) wird häufig verwendet um Modelle untereinander zu vergleichen, da der Bildbereich dieses Gütemaßes unbeschränkt ist (kann jede Zahl <span class="math inline">\(x\in\mathbb{R}\)</span> annehmen).</p>
<p><span id="eq-AIC"><span class="math display">\[
\text{AIC} = \log\left(\frac{\sum_{k=1}^K(y_k-\hat{y_k})^2}{K} \right)+\frac{2J}{K}
\tag{2.9}\]</span></span></p>
<p>In R können wir den AIC mithilfe der <code>stats::AIC</code> Funktion berechnen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>mlr_fit <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">AIC</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4724.97</code></pre>
</div>
</div>
</section>
<section id="sec-MSE" class="level4" data-number="2.3.4.3">
<h4 data-number="2.3.4.3" class="anchored" data-anchor-id="sec-MSE"><span class="header-section-number">2.3.4.3</span> Loss Funktionen</h4>
<p>Neben den bisher eingeführten Gütemaßen werden bei Regressionsmodellen auch oft sogenannte <em>Loss</em> Funktionen berechnet. Diese messen, wie weit die tatsächlichen Werte der abhängigen Variable von der Schätzung entfernt sind. Eine gängige Loss Funktion im Regressionskontext ist der Root Mean Squared Error (RMSE). Dieser ist definiert als</p>
<p><span id="eq-mse"><span class="math display">\[
\text{RMSE}(y,\hat{y}) = \sqrt{\frac{1}{K}\sum_{k=1}^{K} (y_k-\hat{y}_k)^2}.
\tag{2.10}\]</span></span></p>
<p>Der RMSE wird häufig verwendet, da dieser die euklidische Distanz zwischen zwei Punkten berechnet und deshalb sehr intuitiv interpretierbar ist.</p>
<p>Wir können den RMSE mithilfe der <code>yardstick::mse()</code> Funktion berechnen. Hierfür müssen wir zuerst die Vorhersagen generieren und diese dann zusammen mit den tatsächlichen Werten übergeben:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>mlr_fit <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2"></a>  parsnip<span class="sc">::</span><span class="fu">augment</span>(data_penguin) <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3"></a>  yardstick<span class="sc">::</span><span class="fu">rmse</span>(<span class="at">truth =</span> .pred, <span class="at">estimate =</span> body_mass_g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  .metric .estimator .estimate
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
1 rmse    standard        282.</code></pre>
</div>
</div>
<p>In der zweiten Zeile berechnen wir mit der <code>parsnip::augment()</code> Funktion die durch das MLR Modell geschätzten Werte. Der Rückgabewert dieser Funktion ist ein neuer Datensatz, welcher neben dem Datensatz <code>data_penguin</code> noch die Spalten <code>.pred</code> und <code>.resid</code> enthält. In der Spalte <code>.pred</code> sind die durch das Modell geschätzten Vorhersagen enthalten und in der Spalte <code>.resid</code> die Residuen. Diesen neuen Datensatz übergeben wir dann der <code>yardstick::rmse</code> Funktion mit den Argumenten <code>truth = .pred</code> und <code>estimate = body_mass_g</code>.</p>
<p>Den Wert <code>.estimate = 282</code> können wir wie folgt interpretieren:</p>
<p>Im Schnitt erwarten wir bei der Schätzung des Gewichts eines Pinguins eine Abweichung von <span class="math inline">\(282\)</span> g vom wahren Wert.</p>
</section>
</section>
</section>
<section id="übungsaufgaben" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="übungsaufgaben"><span class="header-section-number">2.4</span> Übungsaufgaben</h2>
<section id="explorative-datenanalyse" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="explorative-datenanalyse"><span class="header-section-number">2.4.1</span> Explorative Datenanalyse</h3>
<div id="exr-eda_rel_size" class="theorem exercise">
<p><span class="theorem-title"><strong>Aufgabe 2.1</strong></span> Finde heraus, wie groß die relativen Anteile der jeweiligen Pinguinspezien an der Gesamtanzahl der Pinguine im Datensatz sind.</p>
</div>
<div id="exr-eda_density" class="theorem exercise">
<p><span class="theorem-title"><strong>Aufgabe 2.2</strong></span> In <a href="#sec-descriptive_stat" class="quarto-xref"><span>Section 2.1.1</span></a> haben wir einen Boxplot für die Schnabellänge der verschiedenen Pinguinspezien erstellt. Erstelle jetzt einen Dichteplot in welchem die empirische Dichte der Schnabellängen der jeweiligen Pinguinspezien dargestellt wird.</p>
</div>
</section>
<section id="einfache-lineare-regression" class="level3" data-number="2.4.2">
<h3 data-number="2.4.2" class="anchored" data-anchor-id="einfache-lineare-regression"><span class="header-section-number">2.4.2</span> Einfache lineare Regression</h3>
<div id="exr-lm_newdata" class="theorem exercise">
<p><span class="theorem-title"><strong>Aufgabe 2.3</strong></span> Entferne alle <code>NA</code> values und die Variable <code>year</code> im Datensatz. Erstelle anschließend einen neuen Teildatensatz <code>data_penguin_adelie</code>, welcher nur Pinguine der <code>Adelie</code> Spezies enthält.</p>
</div>
<div id="exr-lm_adeline_models" class="theorem exercise">
<p><span class="theorem-title"><strong>Aufgabe 2.4</strong></span> &nbsp;</p>
<ol type="1">
<li><p>Schätze für den neu erstellten Datensatz aus <a href="#exr-lm_newdata" class="quarto-xref">Aufgabe&nbsp;<span>2.3</span></a> ein einfaches lineares Modell in R, wobei die abhängige Variable durch <code>flipper_length_mm</code> und die unabhängige Variable durch <code>body_mass_g</code> gegeben ist.</p></li>
<li><p>Erzeuge für das in Aufgabe 1. erstelle lineare Modell eine Zusammenfassung in R. Ist die unabhängige Variable zum Signifikanzniveau <span class="math inline">\(\alpha = 0.01\)</span> statistisch signifikant ?</p></li>
<li><p>Angenommen der Wert der <span class="math inline">\(t\)</span>-Statistik für die Variable <code>body_mass_g</code> beträgt nicht <span class="math inline">\(6.30\)</span>, sondern <span class="math inline">\(2.88\)</span>. Bestimme das kleinste Signifikanzniveau zu welchem die Variable signifikant ist. Verwende hierfür folgende Tabelle welche Quantile der Standardnormalverteilung enthält:</p>
<div class="cell">
<div class="cell-output-display">
<div id="jrjlbjvltn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jrjlbjvltn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jrjlbjvltn thead, #jrjlbjvltn tbody, #jrjlbjvltn tfoot, #jrjlbjvltn tr, #jrjlbjvltn td, #jrjlbjvltn th {
  border-style: none;
}

#jrjlbjvltn p {
  margin: 0;
  padding: 0;
}

#jrjlbjvltn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jrjlbjvltn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jrjlbjvltn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jrjlbjvltn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jrjlbjvltn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jrjlbjvltn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jrjlbjvltn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jrjlbjvltn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jrjlbjvltn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jrjlbjvltn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jrjlbjvltn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jrjlbjvltn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jrjlbjvltn .gt_spanner_row {
  border-bottom-style: hidden;
}

#jrjlbjvltn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jrjlbjvltn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jrjlbjvltn .gt_from_md > :first-child {
  margin-top: 0;
}

#jrjlbjvltn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jrjlbjvltn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jrjlbjvltn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jrjlbjvltn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jrjlbjvltn .gt_row_group_first td {
  border-top-width: 2px;
}

#jrjlbjvltn .gt_row_group_first th {
  border-top-width: 2px;
}

#jrjlbjvltn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jrjlbjvltn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jrjlbjvltn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jrjlbjvltn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jrjlbjvltn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jrjlbjvltn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jrjlbjvltn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jrjlbjvltn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jrjlbjvltn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jrjlbjvltn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jrjlbjvltn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jrjlbjvltn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jrjlbjvltn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jrjlbjvltn .gt_left {
  text-align: left;
}

#jrjlbjvltn .gt_center {
  text-align: center;
}

#jrjlbjvltn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jrjlbjvltn .gt_font_normal {
  font-weight: normal;
}

#jrjlbjvltn .gt_font_bold {
  font-weight: bold;
}

#jrjlbjvltn .gt_font_italic {
  font-style: italic;
}

#jrjlbjvltn .gt_super {
  font-size: 65%;
}

#jrjlbjvltn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jrjlbjvltn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jrjlbjvltn .gt_indent_1 {
  text-indent: 5px;
}

#jrjlbjvltn .gt_indent_2 {
  text-indent: 10px;
}

#jrjlbjvltn .gt_indent_3 {
  text-indent: 15px;
}

#jrjlbjvltn .gt_indent_4 {
  text-indent: 20px;
}

#jrjlbjvltn .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="0" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">0</th>
<th id="0.01" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">0.01</th>
<th id="0.02" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">0.02</th>
<th id="0.03" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">0.03</th>
<th id="0.04" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">0.04</th>
<th id="0.05" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">0.05</th>
<th id="0.06" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">0.06</th>
<th id="0.07" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">0.07</th>
<th id="0.08" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">0.08</th>
<th id="0.09" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">0.09</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td id="stub_1_1" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2.0</td>
<td class="gt_row gt_right" headers="stub_1_1 0">0.9772</td>
<td class="gt_row gt_right" headers="stub_1_1 0.01">0.9778</td>
<td class="gt_row gt_right" headers="stub_1_1 0.02">0.9783</td>
<td class="gt_row gt_right" headers="stub_1_1 0.03">0.9788</td>
<td class="gt_row gt_right" headers="stub_1_1 0.04">0.9793</td>
<td class="gt_row gt_right" headers="stub_1_1 0.05">0.9798</td>
<td class="gt_row gt_right" headers="stub_1_1 0.06">0.9803</td>
<td class="gt_row gt_right" headers="stub_1_1 0.07">0.9808</td>
<td class="gt_row gt_right" headers="stub_1_1 0.08">0.9812</td>
<td class="gt_row gt_right" headers="stub_1_1 0.09">0.9817</td>
</tr>
<tr class="even">
<td id="stub_1_2" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2.1</td>
<td class="gt_row gt_right" headers="stub_1_2 0">0.9821</td>
<td class="gt_row gt_right" headers="stub_1_2 0.01">0.9826</td>
<td class="gt_row gt_right" headers="stub_1_2 0.02">0.9830</td>
<td class="gt_row gt_right" headers="stub_1_2 0.03">0.9834</td>
<td class="gt_row gt_right" headers="stub_1_2 0.04">0.9838</td>
<td class="gt_row gt_right" headers="stub_1_2 0.05">0.9842</td>
<td class="gt_row gt_right" headers="stub_1_2 0.06">0.9846</td>
<td class="gt_row gt_right" headers="stub_1_2 0.07">0.9850</td>
<td class="gt_row gt_right" headers="stub_1_2 0.08">0.9854</td>
<td class="gt_row gt_right" headers="stub_1_2 0.09">0.9857</td>
</tr>
<tr class="odd">
<td id="stub_1_3" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2.2</td>
<td class="gt_row gt_right" headers="stub_1_3 0">0.9861</td>
<td class="gt_row gt_right" headers="stub_1_3 0.01">0.9864</td>
<td class="gt_row gt_right" headers="stub_1_3 0.02">0.9868</td>
<td class="gt_row gt_right" headers="stub_1_3 0.03">0.9871</td>
<td class="gt_row gt_right" headers="stub_1_3 0.04">0.9875</td>
<td class="gt_row gt_right" headers="stub_1_3 0.05">0.9878</td>
<td class="gt_row gt_right" headers="stub_1_3 0.06">0.9881</td>
<td class="gt_row gt_right" headers="stub_1_3 0.07">0.9884</td>
<td class="gt_row gt_right" headers="stub_1_3 0.08">0.9887</td>
<td class="gt_row gt_right" headers="stub_1_3 0.09">0.9890</td>
</tr>
<tr class="even">
<td id="stub_1_4" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2.3</td>
<td class="gt_row gt_right" headers="stub_1_4 0">0.9893</td>
<td class="gt_row gt_right" headers="stub_1_4 0.01">0.9896</td>
<td class="gt_row gt_right" headers="stub_1_4 0.02">0.9898</td>
<td class="gt_row gt_right" headers="stub_1_4 0.03">0.9901</td>
<td class="gt_row gt_right" headers="stub_1_4 0.04">0.9904</td>
<td class="gt_row gt_right" headers="stub_1_4 0.05">0.9906</td>
<td class="gt_row gt_right" headers="stub_1_4 0.06">0.9909</td>
<td class="gt_row gt_right" headers="stub_1_4 0.07">0.9911</td>
<td class="gt_row gt_right" headers="stub_1_4 0.08">0.9913</td>
<td class="gt_row gt_right" headers="stub_1_4 0.09">0.9916</td>
</tr>
<tr class="odd">
<td id="stub_1_5" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2.4</td>
<td class="gt_row gt_right" headers="stub_1_5 0">0.9918</td>
<td class="gt_row gt_right" headers="stub_1_5 0.01">0.9920</td>
<td class="gt_row gt_right" headers="stub_1_5 0.02">0.9922</td>
<td class="gt_row gt_right" headers="stub_1_5 0.03">0.9925</td>
<td class="gt_row gt_right" headers="stub_1_5 0.04">0.9927</td>
<td class="gt_row gt_right" headers="stub_1_5 0.05">0.9929</td>
<td class="gt_row gt_right" headers="stub_1_5 0.06">0.9931</td>
<td class="gt_row gt_right" headers="stub_1_5 0.07">0.9932</td>
<td class="gt_row gt_right" headers="stub_1_5 0.08">0.9934</td>
<td class="gt_row gt_right" headers="stub_1_5 0.09">0.9936</td>
</tr>
<tr class="even">
<td id="stub_1_6" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2.5</td>
<td class="gt_row gt_right" headers="stub_1_6 0">0.9938</td>
<td class="gt_row gt_right" headers="stub_1_6 0.01">0.9940</td>
<td class="gt_row gt_right" headers="stub_1_6 0.02">0.9941</td>
<td class="gt_row gt_right" headers="stub_1_6 0.03">0.9943</td>
<td class="gt_row gt_right" headers="stub_1_6 0.04">0.9945</td>
<td class="gt_row gt_right" headers="stub_1_6 0.05">0.9946</td>
<td class="gt_row gt_right" headers="stub_1_6 0.06">0.9948</td>
<td class="gt_row gt_right" headers="stub_1_6 0.07">0.9949</td>
<td class="gt_row gt_right" headers="stub_1_6 0.08">0.9951</td>
<td class="gt_row gt_right" headers="stub_1_6 0.09">0.9952</td>
</tr>
<tr class="odd">
<td id="stub_1_7" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2.6</td>
<td class="gt_row gt_right" headers="stub_1_7 0">0.9953</td>
<td class="gt_row gt_right" headers="stub_1_7 0.01">0.9955</td>
<td class="gt_row gt_right" headers="stub_1_7 0.02">0.9956</td>
<td class="gt_row gt_right" headers="stub_1_7 0.03">0.9957</td>
<td class="gt_row gt_right" headers="stub_1_7 0.04">0.9959</td>
<td class="gt_row gt_right" headers="stub_1_7 0.05">0.9960</td>
<td class="gt_row gt_right" headers="stub_1_7 0.06">0.9961</td>
<td class="gt_row gt_right" headers="stub_1_7 0.07">0.9962</td>
<td class="gt_row gt_right" headers="stub_1_7 0.08">0.9963</td>
<td class="gt_row gt_right" headers="stub_1_7 0.09">0.9964</td>
</tr>
<tr class="even">
<td id="stub_1_8" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2.7</td>
<td class="gt_row gt_right" headers="stub_1_8 0">0.9965</td>
<td class="gt_row gt_right" headers="stub_1_8 0.01">0.9966</td>
<td class="gt_row gt_right" headers="stub_1_8 0.02">0.9967</td>
<td class="gt_row gt_right" headers="stub_1_8 0.03">0.9968</td>
<td class="gt_row gt_right" headers="stub_1_8 0.04">0.9969</td>
<td class="gt_row gt_right" headers="stub_1_8 0.05">0.9970</td>
<td class="gt_row gt_right" headers="stub_1_8 0.06">0.9971</td>
<td class="gt_row gt_right" headers="stub_1_8 0.07">0.9972</td>
<td class="gt_row gt_right" headers="stub_1_8 0.08">0.9973</td>
<td class="gt_row gt_right" headers="stub_1_8 0.09">0.9974</td>
</tr>
<tr class="odd">
<td id="stub_1_9" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2.8</td>
<td class="gt_row gt_right" headers="stub_1_9 0">0.9974</td>
<td class="gt_row gt_right" headers="stub_1_9 0.01">0.9975</td>
<td class="gt_row gt_right" headers="stub_1_9 0.02">0.9976</td>
<td class="gt_row gt_right" headers="stub_1_9 0.03">0.9977</td>
<td class="gt_row gt_right" headers="stub_1_9 0.04">0.9977</td>
<td class="gt_row gt_right" headers="stub_1_9 0.05">0.9978</td>
<td class="gt_row gt_right" headers="stub_1_9 0.06">0.9979</td>
<td class="gt_row gt_right" headers="stub_1_9 0.07">0.9979</td>
<td class="gt_row gt_right" headers="stub_1_9 0.08">0.9980</td>
<td class="gt_row gt_right" headers="stub_1_9 0.09">0.9981</td>
</tr>
<tr class="even">
<td id="stub_1_10" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2.9</td>
<td class="gt_row gt_right" headers="stub_1_10 0">0.9981</td>
<td class="gt_row gt_right" headers="stub_1_10 0.01">0.9982</td>
<td class="gt_row gt_right" headers="stub_1_10 0.02">0.9982</td>
<td class="gt_row gt_right" headers="stub_1_10 0.03">0.9983</td>
<td class="gt_row gt_right" headers="stub_1_10 0.04">0.9984</td>
<td class="gt_row gt_right" headers="stub_1_10 0.05">0.9984</td>
<td class="gt_row gt_right" headers="stub_1_10 0.06">0.9985</td>
<td class="gt_row gt_right" headers="stub_1_10 0.07">0.9985</td>
<td class="gt_row gt_right" headers="stub_1_10 0.08">0.9986</td>
<td class="gt_row gt_right" headers="stub_1_10 0.09">0.9986</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></li>
<li><p>Angenommen ein Pinguin wiegt <a href="pictures/terrifiednootnoot.jpg"><span class="math inline">\(16000\)</span> g</a>, wie groß ist die erwartete Flossenlänge nach dem in Teilaufgabe 1. geschätzten einfachen linearen Modell.</p></li>
</ol>
</div>
</section>
<section id="kennzahlen" class="level3" data-number="2.4.3">
<h3 data-number="2.4.3" class="anchored" data-anchor-id="kennzahlen"><span class="header-section-number">2.4.3</span> Kennzahlen</h3>
<div id="exr-AIC" class="theorem exercise">
<p><span class="theorem-title"><strong>Aufgabe 2.5</strong></span> In <a href="#sec-AIC" class="quarto-xref"><span>Section 2.3.4.2</span></a> wurde das AIC eingeführt. Beurteile anhand <a href="#eq-AIC" class="quarto-xref">Gleichung&nbsp;<span>2.9</span></a> , ob ein hoher oder niedriger AIC-Wert für ein Modell spricht, welches den Zusammenhang zwischen den Variablen gut erklärt.</p>
</div>
<div id="exr-Outlier" class="theorem exercise">
<p><span class="theorem-title"><strong>Aufgabe 2.6</strong></span> Beurteile den Wahrheitsgehalt der folgenden Aussage und begründe deine Entscheidung:</p>
<blockquote class="blockquote">
<p>,,Jeder Ausreißer ist eine Einflussreiche Observation.``</p>
</blockquote>
</div>
<div id="exr-fstat" class="theorem exercise">
<p><span class="theorem-title"><strong>Aufgabe 2.7</strong></span> In <a href="#sec-cd" class="quarto-xref"><span>Section 2.3.3.7.2</span></a> haben wir Cook’s Distance als Methode zur Erkennung von einflussreichen Observationen eingeführt. Berechne für das Beispiel in <a href="#sec-cd" class="quarto-xref"><span>Section 2.3.3.7.2</span></a> den Wert <span class="math inline">\(F_{J;K-J-1;0.5}\)</span> und entscheide, ob im Datensatz welcher für die Berechnungen verwendet wurde einflussreiche Variablen sind.</p>
<p><em>Hinweis: Um ein Quantil der <span class="math inline">\(F\)</span>-Verteilung zu berechnen, können wir die <code>qf()</code> Funktion verwenden.</em></p>
</div>
</section>
<section id="multiple-lineare-regression" class="level3" data-number="2.4.4">
<h3 data-number="2.4.4" class="anchored" data-anchor-id="multiple-lineare-regression"><span class="header-section-number">2.4.4</span> Multiple Lineare Regression</h3>
<p>Für die folgenden Aufgaben verwenden wir den <a href="https://www.sciencedirect.com/science/article/pii/S2352340918315191#f0010"><code>hotel_rates</code></a> Datensatz der <code>{modeldata}</code> Library. Die in <code>{modeldata}</code> enthaltene Version des Datensatzes enthält die durchschnittlichen Zimmerpreise für Hotels in Lissabon, Portugal aus den Jahren 2016-2017. Das Ziel dieser Aufgabe ist es, die Variable <code>avg_price_per_room</code> zu modellieren, die den Durschnittlichen Preis pro Nacht in einem Hotel beschreibt.</p>
<div id="exr-eda_hotel" class="theorem exercise">
<p><span class="theorem-title"><strong>Aufgabe 2.8</strong></span> Beschreibe, wie im folgenden Code-Snippet die Daten aufbereitet werden. Gehe dabei auf die einzelnen Funktionen und deren Rückgabewert ein.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>hotel_rates_filtered <span class="ot">&lt;-</span> hotel_rates <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2"></a> <span class="fu">mutate</span>(</span>
<span id="cb52-3"><a href="#cb52-3"></a>   <span class="at">arrival_month =</span> <span class="fu">factor</span>(<span class="fu">month</span>(arrival_date)),</span>
<span id="cb52-4"><a href="#cb52-4"></a>   <span class="at">num_guests =</span> adults<span class="sc">+</span>children,</span>
<span id="cb52-5"><a href="#cb52-5"></a>   <span class="at">is_repeated_guest =</span> <span class="fu">factor</span>(is_repeated_guest),</span>
<span id="cb52-6"><a href="#cb52-6"></a>   ) <span class="sc">%&gt;%</span></span>
<span id="cb52-7"><a href="#cb52-7"></a>   <span class="fu">select</span>(num_guests,total_of_special_requests,</span>
<span id="cb52-8"><a href="#cb52-8"></a>          required_car_parking_spaces,arrival_month,</span>
<span id="cb52-9"><a href="#cb52-9"></a>          is_repeated_guest,lead_time,stays_in_week_nights,</span>
<span id="cb52-10"><a href="#cb52-10"></a>          avg_price_per_room)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="exr-mlrfit" class="theorem exercise">
<p><span class="theorem-title"><strong>Aufgabe 2.9</strong></span> Erstelle mit R ein MLR Modell, welches als abhängige Variable <code>avg_price_per_room</code> enthält und als unabhängige Variablen alle anderen Variablen im Datensatz <code>hotel_rates_filtered</code>.</p>
</div>
<div id="exr-mlrsummary" class="theorem exercise">
<p><span class="theorem-title"><strong>Aufgabe 2.10</strong></span> &nbsp;</p>
<ol type="1">
<li><p>Erzeugte für das Modell aus <a href="#exr-mlrfit" class="quarto-xref">Aufgabe&nbsp;<span>2.9</span></a> eine Modellzusammenfassung. Gibt es Variablen im Modell welche <strong>nicht</strong> statistisch signifikant sind?</p></li>
<li><p>Erweitere die Modellzusammenfassung durch eine Version welche die standardisierten Koeffizienten enthält. Welche Variable hat den größten Einfluss auf die abhängige Variable <code>avg_price_per_room</code>?</p></li>
<li><p>Führe mithilfe der Modellzusammenfassung einen <span class="math inline">\(F\)</span>-Test durch und evaluiere auf Basis dieses Tests die Modellgüte zum Signifikanzniveau <span class="math inline">\(\alpha = 0.05\)</span>.</p></li>
</ol>
</div>
<div id="exr-mlrassumptions" class="theorem exercise">
<p><span class="theorem-title"><strong>Aufgabe 2.11</strong></span> Überprüfe das Modell aus <a href="#exr-mlrfit" class="quarto-xref">Aufgabe&nbsp;<span>2.9</span></a> im Hinblick auf</p>
<ol type="1">
<li>Homoskedastizität.</li>
<li>Autokorreltaion.</li>
<li>die Annahme der Normalverteilung der Residuen.</li>
</ol>
</div>
</section>
</section>
<section id="lösungen" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="lösungen"><span class="header-section-number">2.5</span> Lösungen</h2>
<div id="sol-eda_rel_size" class="proof solution">
<p><span class="proof-title"><em>Solution 2.1</em> (<a href="#exr-eda_rel_size" class="quarto-xref">Aufgabe&nbsp;<span>2.1</span></a>). </span>Um herauszufinden, wie groß der relative Anteil der jeweiligen Pinguinspezien ist, können wir die <code>group_by</code> und <code>summarise</code> Funktionen verwenden. Durch das spezifizieren von <code>rel = n()/nrow(data_penguin)</code> erstellen wir in der Zusammenfassung eine neue Spalte <code>rel</code> welche für jedes Gruppenmitglied (jede Spezies) zuerst die Anzahl berechnet (durch die <code>n()</code> Funktion) und diese anschließend durch die Gesamtanzahl der Datenpunkte im Datensatz teilen (die Gesamtanzahl berechnen wir durch <code>nrow(data_penguin)</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>data_penguin <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">rel =</span> <span class="fu">n</span>()<span class="sc">/</span><span class="fu">nrow</span>(data_penguin))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  species     rel
  &lt;fct&gt;     &lt;dbl&gt;
1 Adelie    0.442
2 Chinstrap 0.198
3 Gentoo    0.360</code></pre>
</div>
</div>
</div>
<div id="sol-eda_density" class="proof solution">
<p><span class="proof-title"><em>Solution 2.2</em> (<a href="#exr-eda_density" class="quarto-xref">Aufgabe&nbsp;<span>2.2</span></a>). </span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>data_penguin<span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>bill_length_mm, <span class="at">fill =</span>species))<span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span><span class="fu">c</span>(<span class="st">"darkorange"</span>,<span class="st">"purple"</span>,<span class="st">"cyan4"</span>))<span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5"></a>  <span class="fu">labs</span>(<span class="at">x =</span><span class="st">"Schnabellänge in mm"</span>, <span class="at">y=</span><span class="st">"Dichte"</span>)<span class="sc">+</span></span>
<span id="cb55-6"><a href="#cb55-6"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size=</span><span class="dv">14</span>)<span class="sc">+</span></span>
<span id="cb55-7"><a href="#cb55-7"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Lineare_Regression_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Im Vergleich zur Boxplot Grafik aus Abschnitt <a href="#sec-descriptive_stat" class="quarto-xref"><span>Section 2.1.1</span></a> müssen wir bei einem Dichteplot folgende Änderungen vornehmen:</p>
<ol type="1">
<li><p>In Zeile 2 übergeben wir in der <code>aes()</code> Funktion nicht auf der <span class="math inline">\(x\)</span>-Achse nicht die verschiedenen Spezies, sondern direkt die Schnabellänge. Die <span class="math inline">\(y\)</span>-Achse wird automatisch auf die Werte der Dichten gesetzt. Durch das setzen von <code>fill=species</code> erreichen wir wieder, dass für jede Spezies später ein einzelner Dichteplot erzeugt wird.</p></li>
<li><p>In Zeile 3 fügen wir die Dichteplots mit der <code>geom_density</code> Funktion hinzu (analog zu <a href="01_Einfuehrung.html#sol-ggplot3" class="quarto-xref">Solution&nbsp;<span>1.11</span></a>). Durch das setzen von <code>alpha = 0.5</code> erreichen wir, dass die Füllungen der Dichteplots sich nicht gegenseitig überdecken und die einzelnen Dichten so noch sichtbar sind.</p></li>
<li><p>Zum Schluss müssen wir in Zeile 5 noch die Namen der Achsen anpassen.</p></li>
</ol>
</div>
<div id="sol-lm_newdata" class="proof solution">
<p><span class="proof-title"><em>Solution 2.3</em> (<a href="#exr-lm_newdata" class="quarto-xref">Aufgabe&nbsp;<span>2.3</span></a>). </span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>data_penguin <span class="ot">&lt;-</span> palmerpenguins<span class="sc">::</span>penguins</span>
<span id="cb56-2"><a href="#cb56-2"></a></span>
<span id="cb56-3"><a href="#cb56-3"></a>data_penguin <span class="ot">&lt;-</span> data_penguin <span class="sc">%&gt;%</span></span>
<span id="cb56-4"><a href="#cb56-4"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-5"><a href="#cb56-5"></a>  <span class="fu">select</span>(<span class="sc">-</span>year)</span>
<span id="cb56-6"><a href="#cb56-6"></a></span>
<span id="cb56-7"><a href="#cb56-7"></a>data_penguin_adelie <span class="ot">&lt;-</span> data_penguin <span class="sc">%&gt;%</span></span>
<span id="cb56-8"><a href="#cb56-8"></a>  <span class="fu">filter</span>(species<span class="sc">==</span><span class="st">"Adelie"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Zuerst erstellen wir einen Datensatz <code>data_penguin</code>, indem wir den <code>penguins</code> Datensatz der Library <code>palmerpenguins</code> in der ersten Zeile neu einlesen. Danach überschreiben wir den Datensatz mit einer modifizierten Version, wobei wir im ersten Schritt (Zeile 3) die <code>na.omit()</code> Funktion auf den Datensatz anwenden um alle <code>NA</code> Values zu entfernen und im zweiten Schritt (Zeile 4) mithilfe der <code>select()</code> Funktion die Spalte <code>years</code> entfernen. Spalten können wir mithilfe der <code>select</code> Funktion entfernen, indem wir den <code>-</code> Operator vor den Spaltenname setzen.</p>
<p>In Zeile 7 generieren wir dann einen neuen Datensatz <code>data_penguin_adelie</code>, indem wir auf den Datensatz <code>data_penguin</code> die <code>filter</code> Funktion anwenden. Durch das Argument <code>species=="Adelie"</code>spezifizieren wir in der <code>filter</code> Funktion, dass nur Einträge im neuen Datensatz gespeichert werden, welche in der Spalte <code>species</code> die Ausprägung <code>"Adelie"</code> besitzt.</p>
</div>
<div id="sol-lm_adeline_models" class="proof solution">
<p><span class="proof-title"><em>Solution 2.4</em> (<a href="#exr-lm_adeline_models" class="quarto-xref">Aufgabe&nbsp;<span>2.4</span></a>). </span></p>
<ol type="1">
<li><!-- -->
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>lm_adelie <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> data_penguin_adelie,</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">formula =</span> flipper_length_mm <span class="sc">~</span>  body_mass_g )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wie in <a href="#sec-elr" class="quarto-xref"><span>Section 2.2.1</span></a> können wir mithilfe der <code>linear_reg</code> Funktion ein lineares Modell spezifizieren und die Parameter direkt mit der <code>fit</code> Funktion schätzen. Hierbei verwenden wir die Formel <code>flipper_length_mm ~  body_mass_g</code>, welche beschreibt, dass <code>flipper_length_mm</code> die abhängige Variable ist und <code>body_mass_g</code> die unabhängige Variable. Die Daten für die Schätzung spezifizieren wir durch das <code>data</code> Argument. Wie in der Aufgabenstellung beschrieben, verwenden wir den neuen Datensatz <code>data_penguin_adelie</code>, welcher lediglich Pinguine der Spezies <code>Adelie</code> enthält.</p></li>
<li><!-- -->
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>lm_adelie <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
stats::lm(formula = flipper_length_mm ~ body_mass_g, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-14.426  -3.669   0.239   3.422  17.955 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1.656e+02  3.918e+00   42.27  &lt; 2e-16 ***
body_mass_g 6.610e-03  1.049e-03    6.30  3.4e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.794 on 144 degrees of freedom
Multiple R-squared:  0.2161,  Adjusted R-squared:  0.2106 
F-statistic: 39.69 on 1 and 144 DF,  p-value: 3.402e-09</code></pre>
</div>
</div>
<p>Durch das verwenden der <code>extract_fit_engine()</code> und <code>summary</code> Funktion können wir wie in Abschnitt <a href="#sec-elr" class="quarto-xref"><span>Section 2.2.1</span></a> eine Zusammenfassung erzeugen. Da für die Variable <code>body_mass_g</code> gilt, dass <code>Pr(&gt;|t|)=3.4*10^-9&lt;0.01</code> ist die Variable zum Signifikanzniveau <span class="math inline">\(0.01\)</span> signifikant.</p></li>
<li><p>Es gilt <code>t value = 2.88</code>. Um den kleinsten Wert <span class="math inline">\(\alpha\)</span> zu bestimmen für den <code>Pr(&gt;|t|)&lt;</code><span class="math inline">\(\alpha\)</span> gilt, müssen wir das <span class="math inline">\(F^{-1}(2.88)\)</span> Quantil der Standartnormalverteilung bestimmen. Anhand der Quantilstabelle die in der Aufgabenstellung gegeben ist, können wir bei <span class="math inline">\(F^{-1}(2.88)\)</span> den Wert <span class="math inline">\(0.9980\)</span> ablesen. Somit gilt <span class="math inline">\(1-\frac{\alpha}{2} = 0.9980\)</span> genau dann, wenn <span class="math inline">\(\alpha = 0.004\)</span> Das Konfidenzniveau <span class="math inline">\(\alpha = 0.004\)</span> ist somit das kleinste, zu welchem die Variable <code>body_mass_g</code> signifikant ist unter der Annahme, dass <code>t value = 2.88</code>.</p></li>
<li><p>Falls ein Pinguin <span class="math inline">\(16000\)</span> g wiegt, können wir entweder die Modellgleichung oder R verwenden, um die geschätzte Flossenlänge zu berechnen:</p>
<ol type="1">
<li><p>Aus der Modellzusammenfassung in Teilaufgabe 2. können wir die Schätzgleichung</p>
<p><span class="math display">\[
\widehat{\verb|flipper_length_mm|} = 165.6 + 0.006610\cdot \verb|body_mass_g|
\]</span></p>
<p>ablesen. Durch das Einsetzen von <span class="math inline">\(16,000\)</span> in diese Schätzgleichung erhalten wir eine erwartete Flossenlänge von <span class="math display">\[
165.6+ 0.006610\cdot 16,000 = 105.7766.
\]</span></p></li>
<li><p>Mithilfe der <code>predict()</code> oder <code>augment()</code> Funktion, können wir das erwartete Gewicht auch mit R schätzen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>lm_adelie <span class="sc">%&gt;%</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="fu">tibble</span>(<span class="at">body_mass_g =</span> <span class="dv">16000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  .pred
  &lt;dbl&gt;
1  271.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>lm_adelie <span class="sc">%&gt;%</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(<span class="fu">tibble</span>(<span class="at">body_mass_g =</span> <span class="dv">16000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  .pred body_mass_g
  &lt;dbl&gt;       &lt;dbl&gt;
1  271.       16000</code></pre>
</div>
</div>
<p>Um die Flossenlänge unter Verwendung der beiden Funktionen zu schätzen, müssen wir die Variable <code>body_mass_g</code> mit dem neuen Wert in einem Tibble oder Data Frame übergeben. Wichtig ist hierbei auch den Variablenname <code>body_mass_g</code> zu übergeben, da sonst nicht klar ist, zu welcher Variable der Wert <code>16,000</code> gehört.</p></li>
</ol></li>
</ol>
</div>
<div id="sol-AIC" class="proof solution">
<p><span class="proof-title"><em>Solution 2.5</em> (<a href="#exr-AIC" class="quarto-xref">Aufgabe&nbsp;<span>2.5</span></a>). </span>Nach <a href="#eq-AIC" class="quarto-xref">Gleichung&nbsp;<span>2.9</span></a> gilt</p>
<p><span class="math display">\[
\text{AIC} = \log\left(\frac{\sum_{k=1}^K(y_k-\hat{y_k})^2}{K} \right)+\frac{2J}{K}
\]</span> Die Logarithmusfunktion ist monoton steigend und kann jeden Wert zwischen <span class="math inline">\((-\infty,\infty)\)</span> annehmen. je größer also die Abweichung zwischen den Werten <span class="math inline">\(y_k-\hat{y_k}\)</span> im Summand sind, desto größer ist auch der Wert des Logarithmus. Da die Werte <span class="math inline">\(K\)</span> und <span class="math inline">\(J\)</span> konstant sind können wir deshalb daraus schließen, dass ein Modell mit niedrigem <code>AIC</code> Wert die Tatsächlichen Werte <span class="math inline">\(y_k\)</span> besser schätzt.</p>
</div>
<div id="sol-Outlier" class="proof solution">
<p><span class="proof-title"><em>Solution 2.6</em> (<a href="#exr-Outlier" class="quarto-xref">Aufgabe&nbsp;<span>2.6</span></a>). </span>Nicht jeder Ausreißer ist eine Einflussreiche Observation. Folgendes Gegenbeispiel illustriert diesen Effekt:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Lineare_Regression_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Obwohl der Punkt <span class="math inline">\((20,20)\)</span> ein Ausreißer ist, beeinflusst er kaum die blaue Regressionsgerade.</p>
</div>
<div id="sol-fstat" class="proof solution">
<p><span class="proof-title"><em>Solution 2.7</em> (<a href="#exr-fstat" class="quarto-xref">Aufgabe&nbsp;<span>2.7</span></a>). </span>Um zu überprüfen, ob in den Daten welche wir für die Berechnung der Cook’s Distance in <a href="#sec-cd" class="quarto-xref"><span>Section 2.3.3.7.2</span></a> verwendet haben einflussreiche Observationen sind, müsse wir das <span class="math inline">\(F_{J;K-J-1;0.5}\)</span> Quantil berechnen. Da <span class="math inline">\(J = 7\)</span> und <span class="math inline">\(K=344\)</span> ergibt sich</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qf</span>(<span class="at">p =</span> <span class="fl">0.5</span>,<span class="at">df1 =</span> <span class="dv">7</span>, <span class="at">df2 =</span> <span class="dv">344-7-1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9083624</code></pre>
</div>
</div>
<p>Wir können diesen Wert nun mit den Werten der Cook’s Distance vergleichen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(cooks_d <span class="sc">&gt;=</span> <span class="fu">qf</span>(<span class="at">p =</span> <span class="fl">0.5</span>,<span class="at">df1 =</span> <span class="dv">7</span>, <span class="at">df2 =</span> <span class="dv">344-7-1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>Im obigen Code-Snippet Vergleichen wir die Werte des Vektors <code>cooks_d</code> mit dem Quantil der <span class="math inline">\(F\)</span>-Verteilung. Ohne die Anwenduing der Summenfunktion ist der Rückgabewert eine Liste welche nur die Werte <code>TRUE</code> und <code>FALSE</code> enthält. Da keiner der Werte im Vektor <code>cooks_d</code> größer ist als das Quantil der <span class="math inline">\(F\)</span>-Verteilung, ist der Vektor mit <code>FALSE</code> Einträgen gefüllt. <code>FALSE</code> wird beim aufsummieren in R als <span class="math inline">\(0\)</span> gewertet, weshalb ein Vektor gefüllt mit <code>FALSE</code> Werten summiert <span class="math inline">\(0\)</span> ergibt. Wir können daraus schließen, dass keine einflussreichen Observationen im <code>penguins</code> Datensatz enthalten sind.</p>
</div>
<div id="sol-eda_hotel" class="proof solution">
<p><span class="proof-title"><em>Solution 2.8</em> (<a href="#exr-eda_hotel" class="quarto-xref">Aufgabe&nbsp;<span>2.8</span></a>). </span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>hotel_rates_filtered <span class="ot">&lt;-</span> hotel_rates <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="#cb68-2"></a> <span class="fu">mutate</span>(</span>
<span id="cb68-3"><a href="#cb68-3"></a>   <span class="at">arrival_month =</span> <span class="fu">factor</span>(<span class="fu">month</span>(arrival_date)),</span>
<span id="cb68-4"><a href="#cb68-4"></a>   <span class="at">num_guests =</span> adults<span class="sc">+</span>children,</span>
<span id="cb68-5"><a href="#cb68-5"></a>   <span class="at">is_repeated_guest =</span> <span class="fu">factor</span>(is_repeated_guest),</span>
<span id="cb68-6"><a href="#cb68-6"></a>   ) <span class="sc">%&gt;%</span></span>
<span id="cb68-7"><a href="#cb68-7"></a>   <span class="fu">select</span>(num_guests,total_of_special_requests,</span>
<span id="cb68-8"><a href="#cb68-8"></a>          required_car_parking_spaces,arrival_month,</span>
<span id="cb68-9"><a href="#cb68-9"></a>          is_repeated_guest,lead_time,stays_in_week_nights,</span>
<span id="cb68-10"><a href="#cb68-10"></a>          avg_price_per_room)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>In der ersten Zeile wird ein neuer Datensatz <code>hotel_rates_filtered</code> definiert.</li>
<li>In den Zeilen 2-6 wird auf den Datensatz <code>hotel_rates</code> die <code>mutate()</code> Funktion angewendet, welche bestehende Spalten verändert oder neue Spalten erstellt.
<ol type="i">
<li>Zuerst wird eine neue Spalte <code>arrival_month</code> erstellt, welche aus der Variable <code>arrival_date</code> mithilfe der <code>month()</code> Funktion den Monat extrahiert, in welchem die Gäste in der Unterkunft sind. Der Monat wird anschließend noch mit der <code>factor()</code> Funktion in einen ungeordneten Faktor umgewandelt.</li>
<li>Es wird dann eine neue Variable <code>num_guests</code> erstellt, welche die Gesamtanzahl der Gäste beschreibt. Die Gesamtanzahl wird hierbei durch die Summe der <code>adults</code> und <code>children</code> Spalte berechnet.</li>
<li>Zuletzt wird die Spalte <code>is_repeated_guest</code> in einen ungeordneten Faktor umgewandelt.</li>
</ol></li>
<li>In Zeile 7 werden dann mit der <code>select()</code> Funktion verschiedene Spalten des angepassten <code>hotel_rates</code> Datensatzes ausgewählt, welche im neuen Datensatz enthalten sein sollen.</li>
</ol>
</div>
<div id="sol-mlrfit" class="proof solution">
<p><span class="proof-title"><em>Solution 2.9</em> (<a href="#exr-mlrfit" class="quarto-xref">Aufgabe&nbsp;<span>2.9</span></a>). </span>Erstelle mit R ein MLR Modell, welches als abhängige Variable <code>avg_price_per_room</code> enthält und als unabhängige Variablen alle anderen Variablen im Datensatz <code>hotel_rates_filtered</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>mlr_hotel_fit <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> hotel_rates_filtered,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">formula =</span> avg_price_per_room <span class="sc">~</span> .)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="sol-mlrsummary" class="proof solution">
<p><span class="proof-title"><em>Solution 2.10</em> (<a href="#exr-mlrsummary" class="quarto-xref">Aufgabe&nbsp;<span>2.10</span></a>). </span></p>
<ol type="1">
<li><!-- -->
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>mlr_hotel_fit <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
stats::lm(formula = avg_price_per_room ~ ., data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-191.846  -20.582   -2.665   17.254  271.908 

Coefficients:
                            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                   5.9319     1.3215   4.489 7.21e-06 ***
num_guests                   26.9413     0.4475  60.203  &lt; 2e-16 ***
total_of_special_requests     5.2444     0.3214  16.317  &lt; 2e-16 ***
required_car_parking_spaces  12.8375     0.6812  18.845  &lt; 2e-16 ***
arrival_month2                0.7578     1.4398   0.526   0.5987    
arrival_month3               12.7604     1.4524   8.786  &lt; 2e-16 ***
arrival_month4               36.2235     1.4469  25.035  &lt; 2e-16 ***
arrival_month5               36.2536     1.4562  24.897  &lt; 2e-16 ***
arrival_month6               69.7082     1.5216  45.814  &lt; 2e-16 ***
arrival_month7              107.9166     1.3368  80.729  &lt; 2e-16 ***
arrival_month8              134.6784     1.3232 101.779  &lt; 2e-16 ***
arrival_month9               62.2610     1.5422  40.371  &lt; 2e-16 ***
arrival_month10              21.8807     1.4217  15.391  &lt; 2e-16 ***
arrival_month11              -2.5258     1.4863  -1.699   0.0893 .  
arrival_month12              19.7548     1.4966  13.200  &lt; 2e-16 ***
is_repeated_guest1           -4.9443     1.1371  -4.348 1.38e-05 ***
lead_time                    -0.1272     0.0033 -38.546  &lt; 2e-16 ***
stays_in_week_nights         -0.2196     0.1269  -1.730   0.0837 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 33.89 on 15384 degrees of freedom
Multiple R-squared:  0.7329,  Adjusted R-squared:  0.7326 
F-statistic:  2483 on 17 and 15384 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Die Aufgabenstellung wurde bei dieser Teilaufgabe absichtlich etwas uneindeutig gestellt. Da die Frage lautet, ob eine Variable <strong>nicht</strong> statistisch signifikant ist, lautet die Antwort eigentlich <strong>Nein</strong>. Denn selbst die Variable <code>arrival_month_2</code> ist zum Signifikanzniveau <span class="math inline">\(\alpha = 0.948\)</span> signifikant. Normalerweise spricht man aber bei der Frage nach Signifikanz immer von einem Niveau <span class="math inline">\(\alpha \in (0,0.05)\)</span>. Falls wir allerdings die gängige Daumenregel für Signifikanz verwenden, dann sie die Variablen <code>arrival_month2,arrival_monht_11</code> und <code>stays_in_week_nights</code> nicht statistisch signifikant.</p></li>
<li><!-- -->
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lm.beta)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>mlr_hotel_fit <span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm.beta</span>()<span class="sc">%&gt;%</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
stats::lm(formula = avg_price_per_room ~ ., data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-191.846  -20.582   -2.665   17.254  271.908 

Coefficients:
                              Estimate Standardized Std. Error t value Pr(&gt;|t|)
(Intercept)                   5.931878           NA   1.321469   4.489 7.21e-06
num_guests                   26.941284     0.271328   0.447507  60.203  &lt; 2e-16
total_of_special_requests     5.244445     0.069716   0.321405  16.317  &lt; 2e-16
required_car_parking_spaces  12.837463     0.080228   0.681214  18.845  &lt; 2e-16
arrival_month2                0.757801     0.003060   1.439819   0.526   0.5987
arrival_month3               12.760405     0.050979   1.452436   8.786  &lt; 2e-16
arrival_month4               36.223475     0.147026   1.446896  25.035  &lt; 2e-16
arrival_month5               36.253554     0.147491   1.456155  24.897  &lt; 2e-16
arrival_month6               69.708193     0.265733   1.521558  45.814  &lt; 2e-16
arrival_month7              107.916576     0.554979   1.336783  80.729  &lt; 2e-16
arrival_month8              134.678372     0.717227   1.323245 101.779  &lt; 2e-16
arrival_month9               62.261007     0.239576   1.542227  40.371  &lt; 2e-16
arrival_month10              21.880701     0.094708   1.421681  15.391  &lt; 2e-16
arrival_month11              -2.525839    -0.009607   1.486313  -1.699   0.0893
arrival_month12              19.754753     0.074348   1.496565  13.200  &lt; 2e-16
is_repeated_guest1           -4.944333    -0.018703   1.137071  -4.348 1.38e-05
lead_time                    -0.127207    -0.197191   0.003300 -38.546  &lt; 2e-16
stays_in_week_nights         -0.219552    -0.008311   0.126933  -1.730   0.0837

(Intercept)                 ***
num_guests                  ***
total_of_special_requests   ***
required_car_parking_spaces ***
arrival_month2                 
arrival_month3              ***
arrival_month4              ***
arrival_month5              ***
arrival_month6              ***
arrival_month7              ***
arrival_month8              ***
arrival_month9              ***
arrival_month10             ***
arrival_month11             .  
arrival_month12             ***
is_repeated_guest1          ***
lead_time                   ***
stays_in_week_nights        .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 33.89 on 15384 degrees of freedom
Multiple R-squared:  0.7329,  Adjusted R-squared:  0.7326 
F-statistic:  2483 on 17 and 15384 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Der geschätzte standardisierte Koeffizient der Variable <code>arrival_month_8</code> ist am größten, weshalb dieser auch den größten Einfluss auf den durchschnittlichen Zimmerpreis im Modell besitzt. Da es sich hierbei um den Monat August handelt, können wir guten Gewissens mutmaßen, dass in diesem Monat die Zimmer aufgrund der Ferienzeit und der damit verbundenen höheren Nachfrage immer ein wenig teurer sind.</p></li>
<li><p>Die Hypothesen des <span class="math inline">\(F\)</span>-Tests lauten <span class="math display">\[
H_0: b_{\verb|num_guests|} = ... = b_{\verb|stays_in_week_nights|} = 0
\]</span></p>
<p>vs.</p>
<p><span class="math display">\[
H_1: \text{min. ein Koeffizient ist ungleich } 0
\]</span></p>
<p>Da <span class="math inline">\(p&lt;2.2\cdot 10^{ -16}&lt;\alpha = 0.05\)</span>, können wir <span class="math inline">\(H_0\)</span> verwefen und daraus schließen, dass das Modell als ganzes signifikant ist.</p></li>
</ol>
</div>
<div id="sol-mlrassumptions" class="proof solution">
<p><span class="proof-title"><em>Solution 2.11</em> (<a href="#exr-mlrassumptions" class="quarto-xref">Aufgabe&nbsp;<span>2.11</span></a>). </span></p>
<ol type="1">
<li><p>Homoskedastizität:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>resid<span class="ot">&lt;-</span>mlr_hotel_fit <span class="sc">%&gt;%</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rstudent</span>()</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> mlr_hotel_fit <span class="sc">%&gt;%</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(hotel_rates_filtered) </span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">predictions =</span> preds,</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">residuals =</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(resid))</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>predictions,<span class="at">y=</span>residuals))<span class="sc">+</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> F, <span class="at">formula =</span> y<span class="sc">~</span>x)<span class="sc">+</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">sqrt{|Std. Residuen|}"</span>),</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Quadratwurzel des Betrags </span><span class="sc">\n</span><span class="st">der standardisierten Residuen"</span></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size=</span><span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Lineare_Regression_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In der erzeugten Grafik ist klar zu erkennen, dass die blaue Trendlinie nicht horizontal ist, sondern eine leichte positive Steigung besitzt. Wir können deshalb nicht ausschließen, dass die Residuen eine konstante Varianz besitzen. Aufgrund der positiven Steigung können wir vermuten, dass die Varianz in den Residuen mit zunehmendem Schätzwert ebenso steigt.</p></li>
<li><p>Autokorreltaion:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>resid<span class="ot">&lt;-</span>mlr_hotel_fit <span class="sc">%&gt;%</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rstudent</span>()</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> mlr_hotel_fit <span class="sc">%&gt;%</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(hotel_rates_filtered) </span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">predictions =</span> preds,</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">residuals =</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(resid))</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>predictions,<span class="at">y=</span>residuals))<span class="sc">+</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> F, <span class="at">formula =</span> y<span class="sc">~</span>x)<span class="sc">+</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">sqrt{|Std. Residuen|}"</span>),</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Quadratwurzel des Betrags </span><span class="sc">\n</span><span class="st">der standardisierten Residuen"</span></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size=</span><span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Lineare_Regression_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Durch das Abändern der <code>method</code> in der <code>geom_smooth</code> Funktion können wir eine nicht-lineare Trendlinie einzeichnen. Da die neue Trendlinie ebenso nicht horizontal ist und zusätzlich auch noch leicht nichtlinear, können wir nicht ausschließen, dass die Residuen unabhängig voneinander sind. Da beide dieser Effekte allerdings marginal sind, sollte das für die Modellgüte nicht weiter problematisch sein.</p></li>
<li><p>Annahme der Normalverteilung der Residuen: Mithilfe des folgendem Skripts können wir sowohl den QQ-Plot, als auch ein Histogramm untereinander darstellen. Hierbei verwenden wir die <code>{patchwork}</code> Library, welche erlaubt Grafiken einfach miteinander zu verknüpfen. Indem wir zuerst eine Grafik <code>p1</code> erstellen welche den QQ-Plot enthält und danach ein Histogram unter <code>p2</code> speichern, können wir die beiden Grafiken mit dem <code>p1/p2</code> Befehl vertikal angeordnet darstellen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>resid <span class="ot">&lt;-</span> mlr_hotel_fit <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>() <span class="sc">%&gt;%</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">residuals =</span> .)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> resid <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample=</span>residuals))<span class="sc">+</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>()<span class="sc">+</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>()<span class="sc">+</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size=</span><span class="dv">14</span>)</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>mean_res <span class="ot">&lt;-</span> mlr_hotel_fit <span class="sc">%&gt;%</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>()<span class="sc">%&gt;%</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>() <span class="sc">%&gt;%</span></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>()</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>sd_res <span class="ot">&lt;-</span> mlr_hotel_fit <span class="sc">%&gt;%</span></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>()<span class="sc">%&gt;%</span></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>() <span class="sc">%&gt;%</span></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sd</span>()</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> resid <span class="sc">%&gt;%</span> </span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>residuals))<span class="sc">+</span></span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span> <span class="fu">after_stat</span>(density)), <span class="at">bins =</span> <span class="dv">50</span>)<span class="sc">+</span></span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm,</span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">linewidth =</span> <span class="fl">1.5</span>,</span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mean_res,</span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sd =</span> sd_res))<span class="sc">+</span></span>
<span id="cb76-31"><a href="#cb76-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span>
<span id="cb76-32"><a href="#cb76-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-33"><a href="#cb76-33" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">/</span>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02_Lineare_Regression_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Beim Betrachten des QQ-Plots fällt auf, dass vor allem die oberen Quantile stark von denen einer Normalverteilung abweichen. Dieses Verhalten können wir ebenso im Histogramm erkennen, da im Berech zwischen <span class="math inline">\(250\)</span> und <span class="math inline">\(300\)</span> ein Balken zu erkennen ist. Bei einer Normalverteilung sollte so ein Balken nicht auftreten! Ansonsten sind im Histogramm die Residuen relativ nah um die theoretische Dichte der Normalverteilung verteilt. Lediglich am Modus lässt sich erkennen, dass mehr Residuen um den Urpsrung verteilt sind.</p></li>
</ol>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./01_Einfuehrung.html" class="pagination-link" aria-label="(Kurz)Einführung in R">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">(Kurz)Einführung in R</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03_Wichtige_Konzepte.html" class="pagination-link" aria-label="Weiterführende Konzepte des Dataminings">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Weiterführende Konzepte des Dataminings</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>