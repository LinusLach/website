<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Weiterführende Konzepte des Dataminings – Data Mining Übungsmaterial</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./02_Lineare_Regression.html" rel="prev">
<script src="site_libs/cookie-consent/cookie-consent.js"></script>
<link href="site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-K9CJ1KN8ZH"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-K9CJ1KN8ZH', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"express",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03_Wichtige_Konzepte.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Weiterführende Konzepte des Dataminings</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Mining Übungsmaterial</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vorwort</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Einfuehrung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">(Kurz)Einführung in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Lineare_Regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Lineare Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Wichtige_Konzepte.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Weiterführende Konzepte des Dataminings</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#training-und-test-split" id="toc-training-und-test-split" class="nav-link active" data-scroll-target="#training-und-test-split"><span class="header-section-number">3.1</span> Training und Test Split</a>
  <ul>
  <li><a href="#training--und-testsplit-in-r" id="toc-training--und-testsplit-in-r" class="nav-link" data-scroll-target="#training--und-testsplit-in-r"><span class="header-section-number">3.1.1</span> Training- und Testsplit in R</a></li>
  </ul></li>
  <li><a href="#cross-validation" id="toc-cross-validation" class="nav-link" data-scroll-target="#cross-validation"><span class="header-section-number">3.2</span> Cross-Validation</a>
  <ul>
  <li><a href="#cross-validation-in-r" id="toc-cross-validation-in-r" class="nav-link" data-scroll-target="#cross-validation-in-r"><span class="header-section-number">3.2.1</span> Cross-Validation in R</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Weiterführende Konzepte des Dataminings</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In diesem Kapitel werden wir uns mit weiterführenden Konzepten des Data Minings auseinandersetzen. Diese umfassen das Aufteilen der Daten in Trainings- und Testdaten, Cross-Validation (Kreuzvalidierung), die Imputation von fehlenden Werten sowie die Merkmalsselektion.</p>
<section id="training-und-test-split" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="training-und-test-split"><span class="header-section-number">3.1</span> Training und Test Split</h2>
<p>Die Parameter der linearen Regressionsmodelle aus <a href="02_Lineare_Regression.html" class="quarto-xref">Kapitel&nbsp;<span>2</span></a> haben wir unter Verwendung aller Daten geschätzt. Falls wir allerdings erwarten, dass neue Daten zu den Datensätzen hinzugefügt werden, ist das nicht die beste Idee, da wir nicht wissen wie gut unser Modell auf zuvor ungesehenen Daten funktioniert. Eine gängige Praxis ist deshalb die Daten in ein Trainings- und Test Set aufzuteilen. Mit den Trainingsdaten werden die Parameter des Modells geschätzt und mit den Testdaten wird die sogenannte Out-Of-Sample (OOS) Performance gemessen.</p>
<p>Beim Aufteilen der Daten sollte beachtet werden, dass das Verhältnis zwischen den beiden Teilen sinnvoll gewählt wird und die Aufteilungs zufällig gewählt wird.</p>
<div id="exm-TrainTestSplit" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 3.1</strong></span> In einem gegebenen Datensatz sind 101 Observationen <span class="math inline">\((x,y)\in\mathbb{R}\)</span>. Nun werden die letzten <span class="math inline">\(20\%\)</span> diese Daten als Testdaten festgelegt und die ersten <span class="math inline">\(80\%\)</span> der Daten als Trainingsdaten. Mit den Trainingsdaten schätzen wir die Parameter eins linearen Regressionsmodells und generieren Vorhersagen auf Basis der Testdaten. Wir können dann die Vorhersagegüte des Modells auf den Testdaten visuell evaluieren und uns ein</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_Wichtige_Konzepte_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Im obigen Beispiel ist klar zu erkennen, dass der Split (also das Aufteilen der Daten) nicht optimal war. Zwar erzeugen die geschätzten Parameter gute vorhersagen auf den Trainingsdaten, allerdings sind die Vorhersagefehler in den Testdaten sehr hoch.</p>
<p>Wenn wir stattdessen die Daten in zufällige Trainings- und Testdaten aufteilen, ist für das gegebene Modell der In-Sample Fehler (IS-Fehler) zwar höher, allerdings der OOS-Fehler niedriger:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_Wichtige_Konzepte_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Im obigen Beispiel haben wir gesehen, dass ein zufälliger Split zu besseren Ergebnissen führen kann. Die Frage ist nun, wie wir in R einen zufälligen Split erzeugen können!</p>
<section id="training--und-testsplit-in-r" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="training--und-testsplit-in-r"><span class="header-section-number">3.1.1</span> Training- und Testsplit in R</h3>
<p>Die <code>rsample::initial_split(), rsample::training()</code> und <code>rsample::testing()</code> Funktionen erlauben ein einfaches und effizientes Aufteilen der Daten in Trainings- und Testdaten. Das <code>{rsample}</code> Paket ist teil des <code>{tidymodels}</code> Ökosystems, weshalb wir auch einfach mit dem Befehl <code>library(tidymodels)</code> dieses hinzufügen können. In <a href="02_Lineare_Regression.html#sec-MLRR" class="quarto-xref"><span>Section 2.3.1</span></a> haben wir den <code>penguins</code> Datensatz verwendet, um die Parameter eines multiplen linearen Regressionsmodells zu schätzen. Des weiteren haben wir in <a href="02_Lineare_Regression.html#sec-MSE" class="quarto-xref"><span>Section 2.3.4.3</span></a> das MLR Modell auf dem gesamten Datensatz anhand der RMSE Metrik evaluiert. Hierbei hat sich ein RMSE Wert von <code>282</code> ergeben. Im Folgenden wollen wir das gleiche Modell erstellen, allerdings die Parameter nur mit den Trainingsdaten schätzen und die Performance dann auf den Testdaten evaluieren.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>data_penguin <span class="ot">&lt;-</span> palmerpenguins<span class="sc">::</span>penguins</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a>split_penguin <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(<span class="at">data =</span> data_penguin, <span class="at">prop =</span> <span class="fl">0.8</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a>data_train <span class="ot">&lt;-</span> <span class="fu">training</span>(split_penguin)</span>
<span id="cb1-7"><a href="#cb1-7"></a>data_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(split_penguin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In der dritten Zeile wenden wir den <code>set.seed()</code> Befehl an. Diese Funktion ist wichtig um die Reproduzierbarkeit der Resultate zu gewährleisten, wenn zufällige Prozesse im Programmablauf involviert sind. Dadurch, dass wir im folgenden die Daten zufällig aufteilen, wird unter der Verwendung der <code>set.seed()</code> Funktion gewährleistet, dass bei jedem durchführen der darauffolgenden Zeilen, der gleiche zufällige Split durchgeführt wird.</p>
<p>In Zeile 5 verwenden wir die <code>initial_split()</code> Funktion, um die Daten aufzuteilen. Das Argument <code>data = data_penguin</code> beschreibt welche daten Aufgeteilt werden sollen und das Argument <code>prop=0.8</code> steuert die Proportionalität des Splits. Der Wert <code>prop = 0.8</code> teilt die Daten somit zufällig in <span class="math inline">\(80\%\)</span> Trainings und <span class="math inline">\(20\%\)</span> Testdaten ein.</p>
<p>In Zeile 6 und 7 verwenden wir dann die <code>training()</code> und <code>testing()</code> Funktionen um aus dem <code>split_pinguin</code> Objekt die Trainings- und Testdaten zu extrahieren. Die Trainings- und Testdaten sind daraufhin in einem Data-Frame bzw. Tibble gespeichert und können wie gewohnt verwendet werden.</p>
<p>Wir können nun die Parameter des MLR Modells schätzen wie wir es in #sec-MLRR getan haben:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>mlr_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>()</span>
<span id="cb2-2"><a href="#cb2-2"></a>mlr_fit <span class="ot">&lt;-</span> mlr_spec <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="fu">fit</span>(<span class="at">data =</span> data_train,</span>
<span id="cb2-4"><a href="#cb2-4"></a>      <span class="at">formula =</span> body_mass_g <span class="sc">~</span>.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Lediglich in Zeile 3 haben wir anstatt des <code>data_penguin</code> Datensatzes nun den <code>data_train</code> Datensatz verwendet. Da wir nur an der Modellgüte auf Basis der Testdaten interessiert sind, evaluieren wir an dieser Stelle nicht weiter das Modell auf Basis der Trainingsdaten.</p>
<p>Mit der <code>augment()</code> Funktion können wir nun wieder Vorhersagen und die dazugehörigen Residuen und mithilfe der <code>rmse()</code> Funktion den RMSE berechnen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mlr_fit <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(data_test) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rmse</span>(<span class="at">truth =</span> .pred, <span class="at">estimate =</span> body_mass_g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  .metric .estimator .estimate
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
1 rmse    standard        289.</code></pre>
</div>
</div>
<p>Der Test Fehler mit dem Wert <code>289</code> ist also nur knapp größer als der Fehler welchen wir in <a href="02_Lineare_Regression.html#sec-MSE" class="quarto-xref"><span>Section 2.3.4.3</span></a> beobachten konnten (<code>282</code>). Wir können deshalb also für zuvor ungesehene Pinguine erwarten, dass das Gewicht im Schnitt <span class="math inline">\(289\)</span> g höher oder niedriger als der tatsächliche Wert geschätzt wird.</p>
</section>
</section>
<section id="cross-validation" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="cross-validation"><span class="header-section-number">3.2</span> Cross-Validation</h2>
<p>Das Konzpet der Cross-Validation (Kreuzvalidierung) knüpft direkt an das des Aufteilens der Trainings- und Testdaten an. Die Idee hierbei ist, dass wir die Daten nicht nur ein Mal in Trainings- und Testdaten aufteilen, sondern mehrmals auf verschiedene Art und weise. Die folgende Grafik illustriert die Idee der five-fold Cross-Validation:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pictures/cv_tp.svg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>In einem ersten Schritt, teilen wir die Daten in fünf gleichgroße, zufällige Teildatensätze (Folds) auf. Vereinigt ergeben diese Teildatensätze also wieder den gesamten Datensatz. Diese fünf Folds werden dann fünf mal dupliziert, so dass wir jeden Fold fünf Mal auffinden. Die einzelnen Duplikate werden hierbei Splits genannt. In jedem dieser 5 Splits wird dann ein anderer Fold als Testdaten definiert und die verbleibenden vier Folds als Trainingsdaten. Wir können dann vier verschiedene Trainings- und Testdatensätze verwenden um zum Beispiel die Parameter eines linearen Modells zu schätzen.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pictures/y-tho-meme-rcm1300x0.jpg" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption><a href="https://www.giga.de/extra/meme/tipps/y-tho-meme-bedeutung-herkunft-einsatzmoeglichkeit/">Quelle</a></figcaption>
</figure>
</div>
<p>In <a href="#exm-TrainTestSplit" class="quarto-xref">Example&nbsp;<span>3.1</span></a> haben wir gesehen, dass ein unvorteilhafter Training- und Testsplit zu verzerrten Ergebnissen führen kann. Selbst bei einem zufällig ausgewählten Trainings- und Testsplit besteht das Risiko einen unvorteilhaften Split zu erstellen. Indem wir die Daten also systematisch aufteilen und den Testfehler mitteln, können wir das Risiko mitigieren. Wir können den Cross-Validation Test Fehler durch den Term</p>
<p><span class="math display">\[
\text{CV-Loss} = \frac{1}{5}\sum_{i=1}^{5} \text{Loss}_{\text{OOS}_i}(y,\hat{y})
\]</span> berechnen. <span class="math inline">\(\text{Loss}_{\text{OOS}_i}\)</span> steht hierbei für die OOS Performance in Split <span class="math inline">\(i\)</span> bezüglich einer beliebigen Loss Funktion wie zum Beispiel RMSE.</p>
<p>Wir können die Anzahl der Splits bzw. Folds auch beliebig höher oder niedriger wählen. Falls wir zum Beispiel auf einen Datensatz mit <span class="math inline">\(n\)</span> Ausprägungen <span class="math inline">\(n\)</span>-Fold Cross-Validation anwenden, d.h. die Testsets aus einem Split entsprechen einem einzelnen Sample, dann spricht man auch von Leave-One-Out Cross-Validation. Dieses Prinzip garantiert zwar einen sehr robusten <span class="math inline">\(\text{CV-Loss}\)</span>, kann aber unter umständen auch zu sehr langen Berechnungszeiten führen, da wir schließlich für jeden Split ein Modell trainieren.</p>
<section id="cross-validation-in-r" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="cross-validation-in-r"><span class="header-section-number">3.2.1</span> Cross-Validation in R</h3>
<p>Die <code>rsample::vfold_cv</code> Funktion ermöglicht uns ein Cross-Validation Objekt zu erstellen. Dieses ist nichts anderes als ein verschachteltes Tibble bzw. Data Frame. D.h. jeder Eintrag ist wieder ein Tibble oder Data Frame selber.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>folds_penguin <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(<span class="at">data =</span> data_penguin, <span class="at">v =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Neben dem Argument <code>data</code> welches die Daten spezifiziert müssen wir noch die Anzahl der Folds übergeben. Diese können wir über das Argument <code>v</code> steuern. Falls wir also <code>v=5</code> setzen, dann bedeutet das, dass wir 5-Fold Cross-Validation anwenden.</p>
<p>Wir können nun die Parameter eines MLR Modells für jeden Split schätzen und den CV-Loss berechnen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>mlr_fit_cv <span class="ot">&lt;-</span> mlr_spec <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">fit_resamples</span>(</span>
<span id="cb6-3"><a href="#cb6-3"></a>    <span class="at">resamples =</span> folds_penguin,</span>
<span id="cb6-4"><a href="#cb6-4"></a>    <span class="at">preprocessor =</span> body_mass_g <span class="sc">~</span>.</span>
<span id="cb6-5"><a href="#cb6-5"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>In der ersten Zeile verwenden wir das bereits spezifizierte MLR Modell <code>mlr_spec</code>, um für dieses auf Basis jedes Spllits die Parameter zu schätzen.</li>
<li>In Zeile 2. verwenden wir statt der <code>fit</code> Funktion die <code>fit_resamples</code> Funktion. Wie der Name bereits vermuten lässt, können wir mit dieser Funktion die Parameter auf Basis der verschiedenen Splits berechnen.</li>
<li>Wir müssen deshalb in Zeile 3 statt dem Argument <code>data</code> das Argument <code>resamples = folds_penguin</code> übergeben.</li>
<li>In der vierten Zeile spezifizieren wir dann mit dem <code>preprocessor</code> Argument noch die Formel, bezüglich welcher die Parameter geschätzt werden sollen. Äquivalent dazu wird in der <code>fit</code> Funktion das Argument <code>formula</code> verwendet. Hintergrund für die unterschiedlichen Argumentnamen ist, dass wir die <code>fit_resamples</code> Funktion noch viel umfangreicher nutzen könnten, das aber den Rahmen dieser Vorlesung sprengt (siehe bei Interesse <a href="https://linus-lach.de/teaching/ml/03_regularization#recipes-and-workflows">Machine Learning Übungsskrip</a>).</li>
</ol>
<p>Um nun die Performance der Cross-Validation zu überprüfen, können wir die <code>tune::collect_metrics</code> Funktion verwenden:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mlr_fit_cv <span class="sc">%&gt;%</span> <span class="fu">collect_metrics</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Der Rückgabewert der <code>collect_metrics</code> Funktion ist ein Tibble, welches verschiedene Informationen der Evaluation des CV-Objekts enthält:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fulcdvnltn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#fulcdvnltn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fulcdvnltn thead, #fulcdvnltn tbody, #fulcdvnltn tfoot, #fulcdvnltn tr, #fulcdvnltn td, #fulcdvnltn th {
  border-style: none;
}

#fulcdvnltn p {
  margin: 0;
  padding: 0;
}

#fulcdvnltn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fulcdvnltn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fulcdvnltn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fulcdvnltn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fulcdvnltn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fulcdvnltn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fulcdvnltn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fulcdvnltn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fulcdvnltn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fulcdvnltn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fulcdvnltn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fulcdvnltn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fulcdvnltn .gt_spanner_row {
  border-bottom-style: hidden;
}

#fulcdvnltn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fulcdvnltn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fulcdvnltn .gt_from_md > :first-child {
  margin-top: 0;
}

#fulcdvnltn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fulcdvnltn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fulcdvnltn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fulcdvnltn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fulcdvnltn .gt_row_group_first td {
  border-top-width: 2px;
}

#fulcdvnltn .gt_row_group_first th {
  border-top-width: 2px;
}

#fulcdvnltn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fulcdvnltn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fulcdvnltn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fulcdvnltn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fulcdvnltn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fulcdvnltn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fulcdvnltn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fulcdvnltn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fulcdvnltn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fulcdvnltn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fulcdvnltn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fulcdvnltn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fulcdvnltn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fulcdvnltn .gt_left {
  text-align: left;
}

#fulcdvnltn .gt_center {
  text-align: center;
}

#fulcdvnltn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fulcdvnltn .gt_font_normal {
  font-weight: normal;
}

#fulcdvnltn .gt_font_bold {
  font-weight: bold;
}

#fulcdvnltn .gt_font_italic {
  font-style: italic;
}

#fulcdvnltn .gt_super {
  font-size: 65%;
}

#fulcdvnltn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fulcdvnltn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fulcdvnltn .gt_indent_1 {
  text-indent: 5px;
}

#fulcdvnltn .gt_indent_2 {
  text-indent: 10px;
}

#fulcdvnltn .gt_indent_3 {
  text-indent: 15px;
}

#fulcdvnltn .gt_indent_4 {
  text-indent: 20px;
}

#fulcdvnltn .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id=".metric" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">.metric</th>
<th id=".estimator" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">.estimator</th>
<th id="mean" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">mean</th>
<th id="n" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">n</th>
<th id="std_err" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">std_err</th>
<th id=".config" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">.config</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers=".metric">rmse</td>
<td class="gt_row gt_left" headers=".estimator">standard</td>
<td class="gt_row gt_right" headers="mean">287.4591766</td>
<td class="gt_row gt_right" headers="n">5</td>
<td class="gt_row gt_right" headers="std_err">9.545448579</td>
<td class="gt_row gt_left" headers=".config">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".metric">rsq</td>
<td class="gt_row gt_left" headers=".estimator">standard</td>
<td class="gt_row gt_right" headers="mean">0.8732929</td>
<td class="gt_row gt_right" headers="n">5</td>
<td class="gt_row gt_right" headers="std_err">0.006853351</td>
<td class="gt_row gt_left" headers=".config">Preprocessor1_Model1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Da wir keine weiteren Metriken spezifiziert haben, werden automatisch der RMSE, sowie <span class="math inline">\(R^2_\text{adj}\)</span> berechnet. Die Namen der Metriken sind in der Spalte <code>.metric</code> gespeichert. In der Spalte <code>mean</code> können wir den CV-Loss einsehen. Die Spalte <code>n</code> gibt die Anzahl der Folds an und <code>std_error</code> den entsprechenden Standardfehler der Metrik auf Basis der Folds. Die <code>.config</code> Spalte ist für diesen Kurs ebenso nicht relevant.</p>
<!-- 
## Imputation

## Merkmalsselektion
-->


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02_Lineare_Regression.html" class="pagination-link" aria-label="Lineare Regression">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Lineare Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>